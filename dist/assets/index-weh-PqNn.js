import{i as Na,g as Gs,a as va,r as a,o as ya,j as e,c as wa,s as xs,u as Qe,b as Sa,L as pe,N as Ca,P as ve,d as Y,e as Te,f as X,q as ge,w as Se,h as ye,k as we,l as W,m as le,n as $e,p as xe,t as Re,v as Ie,x as Pe,C as Xe,y as Ke,z as es,A as ss,B as Ws,D as as,E as ts,F as Hs,G as is,H as rs,I as ls,J as Oe,K as ns,M as os,S as Ys,O as ze,Q as de,R as Le,T as me,U as _e,V as _a,W as ka,X as he,Y as Ea}from"./vendor-DS4HH3Go.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();const Da={apiKey:"AIzaSyDtO6GisGJP6gtbtTz3Gmdz0cGyp-id46w",authDomain:"tics-cc-2024.firebaseapp.com",projectId:"tics-cc-2024",storageBucket:"tics-cc-2024.appspot.com",messagingSenderId:"345093255804",appId:"1:345093255804:web:9c763d8852934fef7a8ff9"},bs=Na(Da),cs=Gs(bs),A=va(bs),Be=a.createContext(),Fa=({children:s})=>{const[r,t]=a.useState(null),[c,i]=a.useState(!0);return a.useEffect(()=>{const l=localStorage.getItem("user");l&&(t(JSON.parse(l)),i(!1));const n=ya(cs,o=>{if(o){const x={email:o.email};localStorage.setItem("user",JSON.stringify(x)),t(x)}else localStorage.removeItem("user"),t(null);i(!1)});return()=>n()},[]),e.jsx(Be.Provider,{value:{currentUser:r,loading:c},children:s})},Js=()=>a.useContext(Be),ne=()=>e.jsxs("div",{className:"spinner-overlay",children:[" ",e.jsx("div",{className:"spinner"})," "]});function Pa({setIsLogin:s}){const r=Gs(bs),[t,c]=a.useState(""),[i,l]=a.useState(!1),[n,o]=a.useState(""),[x,h]=a.useState("");function u(d){const b=["gmail.com","hotmail.com","outlook.com","live.com","msn.com","santafe.gov.ar"],m=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,f=d.split("@")[1];return m.test(d)&&b.includes(f)}function j(d){return d.length>=6}async function g(d){if(d.preventDefault(),!u(n)){c("Por favor, utiliza un correo válido de Gmail o Microsoft (Outlook, Hotmail, Live, Santa fe ).");return}if(!j(x)){c("La contraseña debe tener al menos 6 caracteres.");return}l(!0);try{const m=(await wa(r,n,x)).user;console.log("Registro exitoso:",m),alert("Registro exitoso"),o(""),h(""),c(""),await xs(r),console.log("Sesión cerrada después del registro."),s(!0)}catch(b){N(b)}finally{l(!1)}}function N(d){switch(d.code){case"auth/email-already-in-use":c("La dirección de correo electrónico ya está en uso.");break;case"auth/invalid-email":c("Tu dirección de correo electrónico no es válida.");break;case"auth/weak-password":c("Tu contraseña es muy débil - debe tener al menos 6 caracteres.");break;default:c("Oooops, algo salió mal :(")}}return e.jsxs(e.Fragment,{children:[i&&e.jsx(ne,{}),e.jsxs("form",{action:"#!",id:"registerForm",className:"form-container",onSubmit:g,children:[e.jsxs("div",{className:"row gy-3 gy-md-4 overflow-hidden",children:[e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"registerEmail",className:"form-label text-capitalize",children:["Ingresa tu correo electrónico ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",id:"registerEmail",name:"email",className:"form-control",value:n,onChange:d=>o(d.target.value),placeholder:"",autoComplete:"off",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"registerPassword",className:"form-label text-capitalize",children:["Ingresa tu Contraseña ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",id:"registerPassword",name:"password",className:"form-control text-capitalize",value:x,onChange:d=>h(d.target.value),autoComplete:"off",required:!0})]}),t&&e.jsx("span",{className:"error text-danger",role:"alert","aria-live":"assertive",children:t}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"d-grid",children:e.jsx("button",{className:"btn btn-purpleUi fw-semibold fs-6 rounded-3 shadow",type:"submit",id:"submitBtnRegistrar",disabled:i,children:"Registrar usuario"})})})]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12",children:[e.jsx("hr",{className:"mt-5 mb-4 border-secondary-subtle"}),e.jsxs("div",{className:"d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-end",children:[e.jsxs("span",{className:"dropdown-item opacity-75 btn text-capitalize",type:"button","data-bs-toggle":"modal","data-bs-target":"#usuarioCsvModal",children:["Crear Usuarios CSV ",e.jsx("i",{className:"bi bi-filetype-svg"})]}),e.jsx("button",{type:"button",className:"btn text-pink fs-6 rounded-3 text-capitalize",onClick:()=>s(!0),children:"Regresar"})]})]})})]})]})}function Aa({setIsLogin:s}){const{currentUser:r,loading:t}=a.useContext(Be),c=Qe(),[i,l]=a.useState(""),[n,o]=a.useState(""),[x,h]=a.useState(""),[u,j]=a.useState(!1);a.useEffect(()=>{r&&setTimeout(()=>{c("/dashboard")},1e3)},[r,c]);const g=async b=>{if(b.preventDefault(),!i||!n){h("Por favor, complete todos los campos.");return}if(!N(i)){h("Por favor, ingrese un correo electrónico válido.");return}if(n.length<6){h("La contraseña debe tener al menos 6 caracteres.");return}j(!0);try{const f=(await Sa(cs,i,n)).user;alert(`Inicio de sesión exitoso. Bienvenido ${f.email}`)}catch(m){d(m)}finally{j(!1)}};function N(b){const m=["gmail.com","hotmail.com","outlook.com","live.com","msn.com","santafe.gov.ar"],f=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,C=b.split("@")[1];return f.test(b)&&m.includes(C)}const d=b=>{switch(b.code){case"auth/wrong-password":h("La contraseña es incorrecta.");break;case"auth/user-not-found":h("No hay usuario registrado con este correo.");break;case"auth/invalid-email":h("El correo electrónico no es válido.");break;default:h("Oooops, algo salió mal :(")}};return e.jsxs("form",{onSubmit:g,className:"form-container",children:[u&&e.jsx(ne,{}),e.jsxs("div",{className:"row gy-3 gy-md-4 overflow-hidden",children:[e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"username",className:"form-label",children:["Usuario ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",id:"username",className:"form-control",name:"username",value:i,onChange:b=>l(b.target.value),placeholder:"",autoComplete:"off",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"password",className:"form-label",children:["Contraseña ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",id:"password",className:"form-control",name:"password",value:n,onChange:b=>o(b.target.value),autoComplete:"off",required:!0})]}),e.jsx("div",{className:"col-12",children:x&&e.jsx("span",{className:"error text-danger",children:x})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"d-grid",children:e.jsx("button",{className:"btn btn-purpleUi fw-semibold fs-6 rounded-3 shadow",type:"submit",disabled:u,children:u?"Cargando...":"Iniciar sesión"})})})]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12",children:[e.jsx("hr",{className:"mt-5 mb-4 border-secondary-subtle"}),e.jsxs("div",{className:"d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-end",children:[e.jsx("button",{type:"button",className:"btn fs-6 rounded-3",onClick:()=>s(!1),children:"Crear Cuenta"}),e.jsx("button",{type:"button",className:"btn fs-6 rounded-3 disabled",children:"Iniciar sesión con Google"}),e.jsx("button",{type:"button",className:"link-secondary text-decoration-none d-none",children:"¿Olvidaste la clave?"})]})]})})]})}const Ma=()=>{const[s,r]=a.useState(!0);return e.jsxs("section",{className:"d-flex justify-content-center align-items-center vh-100",children:[" ",e.jsx("div",{className:"container",children:e.jsxs("div",{className:"card border-light-subtle shadow-sm",children:[" ",e.jsxs("div",{className:"row g-0 ",children:[" ",e.jsxs("div",{className:"col-12 col-md-6 text-bg-login shadow linear-gradient-login rounded-start ",children:[" ",e.jsxs("div",{className:"row d-flex align-items-center justify-content-center h-100",children:[e.jsxs("div",{className:"col-sm-3 text-center animate__animated animate__fadeIn",children:[" ",e.jsx("img",{className:"pt-5",loading:"lazy",src:"/img/marca-fondo-blanco-2024.png",width:"120",height:"90",alt:""})]}),e.jsxs("div",{className:"col-9 col-xl-8 py-5 text-center animate__animated animate__fadeInDown",children:[" ",e.jsx("h1",{className:"fs-2 p-3"}),e.jsx("hr",{className:"border-light-subtle mb-4 border-2"}),e.jsx("span",{className:"fs-1",children:"Sistema "}),e.jsx("h1",{children:"Cx2 -  2025"}),e.jsx("hr",{className:"border-light-subtle mb-4 border-2"})]}),e.jsx("p",{className:"text-center fs-5 animate__animated animate__fadeIn",children:"Policía de la Provincia de Santa Fe"})," "]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[" ",e.jsxs("div",{className:"card-body p-3 p-md-4 p-xl-5",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-5 text-center",children:[e.jsx("span",{className:"fs-2 animate__animated animate__flip",id:"formTitle",children:s?"Iniciar Sesión":"Crear Cuenta"})," "]})})}),s?e.jsx(Aa,{setIsLogin:r}):e.jsx(Pa,{setIsLogin:r})]})]})]})]})})]})};function Ia(){return e.jsx("div",{id:"loginShowDivId",className:"d-flex justify-content-center align-items-center h-100",style:{minHeight:"100vh"},children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"login-rectangulo w-100",children:e.jsxs("div",{className:"login-texto-p p-5",children:[e.jsx("p",{className:"login-texto-p-parrafo1 lh-1 pt-5 text-white m-0",children:"Santa Fe"}),e.jsx("p",{className:"login-texto-p-parrafo2 lh-1 text-white m-0",children:"Provincia"})]})})})})}const La=()=>{const[s,r]=a.useState(!0);return a.useEffect(()=>{const t=setTimeout(()=>{r(!1)},3e3);return()=>clearTimeout(t)},[]),e.jsx(e.Fragment,{children:s?e.jsx(Ia,{}):e.jsx("div",{className:"container-lg",id:"homeContainer",children:e.jsx(Ma,{})})})},$a=()=>e.jsx("div",{className:"bg-primary Gradiante25 min-vh-100 d-flex justify-content-center align-items-center text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("h1",{className:"display-4 fw-bold",children:"Bienvenido a Santa Fe"}),e.jsx("p",{className:"lead",children:"Descubrí todo lo que nuestra provincia tiene para ofrecer, ¡explorá nuestras funcionalidades y novedades!"}),e.jsx(pe,{to:"/about",className:"btn btn-outline-light mt-3",children:"Saber más"})]})}),be=({children:s})=>{const{currentUser:r,loading:t}=Js();return t?e.jsx(ne,{}):r?s:e.jsx(Ca,{to:"/"})},Ra=()=>e.jsx("div",{className:"container-fluid d-flex align-items-center justify-content-center text-center py-5 bg-white",style:{height:"100vh"},children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-capitalize text-secondary fs-1 fw-semibold",children:"Error 404"}),e.jsx("h5",{className:"text-capitalize text-secondary",children:"La página solicitada no funciona"}),e.jsx("img",{src:"/gif/dribbble_1.gif",alt:"error",className:"img-fluid my-3",style:{maxHeight:"700px"}})]})}),ke=({element:s,element2:r,element3:t})=>e.jsxs("div",{className:"container-lg titulo-espaciado text-end  mb-4 text-capitalize text-secondary fs-3 fw-semibold ",children:[e.jsxs("h5",{children:[e.jsxs("span",{children:["  ",s," "]}),"   | ",e.jsx("span",{className:"textG fs-4 animate__animated animate__flash",children:r})," ",e.jsx("i",{className:`${t} px-2`})," "]}),e.jsx("hr",{className:"color-gradient opacity-50 p-0"})," "]});ke.propTypes={element:ve.string.isRequired,element2:ve.string.isRequired,element3:ve.string.isRequired};const Zs=()=>{const{currentUser:s}=a.useContext(Be);return e.jsx("div",{children:s?e.jsxs("span",{children:[s.email,"  "]}):e.jsx("span",{children:"No hay usuario activo"})})},Qs=()=>{const{currentUser:s}=a.useContext(Be),r=Qe(),[t,c]=a.useState(!1),i=async()=>{try{await xs(cs),r("/")}catch(o){console.error("Error al cerrar sesión:",o)}};a.useEffect(()=>{},[s]);const l=()=>{c(!0)},n=()=>{c(!1)};return s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:l,className:"btn text-secondaryMuiRed fw-semibold",children:"Cerrar Sesión"}),e.jsx("div",{className:`modal bg-dark fade ${t?"show":""}`,style:{display:t?"block":"none"},tabIndex:"-1","aria-labelledby":"logoutModalLabel","aria-hidden":!t,children:e.jsx("div",{className:"modal-dialog ",children:e.jsxs("div",{className:"modal-content   border border-white",children:[e.jsxs("div",{className:"modal-header bg-danger ",children:[e.jsx("h5",{className:"modal-title text-white  ",id:"logoutModalLabel",children:"Confirmar Cierre de Sesión"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:n,"aria-label":"Close"})]}),e.jsx("hr",{className:"border border-secondaryMuiRed border-2 opacity-50 m-0 mb-4"}),e.jsx("div",{className:"modal-body text-center  fw-semibold text-uppercase lh-lg",children:"¿Está seguro de que desea cerrar sesión?"}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:n,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-redUi1 text-white",onClick:()=>{i(),n()},children:"Cerrar Sesión"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})};function Ue(){const[s,r]=a.useState(0),[t,c]=a.useState(()=>{const i=localStorage.getItem("leidas");return i?JSON.parse(i):{}});return a.useEffect(()=>{const i=Y(A,"db_notificaciones"),l=Te(i,n=>{const x=n.docs.map(h=>({id:h.id,...h.data()})).filter(h=>!t[h.id]);r(x.length)});return()=>l()},[t]),s===0?null:e.jsx(e.Fragment,{children:s>99?"99+":s})}const za=({toggleRendimiento:s})=>{const[r,t]=a.useState({personalEntrega:[],salidasArtUsuarioMap:[]});a.useEffect(()=>{(async()=>{const n=(await X(Y(A,"db_art_diez_bis_desactivados"))).docs.map(o=>o.data());c(n)})()},[]);const c=i=>{const l={},n={};i.forEach(h=>{h.personal_entrega.forEach(u=>{const j=u.nombre.split(" ")[0],g=`${u.ni} - ${j}`;l[g]=(l[g]||0)+1}),h.salida_art_usuario&&(n[h.salida_art_usuario]=(n[h.salida_art_usuario]||0)+1)});const o=Object.entries(l).map(([h,u])=>({key:h,value:u})).sort((h,u)=>u.value-h.value),x=Object.entries(n).map(([h,u])=>({usuario:h,cantidad:u})).sort((h,u)=>u.cantidad-h.cantidad);t({personalEntrega:o,salidasArtUsuarioMap:x})};return e.jsxs("div",{className:"container ",children:[e.jsx("div",{className:"modal-header border border-0 p-1 m-1 text-white",children:e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:s})}),e.jsx("div",{className:"card ",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center  bg-primary text-white rounded p-2",children:["Rendimiento en Personal Entrega ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Posición"}),e.jsx("th",{scope:"col",children:"Personal"}),e.jsx("th",{scope:"col",children:"Distinción"})]})}),e.jsx("tbody",{children:r.personalEntrega.length>0?r.personalEntrega.map(({key:i,value:l},n)=>e.jsxs("tr",{className:n===0?"table-warning":"",children:[e.jsx("td",{children:n===0?"👑 1":n===1?"🥈 2":n===2?"🥉 3":n+1}),e.jsx("td",{children:i}),e.jsx("td",{children:n===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):n===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):n===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},i)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No hay datos disponibles"})})})]})]})})]})},Ta=({notif:s})=>e.jsxs("div",{className:"list-group-item d-flex justify-content-between align-items-center my-2 py-3 shadow",children:[e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-person-arms-up me-3 text-primary"}),e.jsx("strong",{children:s.nombre_apellido||"Nombre desconocido"}),e.jsxs("span",{children:[" - ",s.dni||"DNI no disponible"]})]}),e.jsx("span",{className:"badge bg-primary",children:s.comisaria||"Sin fecha"})]}),Oa=({toggleBusqueda:s})=>{const[r,t]=a.useState([]),[c,i]=a.useState([]),[l,n]=a.useState(""),[o,x]=a.useState(!1),h=async()=>{try{x(!0);const j=ge(Y(A,"db_art_diez_bis"),Se("visualidad","==",!0)),N=(await X(j)).docs.map(d=>({id:d.id,...d.data()}));t(N),i(N)}catch(j){console.error("Error al obtener las notificaciones: ",j)}finally{x(!1)}};a.useEffect(()=>{h()},[]),a.useEffect(()=>{const j=r.filter(g=>g.nombre_apellido&&g.nombre_apellido.toLowerCase().includes(l.toLowerCase())||g.dni&&g.dni.toString().includes(l));i(j)},[l,r]);const u=()=>{n("")};return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"modal-header border border-0  text-white m-0 p-0",children:e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:s})}),e.jsxs("h5",{className:"text-center  bg-primary text-white rounded p-1 mt-3 ",children:["Buscar Persona ",e.jsx("i",{className:"ms-2 bi bi-search"})]}),e.jsxs("div",{className:"input-group mb-4",children:[e.jsx("span",{className:"input-group-text bg-blueW",children:e.jsx("i",{className:"bi bi-search text-primary "})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por DNI o nombre...",value:l,onChange:j=>n(j.target.value)}),l&&e.jsx("button",{className:"btn btn-outline-pink bg-secondaryMuiRed",onClick:u,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash3-fill text-white"})})]}),o?e.jsx("div",{className:"text-center my-4",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsx("ul",{className:"list-group",children:c.length>0?c.map(j=>e.jsx(Ta,{notif:j},j.id)):e.jsx("li",{className:"list-group-item text-center text-danger",children:l?`No se encontraron resultados para "${l}"`:"No hay notificaciones disponibles"})})]})},Ba=({togglePlazas:s})=>{const[r,t]=a.useState([]),[c,i]=a.useState([]),[l,n]=a.useState([]),[o,x]=a.useState("nombre"),h=async()=>{try{const m=(await X(Y(A,"db_comisarias"))).docs.map(f=>({id:f.id,...f.data()})).filter(f=>f.disponibilidad===!0);t(m)}catch(b){console.error("Error al obtener las comisarías: ",b)}},u=async()=>{try{const m=(await X(Y(A,"db_art_diez_bis"))).docs.map(v=>({id:v.id,...v.data()})),f=m.filter(v=>v.visualidad===!0&&v.comisaria_recibe===!0),C=m.filter(v=>v.visualidad===!1&&v.comisaria_recibe===!1);i(f),n(C)}catch(b){console.error("Error al obtener las notificaciones: ",b)}};a.useEffect(()=>{h(),u()},[]);const j=c.reduce((b,m)=>{const f=m.comisaria;return f&&(b[f]=(b[f]||0)+1),b},{}),g=l.reduce((b,m)=>{const f=m.comisaria;return f&&(b[f]=(b[f]||0)+1),b},{}),N=b=>{const m=r.find(f=>f.comisaria===b);if(m){const f=m.plazas_art_10_bis||0;return(j[b]||0)>=f?{estado:"Llena",clase:"badge bg-danger"}:{estado:"Disponible",clase:"badge bg-info"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},d=()=>o==="nombre"?[...r].sort((b,m)=>b.comisaria.localeCompare(m.comisaria)):o==="plaza"?[...r].sort((b,m)=>(m.plazas_art_10_bis||0)-(b.plazas_art_10_bis||0)):r;return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"modal-header border border-0 p-0 m-0 text-white",children:e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:s})}),e.jsxs("h5",{className:"text-center mb-4 bg-primary text-white rounded p-1 mt-3",children:["Plazas Art 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-shield-lock"})]}),e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select",id:"filtroOrden",value:o,onChange:b=>x(b.target.value),"aria-label":"Ordenar por",children:[e.jsx("option",{value:"nombre",children:"Nombre (A-Z)"}),e.jsx("option",{value:"plaza",children:"Plazas Disponibles"})]}),e.jsx("label",{htmlFor:"filtroOrden",children:"Ordenar por"})]}),e.jsx("div",{className:"list-group",children:d().map(b=>{const{estado:m,clase:f}=N(b.comisaria),C=j[b.comisaria]||0,v=g[b.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{children:b.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:f,children:`${C} / ${b.plazas_art_10_bis||0} Plazas - ${m}`}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary",children:`${v} Pendientes ( Por Validar )`})})]})]})]})},b.comisaria)})})]})},Ua=({showModal:s,closeModal:r})=>{const t={Rosario:["Comisaria 1ra. - Sección Centro","Comisaria 2da. - Sección Puerto Norte","Comisaria 3ra. - Sección Tucuman","Comisaria 4ta. - Sección Echesortu","Comisaria 5ta. - Sección Pichincha","Comisaria 6ta. - Sección Zona Sur","Comisaria 7ma. - Sección La Florida","Comisaria 8va. - Sección Zona Oeste"]},c=["CRE Rosario","CRE Baigorria","BOU","BOP","AUOP","MOTORIZADA","CGI","PAT","CYP","VIAL","PUMAS","OTROS"],[i,l]=a.useState("Rosario"),[n,o]=a.useState(""),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState(""),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!1),p=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/,[y,S]=a.useState([]),[F,_]=a.useState(""),[k,M]=a.useState(""),[$,U]=a.useState([]),Q=new Date().toLocaleString(),H=L=>p.test(L),V=()=>{if(!H(u)){f("El nombre y apellido solo deben contener letras y espacios.");return}if(g.length!==8||isNaN(g)){v("El DNI debe ser un número de 8 caracteres.");return}U([...$,{nombreApellido:u,dni:g}]),j(""),N(""),f("")},ie=()=>{if(k.length!==6||isNaN(k)){v("El NI debe ser un número de 6 caracteres.");return}if(!H(F)){v("El nombre no debe contener números.");return}S([...y,{nombre:F,ni:k}]),_(""),M(""),v("")},oe=async L=>{if(L.preventDefault(),!n){b("Por favor, selecciona una comisaría.");return}if(!x){b("Por favor, selecciona una unidad.");return}if($.length===0){b("Debes agregar al menos una persona.");return}if(y.length===0){b("Debes agregar al menos una persona para la entrega.");return}if(!window.confirm("¿Estás seguro de que deseas agregar Art. 10 Bis?")){alert("La operación fue cancelada.");return}b(""),D(!0);try{const se=JSON.parse(localStorage.getItem("user"));for(let ae=0;ae<$.length;ae++){const re=$[ae];await ye(Y(A,"db_art_diez_bis"),{nombre_apellido:re.nombreApellido,dni:re.dni,selectedLocalidad:i,comisaria:n.split(".")[0].trim(),unidad:x,timestamp:Q,usuario:(se==null?void 0:se.email)||"Usuario desconocido",visualidad:!1,comisaria_recibe:!1,personal_entrega:y})}alert("Se agregaron las personas con Art. 10 Bis."),j(""),N(""),o(""),h(""),l("Rosario"),S([]),r()}catch(se){console.error("Error al enviar notificación: ",se),b("Error al enviar la notificación. Inténtalo de nuevo.")}finally{D(!1)}},J=L=>{const G=$.filter((se,ae)=>ae!==L);U(G)},Z=L=>{const G=y.filter((se,ae)=>ae!==L);S(G)};return s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-dark",children:[e.jsx("h5",{className:"modal-title text-center fw-semibold text-white",children:"Agregar Persona - Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:r})]}),e.jsx("div",{className:"modal-body",children:e.jsx("form",{onSubmit:oe,children:e.jsxs("div",{className:"container ",children:[e.jsxs("div",{className:"mb-3 text-center",children:[d&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),d]}),m&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),m]}),C&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar"}),C]})]}),e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-primary fw-semibold shadow-sm text-white py-2 rounded",children:"Agregar personas 10 Bis"}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${m&&!p.test(u)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:u,onChange:L=>j(L.target.value)}),e.jsx("label",{htmlFor:"nombreApellido",children:"Nombre y Apellido"}),m&&!p.test(u)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${m&&(g.length!==8||isNaN(Number(g)))?"is-invalid":""}`,maxLength:"8",placeholder:"DNI",value:g,onChange:L=>N(L.target.value.replace(/[^\d]/g,""))}),e.jsx("label",{htmlFor:"dni",children:"DNI"}),m&&(g.length!==8||isNaN(Number(g)))&&e.jsx("div",{className:"invalid-feedback",children:"El DNI debe ser un número de hasta 8 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-primary shadow-sm rounded-circle",onClick:()=>V(),children:"+"})})]}),$.map((L,G)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 "}),L.nombreApellido," - ",L.dni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>J(G),children:e.jsx("i",{className:"bi bi-trash"})})]},G)),e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-pink fw-semibold shadow-sm text-white py-2 rounded",children:"Dependencia Destino"}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("select",{className:`form-select ${d&&!i?"is-invalid":""}`,value:i,onChange:L=>l(L.target.value),children:e.jsx("option",{value:"Rosario",children:"Rosario"})}),e.jsx("label",{htmlFor:"localidad",children:"Localidad"}),d&&!i&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una localidad."})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:`form-select ${d&&!n?"is-invalid":""}`,value:n,onChange:L=>o(L.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Comisaría"}),(t[i]||[]).map(L=>e.jsx("option",{value:L,children:L},L))]}),e.jsx("label",{htmlFor:"comisaria",children:"Comisaría"}),d&&!n&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una comisaría."})]})})]}),e.jsxs("div",{className:"mb-3 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-blue fw-semibold shadow-sm text-white py-2 rounded",children:"Unidad Procede a la Entrega"}),e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{id:"unidad",className:`form-select ${d&&!x?"is-invalid":""}`,value:x,onChange:L=>h(L.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Unidad"}),c.map(L=>e.jsx("option",{value:L,children:L},L))]}),e.jsx("label",{htmlFor:"unidad",children:"Unidad Procede a la Entrega"}),d&&!x&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una unidad."})]})]}),e.jsxs("div",{className:"mb-3 text-center mt-4",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-secondaryM fw-semibold shadow-sm text-white py-2 rounded",children:"Mi Unidad de Trabajo"}),e.jsxs("div",{className:"row g-2 mb-2",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${C&&!p.test(F)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:F,onChange:L=>_(L.target.value)}),e.jsx("label",{htmlFor:"nombreEntrega",children:"Nombre y Apellido"}),C&&!p.test(F)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${C&&(k.length!==6||isNaN(k))?"is-invalid":""}`,placeholder:"N.I",maxLength:"6",value:k,onChange:L=>M(L.target.value)}),e.jsx("label",{htmlFor:"niEntrega",children:"N.I"}),C&&(k.length!==6||isNaN(k))&&e.jsx("div",{className:"invalid-feedback",children:"El N.I debe ser un número de 6 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-primary shadow-sm rounded-circle",onClick:()=>ie(),children:"+"})})]}),y.map((L,G)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light mt-3",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 "}),L.nombre," - ",L.ni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>Z(G),children:e.jsx("i",{className:"bi bi-trash"})})]},G))]}),e.jsx("div",{className:"text-center mb-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary shadow",disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-arrow-repeat me-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),"Confirmar"]})})})," "]})})})]})})}):null},qa=({notif:s})=>e.jsxs("div",{className:"list-group-item d-flex justify-content-between align-items-center my-2 py-3 shadow",children:[e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-person-arms-up me-3 text-primary"}),e.jsx("strong",{children:s.nombre_apellido||"Nombre desconocido"}),e.jsxs("span",{children:[" - ",s.dni||"DNI no disponible"]})]}),e.jsx("span",{className:"badge bg-primary",children:s.comisaria||"Sin fecha"})]}),Va=({toggleBusqueda:s})=>{const[r,t]=a.useState([]),[c,i]=a.useState([]),[l,n]=a.useState(""),[o,x]=a.useState(!1),h=async()=>{try{x(!0);const j=ge(Y(A,"db_art_diez_bis"),Se("visualidad","==",!0)),N=(await X(j)).docs.map(d=>({id:d.id,...d.data()}));t(N),i(N)}catch(j){console.error("Error al obtener las notificaciones: ",j)}finally{x(!1)}};a.useEffect(()=>{h()},[]),a.useEffect(()=>{const j=r.filter(g=>g.nombre_apellido&&g.nombre_apellido.toLowerCase().includes(l.toLowerCase())||g.dni&&g.dni.toString().includes(l));i(j)},[l,r]);const u=()=>{n("")};return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"modal-header border border-0 m-0",children:e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:s})}),e.jsxs("h5",{className:"text-center  bg-primary text-white rounded p-2",children:["Ingreso Articulo 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-search"})]}),e.jsxs("div",{className:"input-group mb-4",children:[e.jsx("span",{className:"input-group-text bg-blueW",children:e.jsx("i",{className:"bi bi-search text-primary "})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por DNI o nombre...",value:l,onChange:j=>n(j.target.value)}),l&&e.jsx("button",{className:"btn btn-outline-pink bg-secondaryMuiRed",onClick:u,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash3-fill text-white"})})]}),o?e.jsx("div",{className:"text-center my-4",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsx("ul",{className:"list-group",children:c.length>0?c.map(j=>e.jsx(qa,{notif:j},j.id)):e.jsx("li",{className:"list-group-item text-center text-danger",children:l?`No se encontraron resultados para "${l}"`:"No hay notificaciones disponibles"})})]})},Ga=({comisariaSeleccionada:s,cantidadDemorados:r})=>{const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1);return!s||!r?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-3 ",children:e.jsxs("button",{className:"btn btn-primary w-100",onClick:i,children:[e.jsx("i",{className:"bi bi-file-earmark-plus-fill me-2"})," Crear Formulario"]})}),t&&e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Formulario de Creación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Comisaría:"})," ",s]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Cantidad de demorados:"})," ",r]}),e.jsx("div",{className:"alert alert-warning",children:"Aquí irá el formulario personalizado."})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cerrar"}),e.jsx("button",{className:"btn btn-primary",children:"Guardar Formulario"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Wa=({comisariaSeleccionada:s,cantidadDemorados:r})=>{const t=s&&r>0;return e.jsxs("div",{className:"alert alert-info mt-3",children:[e.jsx("strong",{children:"Resumen de Selección"}),e.jsxs("p",{className:"mb-1",children:["Comisaría Seleccionada:"," ",e.jsx("strong",{children:s?e.jsxs(e.Fragment,{children:[s," ",e.jsx("i",{className:"bi bi-building-fill-check text-primary"})]}):e.jsx("span",{className:"text-pink",children:"Ninguna"})})]}),e.jsxs("p",{className:"mb-0",children:["Cantidad de Demorados:"," ",e.jsx("strong",{children:r?e.jsxs(e.Fragment,{children:[r," ",e.jsx("i",{className:"bi bi-person-add text-primary"})]}):0})]}),t&&e.jsx(Ga,{comisariaSeleccionada:s,cantidadDemorados:r})]})},Ha=({togglePlazas:s,cantidadDemorados:r})=>{const[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState([]),[x,h]=a.useState(""),[u,j]=a.useState("nombre"),[g,N]=a.useState(!0);a.useEffect(()=>{d(),b()},[]);const d=async()=>{try{const p=(await X(Y(A,"db_comisarias"))).docs.map(y=>({id:y.id,...y.data()})).filter(y=>y.disponibilidad===!0);c(p),N(!1)}catch(D){console.error("Error al obtener comisarías:",D),N(!1)}},b=async()=>{try{const p=(await X(Y(A,"db_art_diez_bis"))).docs.map(y=>({id:y.id,...y.data()}));l(p.filter(y=>y.visualidad===!0&&y.comisaria_recibe===!0)),o(p.filter(y=>y.visualidad===!1&&y.comisaria_recibe===!1))}catch(D){console.error("Error al obtener notificaciones:",D)}},m=i.reduce((D,p)=>{const y=p.comisaria;return y&&(D[y]=(D[y]||0)+1),D},{}),f=n.reduce((D,p)=>{const y=p.comisaria;return y&&(D[y]=(D[y]||0)+1),D},{}),C=D=>{const p=t.find(y=>y.comisaria===D);if(p){const y=p.plazas_art_10_bis||0,S=m[D]||0,F=y-S;return S>=y?{estado:"Llena",clase:"badge bg-danger"}:{estado:`Disponible (${F} libres)`,clase:"badge bg-secondaryM"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},v=()=>u==="nombre"?[...t].sort((D,p)=>D.comisaria.localeCompare(p.comisaria)):u==="plaza"?[...t].sort((D,p)=>(p.plazas_art_10_bis||0)-(D.plazas_art_10_bis||0)):t,w=D=>r?D.filter(p=>{const y=m[p.comisaria]||0;return(p.plazas_art_10_bis||0)-y>=r}):D;return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("strong",{children:"Comisarías con plazas disponibles"}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:s,children:e.jsx("i",{className:"bi bi-trash3-fill"})})]}),g?e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsxs("div",{className:"list-group",children:[w(v()).map(D=>{const{estado:p,clase:y}=C(D.comisaria),S=m[D.comisaria]||0,F=f[D.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow",onClick:()=>{h(D.comisaria)},style:{cursor:"pointer"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{children:D.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:y,children:`${S} / ${D.plazas_art_10_bis||0} Plazas `}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary mt-1",children:`${F} Pendientes (por validar)`})})]})]})]})},D.comisaria)}),e.jsx("div",{className:"container mt-1",children:e.jsx(Wa,{cantidadDemorados:r,comisariaSeleccionada:x})})]})]})},Ya=({show:s,onClose:r,onConfirm:t})=>{const[c,i]=a.useState(1),[l,n]=a.useState(!1),[o,x]=a.useState(null);if(!s)return null;const h=()=>{const u=parseInt(c,10);x(u),n(!0)};return e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",children:e.jsxs("div",{className:"modal-content ",children:[e.jsxs("div",{className:"modal-header border border-0 bg-primary text-white",children:[e.jsx("h5",{className:"modal-title text-capitalize ",children:"Cantidad de demorados"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:r})]}),"   ",e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text  fw-semibold ",children:"Plaza/s"}),e.jsx("input",{type:"number",className:"form-control text-center",value:c,onChange:u=>i(u.target.value),min:"1",max:"10","aria-describedby":"cantidadAddon","aria-label":"Cantidad"}),e.jsx("button",{className:"btn btn-outline-secondary",type:"button",id:"cantidadAddon",onClick:h,children:"Aceptar"})]}),l&&e.jsx(Ha,{togglePlazas:()=>n(!1),cantidadDemorados:o})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Cancelar"})})]})})})},Ja=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),[i,l]=a.useState(!1),[n,o]=a.useState(!1),[x,h]=a.useState(!1),[u,j]=a.useState(!1),[g,N]=a.useState(!1),[d,b]=a.useState([]),m=we(),f=_=>{console.log(`Se demorarán ${_} personas`),c(!1)},C=()=>{l(!1),o(!1),N(!1),j(!1),h(!1),r()},v=()=>j(_=>!_),w=()=>h(_=>!_),D=()=>N(_=>!_),p=()=>o(_=>!_);a.useEffect(()=>{b([{id:"preformulario",component:e.jsx(Va,{togglePreFormulario:p}),visible:n},{id:"busqueda",component:e.jsx(Oa,{toggleBusqueda:v}),visible:u},{id:"plazas",component:e.jsx(Ba,{togglePlazas:w}),visible:x},{id:"rendimiento",component:e.jsx(za,{toggleRendimiento:D}),visible:g}])},[u,x,g,n]);const y=(_,k)=>{_.dataTransfer.setData("index",k)},S=(_,k)=>{_.preventDefault();const M=_.dataTransfer.getData("index");if(M!==null){const $=[...d],[U]=$.splice(M,1);$.splice(k,0,U),b($)}},F=_=>_.preventDefault();return a.useEffect(()=>{if(m.pathname==="/dashboard"){const _=()=>C();return window.history.pushState(null,document.title),window.addEventListener("popstate",_),()=>window.removeEventListener("popstate",_)}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content bg-blueW2",children:[e.jsxs("div",{className:"modal-header border-0",children:[e.jsxs("h5",{className:"modal-title",id:"modalTitle",children:["Menú Artículo 10 Bis",e.jsx("hr",{className:"color-gradient opacity-50 p-0 m-1"})]}),e.jsx("button",{type:"button",className:"btn-close bg-prima",onClick:C})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"d-grid gap-2 col-8 mx-auto",children:[e.jsxs("button",{className:"btn btn-blue my-2",onClick:()=>{j(!1),N(!1),h(!1),l(!1),c(!0)},children:["Personas 10 Bis ",e.jsx("i",{className:"bi bi-person-lines-fill"})]}),e.jsxs("button",{className:"btn btn-primary my-2",onClick:v,children:[u?"Ocultar Búsqueda":"Búsqueda"," ",e.jsx("i",{className:"bi bi-search mx-1"})]}),e.jsxs("button",{className:"btn btn-primaryMuiBlue text-white my-2",onClick:D,children:[g?"Ocultar Rendimiento":"Rendimiento"," ",e.jsx("i",{className:"bi bi-bar-chart mx-1"})]}),e.jsxs("button",{className:"btn btn-cyan text-white my-2",onClick:w,children:[x?"Ocultar Plazas":"Plazas"," ",e.jsx("i",{className:"bi bi-shield-lock mx-1"})]})]}),e.jsx("div",{className:"mt-3",children:d.map((_,k)=>_.visible?e.jsx("div",{draggable:!0,onDragStart:M=>y(M,k),onDragOver:F,onDrop:M=>S(M,k),className:"mt-3 border p-2 bg-light border-2",style:{cursor:"grab"},children:_.component},_.id):null)}),i&&e.jsx("div",{className:"container my-4",children:e.jsx(Ua,{showModal:s,closeModal:C})}),e.jsx("div",{className:"container my-4",children:e.jsx(Ya,{show:t,onClose:()=>c(!1),onConfirm:f})})]})]})})}):null},Ae=({notificationCount:s=0})=>{const[r,t]=a.useState(!1),c=()=>t(!1);return e.jsxs("nav",{className:"navbar navbar-expand-lg style-navbar-infoUser ",children:[e.jsx("div",{className:"container-lg ",children:e.jsxs("div",{className:"collapse navbar-collapse ",id:"navbarNav",children:[e.jsxs("ul",{className:"navbar-nav me-auto",children:[e.jsx("li",{className:"nav-item d-none d-md-flex",children:e.jsxs(pe,{to:"/dashboard",className:"nav-link d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-house text-white p-1 px-2 rounded shadow me-2 bg-indigoMui "}),e.jsx("span",{className:"mx-2",children:"Inicio"})]})}),e.jsx("li",{className:"nav-item d-flex ",onClick:()=>t(!0),children:e.jsxs(pe,{className:"nav-link d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-file-person text-white p-1 px-2 rounded shadow me-2 bg-blueMui "}),e.jsx("span",{className:"mx-2",children:"Art 10 Bis"})]})}),e.jsx("li",{className:"nav-item d-none d-md-flex position-relative",children:e.jsxs(pe,{to:"/notificaciones",className:"nav-link d-flex align-items-center",children:[e.jsx("i",{className:" btn btn-primary bi bi-bell text-white p-1 px-2 rounded shadow me-2 "}),e.jsx("span",{className:"mx-2",children:"Notificaciones"}),e.jsxs("span",{className:"position-absolute top-1 start-100 translate-middle badge rounded-pill bg-danger",children:[e.jsx(Ue,{notificationCount:s}),e.jsx("span",{className:"visually-hidden",children:"notificaciones"})]})]})})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"pe-3 d-flex align-items-center",children:[e.jsx("img",{src:"img/Perfiles/3.png",alt:"Asistente",style:{width:"50px",height:"40px",objectFit:"contain"},className:"rounded-circle p-0 shadow-sm d-none d-sm-table-cell"}),e.jsx(Zs,{})]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsx(Qs,{}),e.jsx("i",{className:"bi bi-door-closed text-secondaryMuiRed "})]})]})}),e.jsx(Ja,{showModal:r,closeModal:c})]})},Ee=({data1:s,data2:r,data3:t})=>{const c=s||"© 2025 Tics, Inc",i=r||"Cx2",l=t||"Policía de Santa Fe";return e.jsx("div",{className:"container-lg text-center mt-5",children:e.jsxs("footer",{className:"d-flex flex-wrap justify-content-between align-items-center pt-4 my-4 border-top",children:[e.jsx("p",{className:"col-md-4 mb-0 text-body-secondary",children:c}),e.jsx("a",{href:"/",className:"col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none d-none d-md-block","aria-label":"Inicio",children:e.jsx("img",{className:"opacity-50",src:"/img/Escudo Pol SF Color Original_BN.png",width:"35",height:"32",alt:"Escudo Policía Santa Fe"})}),e.jsx("ul",{className:"nav col-md-4 justify-content-center",children:e.jsxs("li",{className:"nav-item",children:[e.jsx("strong",{children:i})," / ",e.jsx("strong",{children:l})," "]})})]})})};Ee.propTypes={data1:ve.string,data2:ve.string,data3:ve.string};const Za=()=>{const[s,r]=a.useState(null);a.useEffect(()=>{const c=i=>{i.preventDefault(),r(i),console.log("Evento beforeinstallprompt capturado.")};return window.addEventListener("beforeinstallprompt",c),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const t=async()=>{alert("Recuerda que en dispositivos móviles puedes instalar la app desde el menú (...) -> 'Agregar a la pantalla de principal'."),s&&(s.prompt(),(await s.userChoice).outcome==="accepted"?console.log("El usuario aceptó la instalación."):console.log("El usuario rechazó la instalación."),r(null))};return e.jsx("div",{className:"container-lg text-center py-2 text-capitalize text-secondary fs-3 fw-semibold col-9 col-sm-12 px-4 col-md-12",children:e.jsxs("button",{className:"btn btn-teal text-white border border-white border-5 rounded-pill w-100 mb-4 shadow-sm d-flex align-items-center position-relative",type:"button",onClick:t,children:[e.jsx("span",{className:"bg-light text-teal d-flex justify-content-center align-items-center rounded-circle shadow-lg position-absolute top-50 translate-middle-y start-0 ms-3 border border-5",style:{width:"60px",height:"60px"},children:e.jsx("i",{className:"bi bi-android2 fs-3"})}),e.jsxs("span",{className:"flex-grow-1 text-center fw-semibold",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Instalar App"}),e.jsx("span",{className:"d-inline d-md-none ms-5",children:"Instalar App"})]})]})})},Me=()=>{const s=Qe();a.useEffect(()=>{const t=document.getElementById("offcanvasNavbar"),c=()=>{document.body.style.overflow="",document.body.style.paddingRight=""};return t.addEventListener("hide.bs.offcanvas",c),()=>{t.removeEventListener("hide.bs.offcanvas",c)}},[]);const r=t=>{const c=document.getElementById("offcanvasNavbar"),i=bootstrap.Offcanvas.getInstance(c);i&&i.hide(),s(t)};return e.jsx("div",{children:e.jsx("nav",{className:"navbar fixed-top p-1 pt-3",children:e.jsxs("div",{className:"container-lg d-flex align-items-center ",children:[e.jsx(pe,{className:"navbar-brand",to:"/dashboard",children:e.jsx("img",{src:"/img/logo-login-2024.png",height:"35",width:"110",alt:"Logo",className:"m-1"})}),e.jsxs("span",{className:"d-none d-md-block ms-2",children:["|",e.jsx("span",{className:"fw-semibold",children:" Cx2 "})," ",e.jsx("span",{className:"fw-semibold text-orange",children:" - "})," Modulo de Información"]}),e.jsxs("button",{className:"btn btn-pink ms-auto d-flex align-items-center justify-content-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasNavbar","aria-controls":"offcanvasNavbar","aria-label":"Toggle navigation",children:[e.jsx("i",{className:"bi bi-list me-2"}),"Abrir Menú"]}),e.jsxs("div",{className:"offcanvas offcanvas-end ",tabIndex:"-1",id:"offcanvasNavbar","aria-labelledby":"offcanvasNavbarLabel",children:[e.jsxs("div",{className:"offcanvas-header d-flex justify-content-center align-items-center",children:[e.jsx("a",{className:"navbar-brand",href:"#",children:e.jsx("img",{src:"/img/logo-login-2024.png",height:"35",width:"110",alt:"Logo"})}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]}),e.jsx("hr",{className:"color-gradient opacity-50 p-0"}),e.jsx("div",{className:"offcanvas-body",children:e.jsxs("ul",{className:"navbar-nav text-center flex-grow-1 pe-3",children:[e.jsx("li",{className:"nav-item my-2",children:e.jsxs(pe,{className:"nav-link",to:"/dashboard",onClick:()=>r("/dashboard"),children:[e.jsx("i",{className:"bi bi-house text-indigoMui p-1 px-2 rounded shadow me-3 bg-indigoMui2"}),"Inicio"]})}),e.jsx("li",{className:"nav-item my-2",children:e.jsxs(pe,{className:"nav-link position-relative me-2",to:"/notificaciones",onClick:()=>r("/notificaciones"),children:[e.jsx("i",{className:"i bi-bell text-primary p-1 px-2  me-3 rounded shadow me-2 bg-blueW"}),"Notificaciones",e.jsx("span",{className:"position-absolute top-1 start-75 translate-middle badge rounded-pill bg-danger ms-3",children:e.jsx(Ue,{})})]})}),e.jsx("li",{className:"nav-item my-2",children:e.jsxs(pe,{className:"nav-link",to:"/10bis",onClick:()=>r("/bis"),children:[e.jsx("i",{className:"bi bi-arrow-bar-right text-greenMui  p-1 px-2 rounded shadow me-3 bg-greenMui2"}),"Recepción 10 Bis"]})}),e.jsx("li",{className:"nav-item my-2",children:e.jsxs(pe,{className:"nav-link",to:"/10bisout",onClick:()=>r("/bis"),children:[e.jsx("i",{className:"bi bi-arrow-bar-left  text-redMui me-3 p-1 px-2 rounded shadow  bg-redMui2"}),"Salida 10 Bis"]})}),e.jsx("li",{className:"nav-item dropdown text-center mt-5",children:e.jsxs("div",{className:"card  shadow  position-relative text-dark d-flex align-items-start gap-3 p-4 mt-3",style:{overflow:"visible"},children:[e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2","data-bs-dismiss":"offcanvas","aria-label":"Close"}),e.jsx("img",{src:"img/Perfiles/10.png",alt:"Asistente",className:" position-absolute",style:{width:"120px",height:"200px",objectFit:"contain",top:"-30px",left:"-20px"}}),e.jsxs("div",{className:"w-100 ",style:{paddingLeft:"70px"},children:[e.jsx("h5",{className:"mb-4",children:e.jsx("strong",{children:"Herramientas"})}),e.jsx("p",{className:"mb-3",children:e.jsxs(pe,{className:"dropdown-item text-center  text-secondary",to:"/panelcontrol10bis",onClick:()=>r("/panelcontrol10bis"),children:[e.jsx("i",{className:"bi bi-speedometer2 me-2 text-indigo me-3 p-1 px-2 rounded shadow  bg-indigoMui2"}),"  Art 10 Bis",e.jsx("span",{className:"badge bg-indigoMui2 text-indigoMui rounded-pill ms-3",children:"Panel "})]})}),e.jsx("p",{className:"mb-2",children:e.jsxs(pe,{className:"dropdown-item text-center  text-secondary",to:"/panelcontrol",onClick:()=>r("/panelcontrol"),children:[e.jsx("i",{className:"bi bi-speedometer2 me-2 text-indigo me-3 p-1 px-2 rounded shadow  bg-indigoMui2"})," Capturas",e.jsx("span",{className:"badge bg-indigoMui2 text-indigoMui rounded-pill ms-2",children:"Panel "})]})}),e.jsx("p",{className:"mb-3",children:e.jsxs(pe,{className:"nav-link",to:"/formularios",onClick:()=>r("/formularios"),children:[e.jsx("i",{className:"bi bi-pencil-square  me-2 text-green me-3 p-1 px-2 rounded shadow  bg-greenMui2 "}),"Formulario",e.jsx("span",{className:"badge bg-greenUi rounded-pill ms-3"})]})}),e.jsx("strong",{})]})]})})]})}),e.jsxs("div",{className:"d-flex align-items-center ms-3 my-3",children:[e.jsxs("div",{className:"pe-3 d-flex align-items-center",children:[e.jsx("img",{src:"img/Perfiles/3.png",alt:"Asistente",style:{width:"50px",height:"40px",objectFit:"contain"},className:"rounded-circle p-0 shadow-sm "}),e.jsx(Zs,{})]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsx(Qs,{}),e.jsx("i",{className:"bi bi-door-closed text-secondaryMuiRed "})]}),e.jsx(Za,{})]})]})})})},je=()=>{const[s,r]=a.useState(!1),[t,c]=a.useState(()=>localStorage.getItem("theme")==="dark"),i=l=>{r(!0),c(l==="dark"),setTimeout(()=>r(!1),1e3)};return a.useEffect(()=>{const l=t?"dark":"light";document.body.setAttribute("data-bs-theme",l),localStorage.setItem("theme",l)},[t]),e.jsxs("div",{children:[s&&e.jsx(ne,{})," ",e.jsxs("div",{className:"dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle",children:[e.jsxs("button",{className:"btn btn-greenUi py-2 dropdown-toggle d-flex align-items-center rounded-4",id:"bd-theme",type:"button","aria-expanded":"false","data-bs-toggle":"dropdown","aria-label":"Toggle theme (light)",children:[e.jsx("i",{className:t?"bi bi-moon-stars-fill":"bi bi-brightness-high-fill",width:"1em",height:"1em"}),e.jsx("span",{className:"visually-hidden",id:"bd-theme-text",children:"Toggle theme"})]}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow","aria-labelledby":"bd-theme-text",children:[e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${t?"":"active"}`,"data-bs-theme-value":"light","aria-pressed":!t,onClick:()=>i("light"),children:[e.jsx("i",{className:"bi bi-brightness-high-fill me-2 opacity-50",width:"1em",height:"1em"}),"Modo Luz"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${t?"active":""}`,"data-bs-theme-value":"dark","aria-pressed":t,onClick:()=>i("dark"),children:[e.jsx("i",{className:"bi bi-moon-stars-fill me-2 opacity-50",width:"1em",height:"1em"}),"Modo Nocturno"]})})]})]})]})},Qa=()=>e.jsx("div",{className:"container-lg my-3",children:e.jsxs("div",{className:"row align-items-center mb-5  shadow-sm p-2  mx-5 ",children:[e.jsx("div",{className:"col-md-8 text-end ",children:e.jsx("span",{className:"fs-1 card-title text-secondary text-capitalize",children:"Auditoria / Administar recursos"})}),e.jsx("div",{className:"col-md-4 text-center",children:e.jsx("img",{src:"/img/logo-login-2024.png",alt:"Animación de galería de imágenes",className:"img-fluid animate__animated animate__fadeIn",style:{maxWidth:"130px"}})})]})}),fe="/svg/undraw_male_avatar_g98dG.svg",Xa=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState(null),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState(""),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState("1"),[p,y]=a.useState("masculino"),[S,F]=a.useState(""),[_,k]=a.useState(""),[M,$]=a.useState(""),[U,Q]=a.useState(!1),H=Y(A,"db_personas"),V=async()=>{o(!0);try{const Z=(await X(H)).docs.map(L=>({...L.data(),id:L.id}));r(Z),c(Z)}catch(J){console.error("Error al obtener personas: ",J)}finally{o(!1)}};a.useEffect(()=>{V()},[]),a.useEffect(()=>{c(s.filter(J=>J.nombre_apellido&&J.nombre_apellido.toLowerCase().includes(M.toLowerCase())))},[M,s]);const ie=J=>{l(J.id),j(J.descripcion_fisica),N(J.documento),b(J.entidad),f(J.motivo_captura),v(J.nombre_apellido),D(J.prioridad),y(J.sexo),F(J.usuario),k(J.numero_contacto),h("")},oe=async()=>{const J=W(A,"db_personas",i),Z=w==="3";try{await le(J,{descripcion_fisica:u,documento:g,entidad:d,motivo_captura:m,nombre_apellido:C,prioridad:w,sexo:p,numero_contacto:_,alerta:Z}),r(s.map(L=>L.id===i?{...L,descripcion_fisica:u,documento:g,entidad:d,motivo_captura:m,nombre_apellido:C,prioridad:w,sexo:p,numero_contacto:_,alerta:Z}:L)),l(null),h("Los cambios se han guardado correctamente."),setTimeout(()=>h(""),3e3)}catch(L){console.error("Error al actualizar la persona: ",L),h("Error al guardar los cambios. Inténtalo de nuevo."),setTimeout(()=>h(""),3e3)}};return e.jsxs("div",{className:"container-lg mt-5 ",children:[e.jsxs("div",{className:"row justify-content-between align-items-center",children:[e.jsx("div",{className:"col-md-9 col-12 text-center",children:e.jsx("h1",{children:"Lista de Capturas - Personas"})}),e.jsx("div",{className:"col-md-3 col-12 text-center mb-3",children:e.jsxs("button",{className:"btn btn-outline-pink border-pink fw-semibold border border-3 shadow-sm",onClick:()=>Q(!U),children:[U?"Ocultar Lista":"Mostrar Lista",e.jsx("i",{className:"ms-3 bi bi-back"})]})})]}),U&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row mt-5",children:[e.jsxs("div",{className:"col-md-6 col-12 text-end",children:[e.jsx("span",{className:"fs-5 text-capitalize",children:"Filtrar Capturas de Personas por nombre"}),e.jsx("span",{children:e.jsx("i",{className:"bi bi-search mx-3 text-pink"})})]}),e.jsx("div",{className:"col-md-6 col-12",children:e.jsx("input",{type:"text",className:"form-control text-center mb-5 border-primary border-2",placeholder:"Buscar por nombre",value:M,onChange:J=>$(J.target.value)})})]}),n?e.jsx(ne,{}):e.jsx("div",{className:"row ",children:t.map(J=>{var Z,L;return e.jsx("div",{className:"col-md-4 col-12 my-3",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body text-center",children:i===J.id?e.jsxs("div",{children:[e.jsx("h5",{className:"text-center",children:"Editando  "}),e.jsxs("h5",{className:"card-title text-center py-1 mb-4 mt-2 border-dark border text-capitalize fw-semibold rounded-pill shadow",children:[J.nombre_apellido,e.jsx("img",{src:((Z=J.base64)==null?void 0:Z.trim())||fe,alt:J.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2 ms-3",style:{width:"40px",height:"40px",objectFit:"cover"}})]}),J.asociada_notificacion_id&&J.asociada_notificacion_id.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-secondaryMuiRed",children:"Esta persona está afectada a las siguientes notificaciones: "}),e.jsx("p",{className:"text-secondaryMuiRed fw-semibold",children:"Elimina la Asociación antes de editar"}),e.jsx("ul",{children:J.asociada_notificacion_id.map((G,se)=>e.jsxs("li",{children:["Notificación ID: ",G]},se))})]}),x&&e.jsx("div",{className:"alert alert-info",role:"alert",children:x}),e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Nombre y Apellido"}),e.jsx("input",{type:"text",className:"form-control shadow",value:C,onChange:G=>v(G.target.value),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Documento"}),e.jsx("input",{type:"number",className:"form-control shadow",value:g,onChange:G=>N(G.target.value),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Número de Contacto"}),e.jsx("input",{type:"text",className:"form-control shadow",value:_,onChange:G=>k(G.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Prioridad"}),e.jsxs("select",{className:"form-select shadow text-center",value:w,onChange:G=>D(G.target.value),children:[e.jsx("option",{value:"1",children:"Informativa"}),e.jsx("option",{value:"2",children:"Paradero"}),e.jsx("option",{value:"3",className:"text-red fw-semibold ",children:"Evasión"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Sexo"}),e.jsxs("select",{className:"form-select shadow text-center",value:p,onChange:G=>y(G.target.value),children:[e.jsx("option",{value:"masculino",children:"Masculino"}),e.jsx("option",{value:"femenino",children:"Femenino"}),e.jsx("option",{value:"otros",children:"Otros"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Descripción Física"}),e.jsx("textarea",{className:"form-control shadow",rows:"3",value:u,onChange:G=>j(G.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Motivo Captura"}),e.jsx("textarea",{className:"form-control shadow",rows:"3",value:m,onChange:G=>f(G.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold ",children:"Entidad"}),e.jsx("input",{type:"text",className:"form-control shadow",value:d,onChange:G=>b(G.target.value)})]}),e.jsxs("div",{className:"mb-3 mt-4",children:[e.jsx("label",{className:"form-label text-capitalize ",children:"Captura Creada por:"}),e.jsx("input",{type:"text",className:"form-control fw-semibold text-center text-blue bg-blueW",value:S,disabled:!0})]}),e.jsxs("div",{className:"d-flex justify-content-between mt-5",children:[e.jsxs("button",{type:"button",className:"btn text-primaryMuiBlue ",onClick:oe,children:["Guardar Cambios ",e.jsx("i",{className:"px-1 bi bi-check-square"})]}),e.jsxs("button",{type:"button",className:"btn text-secondaryMuiRed e",onClick:()=>l(null),children:["Cancelar ",e.jsx("i",{className:"px-1 bi bi-x-circle"})]})]})]})]}):e.jsxs("div",{children:[e.jsxs("h5",{className:"card-title text-center py-2 mb-4 mt-2 border-dark border text-capitalize fw-semibold rounded-pill shadow",children:[J.nombre_apellido,e.jsx("img",{src:((L=J.base64)==null?void 0:L.trim())||fe,alt:J.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2 ms-3",style:{width:"40px",height:"40px",objectFit:"cover"}})]}),e.jsxs("p",{className:"card-text m-1 my-4",children:[e.jsx("strong",{children:"Documento:"})," ",J.documento," ",e.jsx("br",{})]}),e.jsxs("div",{className:"d-grid gap-1 col-6 mx-auto",children:[e.jsxs("button",{className:"btn text-primary border border-3 border-primary bg-blueW rounded-pill position-absolute top-100 start-50 shadow-sm translate-middle my-1",onClick:()=>ie(J),children:["Editar ",e.jsx("i",{className:"px-1 bi bi-pen"})]}),"                          "]})]})})})},J.id)})})]})]})};function Ka(){var w,D,p;const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState(!1),[n,o]=a.useState(null),[x,h]=a.useState(""),[u,j]=a.useState(!1),[g,N]=a.useState(!1);a.useEffect(()=>{Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]')).forEach(S=>{new bootstrap.Tooltip(S)})},[]),a.useEffect(()=>{const y=ge(Y(A,"db_notificaciones"),$e("timestamp","desc")),S=Te(y,F=>{const _=F.docs.map(k=>({id:k.id,...k.data()}));r(_)},F=>{console.error("Error al obtener notificaciones:",F)});return()=>S()},[]),a.useEffect(()=>{(async()=>{const S=ge(Y(A,"db_personas"),$e("nombre_apellido","asc")),_=(await X(S)).docs.map(k=>({id:k.id,...k.data()}));c(_)})()},[]);const d=async y=>{const S=s.find(_=>_.id===y);if(S!=null&&S.asociada&&S.asociada.length>0){alert("No se puede eliminar la notificación porque tiene personas asociadas. Elimina las asociaciones primero.");return}if(window.confirm("¿Estás seguro de que deseas eliminar esta notificación?")){N(!0);try{await xe(W(A,"db_notificaciones",y)),r(_=>_.filter(k=>k.id!==y)),alert("Se eliminó la notificación")}catch(_){console.error("Error al eliminar la notificación:",_),alert("Hubo un error al eliminar la notificación.")}finally{N(!1)}}else alert("La notificación no fue eliminada.")},b=y=>{o(y),l(!0)},m=()=>{l(!1),o(null),h("")},f=async(y,S,F)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar la asociación de la persona ${F} con la notificación?`)){N(!0);try{const k=W(A,"db_notificaciones",y);await le(k,{asociada:Re(F)});const M=W(A,"db_personas",S);await le(M,{asociada_notificacion_id:Re(y)}),alert(`Se eliminó la asociación de la persona ${F} con la notificación.`)}catch(k){console.error("Error al eliminar la asociación:",k),alert("Hubo un error al eliminar la asociación.")}finally{N(!1)}}else alert(`La asociación de la persona ${F} no fue eliminada.`)},C=async()=>{if(n&&x)try{const y=ge(Y(A,"db_personas"),Se("nombre_apellido","==",x)),S=await X(y);if(S.empty)alert("No se encontró la persona seleccionada en la base de datos.");else{const F=S.docs[0];await Promise.all([le(W(A,"db_notificaciones",n),{asociada:Ie(x)}),le(W(A,"db_personas",F.id),{asociada_notificacion_id:Ie(n)})]),alert(`La persona ${x} se asoció a la notificación. Esto hará que al abrir la notificación se muestren sus datos / fotografía.`),m()}}catch(y){console.error("Error al asociar captura:",y)}else alert("Por favor, selecciona una persona para asociar.")},v=y=>{switch(y){case"1":return"Informativa";case"2":return"Búsqueda de Paradero";case"3":return"Evasión";case"4":return"Prioritaria";default:return"No definida"}};return e.jsxs("div",{className:"container-lg ",children:[e.jsx("div",{className:"row justify-content-center",children:e.jsxs("div",{className:"col-md-11",children:[e.jsxs("h3",{className:"text-center m-4 ",children:[e.jsxs("strong",{children:["Total de Notificaciones: ",s.length]}),e.jsxs("button",{className:"ms-5 btn text-pink  border-pink border border-2 fw-semibold  fs-6",onClick:()=>j(!u),children:[u?"Ocultar Notificaciones":"Administrar Notificaciones "," ",e.jsx("i",{className:"bi bi-bell ms-1"})]})]}),u&&e.jsx("ul",{className:"list-group list-group-flush ",children:s.map(y=>{var S;return e.jsx("li",{className:"list-group-item my-3 border border-secondary  rounded-4 shadow bg-greenW2 text-dark ",children:e.jsxs("div",{className:"d-flex flex-wrap justify-content-between align-items-start  text-dark ",children:[e.jsxs("p",{className:"text-dark ",children:[new Date(((S=y.timestamp)==null?void 0:S.seconds)*1e3).toLocaleString("es-ES",{dateStyle:"short",timeStyle:"short"})," hs  ",e.jsxs("span",{className:"fw-semibold ms-5  text-dark",children:["   ",y.contenido]})]}),e.jsxs("div",{className:"me-3 w-100 w-sm-50",children:[e.jsxs("p",{children:["Tipo de Notificación:"," ",e.jsx("span",{className:`badge ${y.caratula==="1"?"bg-greenW text-green":y.caratula==="2"?"bg-yellowW text-secondary":(y.caratula==="3","bg-redW text-secondaryMuiRed")}`,children:v(y.caratula)})]}),y.asociada&&y.asociada.length>0?e.jsxs("div",{className:"my-4 text-capitalize  ",children:[e.jsx("strong",{className:"",children:"Personas Asociadas a la Notificación:"}),e.jsx("ul",{className:"text-center my-3  ",children:y.asociada.map((F,_)=>{var M;const k=t.find($=>$.nombre_apellido===F);return k?e.jsxs("li",{className:"text-dark d-flex align-items-center my-3 ",children:[e.jsx("img",{src:((M=k.base64)==null?void 0:M.trim())||fe,alt:k.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2 ",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("span",{children:[_+1," - ",F]}),k.prioridad&&e.jsx("span",{className:` ms-3 badge ${k.prioridad==="1"?"d-none":k.prioridad==="2"?"bg-yellowW text-secondary ":k.prioridad==="3"?"bg-secondaryMuiRed":""}`,children:v(k.prioridad)}),k.asociada_notificacion_id&&Array.isArray(k.asociada_notificacion_id)&&e.jsxs("span",{className:"ms-3 badge text-purpleUi bg-purpleW border border-purpleUi border-1","data-bs-toggle":"tooltip","data-bs-placement":"top",title:`Esta persona está asociada a ${k.asociada_notificacion_id.length} notificación${k.asociada_notificacion_id.length>1?"es":""}`,children:["Afectado ",k.asociada_notificacion_id.length," notificación",k.asociada_notificacion_id.length>1?"es":""]}),e.jsx("span",{className:"ms-3 badge btn bg-redW text-secondaryMuiRed border-1 border border-pink ms-3 ",onClick:()=>f(y.id,k.id,F),disabled:g,children:"Eliminar Asociación"})]},_):null})})]}):e.jsx("div",{className:"text-muted mt-2",children:"No hay personas asociadas"})]}),e.jsxs("div",{className:"d-flex justify-content-end align-items-center w-100",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-pink me-2 bg-redW",onClick:()=>d(y.id),children:[e.jsx("i",{className:"bi bi-trash me-2 "})," Eliminar Notificacion"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-primary bg-blueW rounded-pill  ",onClick:()=>b(y.id),children:["Asociar Personas  ",e.jsx("i",{className:"bi bi-emoji-neutral ms-2 fw-semibold"})]})]})]})},y.id)})})]})}),e.jsx("div",{className:`modal bg-dark fade ${i?"show":""}`,style:{display:i?"block":"none"},tabIndex:"-1",role:"dialog","aria-labelledby":"modalLabel","aria-hidden":!i,children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Asociar Persona a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:m,"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsx("label",{htmlFor:"persona",className:"form-label mt-3 fw-semibold",children:"Seleccione una persona para asociar a la Notificación:"}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100 shadow",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",children:x||"Seleccionar una persona"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"300px",overflowY:"auto"},children:((w=s.find(y=>y.id===n))==null?void 0:w.caratula)==="1"&&t.filter(y=>y.prioridad==="1").length>0?t.filter(y=>y.prioridad==="1").map(y=>{var S;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center",onClick:()=>h(y.nombre_apellido),children:[e.jsx("img",{src:((S=y.base64)==null?void 0:S.trim())||fe,alt:y.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),y.nombre_apellido," - ",y.documento]})},y.id)}):((D=s.find(y=>y.id===n))==null?void 0:D.caratula)==="2"&&t.filter(y=>y.prioridad==="2").length>0?t.filter(y=>y.prioridad==="2").map(y=>{var S;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center ",onClick:()=>h(y.nombre_apellido),children:[e.jsx("img",{src:((S=y.base64)==null?void 0:S.trim())||fe,alt:y.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2 ",style:{width:"40px",height:"40px",objectFit:"cover"}}),y.nombre_apellido," - ",y.documento]})},y.id)}):((p=s.find(y=>y.id===n))==null?void 0:p.caratula)==="3"&&t.filter(y=>y.prioridad==="3").length>0?t.filter(y=>y.prioridad==="3").map(y=>{var S;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center ",onClick:()=>h(y.nombre_apellido),children:[e.jsx("img",{src:((S=y.base64)==null?void 0:S.trim())||fe,alt:y.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2 ",style:{width:"40px",height:"40px",objectFit:"cover"}}),y.nombre_apellido," - ",y.documento]})},y.id)}):e.jsx("li",{children:e.jsx("button",{className:"dropdown-item",disabled:!0,children:"No hay personas disponibles para esta prioridad"})})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:C,children:"Asociar Captura"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:m,children:"Cerrar"})]})]})})})]})}function et(){const[s,r]=a.useState(""),[t,c]=a.useState(""),[i,l]=a.useState("1"),[n,o]=a.useState(!1),x=()=>{const u=new Date,j=String(u.getDate()).padStart(2,"0"),g=String(u.getMonth()+1).padStart(2,"0"),N=u.getFullYear().toString().slice(-2);return`${j}/${g}/${N}`},h=async u=>{if(u.preventDefault(),s.trim()===""){c("El mensaje no puede estar vacío.");return}if(s.length>200){c("El mensaje no puede exceder los 200 caracteres.");return}if(i===""){c("Por favor, selecciona una carátula.");return}c(""),o(!0);try{await ye(Y(A,"db_notificaciones"),{contenido:s,timestamp:Pe(),leido:!1,fecha:x(),caratula:i}),r(""),l("1"),alert("Se agregó la nueva notificación con título.")}catch(j){console.error("Error al enviar notificación: ",j),c("Error al enviar la notificación. Inténtalo de nuevo.")}finally{o(!1)}};return e.jsxs("div",{className:"container-lg my-5 pb-4",children:[n&&e.jsx(ne,{}),"  ",e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"position-relative card shadow-sm pt-4 bg-transparent",children:[e.jsx("div",{className:"position-absolute top-0 start-50 bg-redW translate-middle rounded-pill border-pink border border-3  bg-white text-pink px-4 py-2 shadow",children:e.jsxs("h4",{className:"mb-0",children:["Notificación ",e.jsx("i",{className:"bi bi-bell ms-2  "})]})}),e.jsx("div",{className:"card-body pt-4 text-dark",children:e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"mb-3 text-center",children:[e.jsx("label",{htmlFor:"mensaje",className:"form-label fw-semibold my-2 ",children:"Mensaje de la notificación"}),e.jsx("input",{type:"text",id:"mensaje",className:"form-control shadow",value:s,onChange:u=>r(u.target.value),placeholder:"Escribe el mensaje aquí"})]}),e.jsxs("div",{className:"mb-3 text-center",children:[e.jsx("label",{htmlFor:"caratula",className:"form-label fw-semibold mt-3",children:"Selecciona una carátula de la Notificación ( Titulo / Contexto )"}),e.jsxs("select",{id:"caratula",className:"form-select shadow mb-4 text-center",value:i,onChange:u=>l(u.target.value),children:[e.jsx("option",{disabled:!0,value:"",children:"Seleccionar"}),e.jsx("option",{value:"1",children:"Clasica - Informativa"}),e.jsx("option",{value:"2",children:"Búsqueda de Paradero"}),e.jsx("option",{value:"3",children:"Evasión"})]})]}),t&&e.jsx("div",{className:"alert alert-danger mt-5",children:t}),e.jsx("div",{className:"d-grid",children:e.jsx("button",{type:"submit",className:"btn btn-outline-primary border-primary border-3 bg-blueW rounded-pill position-absolute top-100 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Crear Notificación ",e.jsx("i",{className:"bi bi-send-check-fill ms-2 text-primary"})]})})})]})})]})})})]})}const st=()=>{const[s,r]=a.useState(!0),[t,c]=a.useState(!1);return a.useEffect(()=>{(async()=>{await new Promise(l=>setTimeout(l,2e3)),r(!1)})()},[]),e.jsxs("div",{className:"container-lg  my-5",children:[e.jsxs("div",{className:"row justify-content-between align-items-center",children:[e.jsx("div",{className:"col-md-9 col-12 text-center ",children:e.jsx("h1",{children:"Crear / Administrar - Notificaciones"})}),e.jsx("div",{className:"col-md-3 col-12 text-center mb-3",children:e.jsxs("button",{className:"btn btn-outline-purpleUi border-purpleUi   fw-semibold border border-3 shadow-sm",onClick:()=>c(!t),children:[t?"Ocultar Notificaciones":"Mostrar Notificaciones",e.jsx("i",{className:"ms-3 bi bi-bell"})]})})]}),t&&e.jsx(e.Fragment,{children:s?e.jsx(ne,{}):e.jsxs("div",{className:"row mt-5",children:[e.jsx(et,{}),e.jsx(Ka,{})]})})]})},at=()=>{const[s,r]=a.useState([]),[t,c]=a.useState(!0),[i,l]=a.useState(null),[n,o]=a.useState(!1),[x,h]=a.useState(null),[u,j]=a.useState(""),[g,N]=a.useState(""),{currentUser:d}=Js(),b=d.email;a.useEffect(()=>{m()},[]);const m=async()=>{try{c(!0);const p=await X(Y(A,"db_personas")),y=[];p.forEach(F=>{const _={id:F.id,...F.data()};y.push(_)});const S=F=>{const[_,k,M]=F.split("/"),$=`20${M}`;return new Date(`${$}-${k}-${_}`)};y.sort((F,_)=>{const k=S(F.date),M=S(_.date);return isNaN(k)||isNaN(M)?(console.error("Fecha inválida para algún documento:",F,_),0):M-k}),r(y)}catch(p){console.error("Error obteniendo documentos: ",p),l("No se pudieron cargar los documentos.")}finally{c(!1)}},f=s.filter(p=>p.alerta===!0),C=p=>{h(p),o(!0)},v=async(p,y)=>{const S=!y;if(window.confirm(S?"¿Estás seguro de activar la captura?":"¿Estás seguro de desactivar la captura? Esto eliminará los datos asociados a la captura."))try{const F=W(A,"db_personas",p),_=S?{captura:!0}:{captura:!1,captura_evadido_autor:"",captura_evadido_date:"",captura_evadido_descripcion:"",captura_evadido_usuario:""};await le(F,_),r(k=>k.map(M=>M.id===p?{...M,..._}:M)),alert(S?"Captura activada correctamente.":"Captura desactivada y datos reseteados correctamente.")}catch(F){console.error("Error al cambiar estado de captura: ",F),l("No se pudo actualizar el estado de captura.")}},w=async p=>{try{const y=W(A,"db_personas",p);await le(y,{alerta:!1,prioridad:"1"}),r(S=>S.map(F=>F.id===p?{...F,alerta:!1,prioridad:"1"}:F)),alert("Alerta desactivada correctamente.")}catch(y){console.error("Error al desactivar alerta: ",y),l("No se pudo desactivar la alerta.")}},D=async()=>{if(!x)return;const y=new Date().toLocaleDateString("es-ES");try{const S=W(A,"db_personas",x);await le(S,{captura:!0,captura_evadido_autor:u,captura_evadido_date:y,captura_evadido_descripcion:g,captura_evadido_usuario:b}),r(F=>F.map(_=>_.id===x?{..._,captura:!0,captura_evadido_autor:u,captura_evadido_date:y,captura_evadido_descripcion:g,captura_evadido_usuario:b}:_)),o(!1),alert(d.email+" / Confirmó la Captura / SE INFORMÓ CORRECTAMENTE"),h(null),j(""),N("")}catch(S){console.error("Error al marcar captura: ",S),l("No se pudo marcar la captura.")}};return e.jsxs("div",{className:"container-lg  p-2",children:[t&&e.jsx(ne,{}),i&&e.jsx("div",{className:"alert alert-danger",children:i}),e.jsxs("div",{className:"table-responsive mt-1",children:[e.jsx("h2",{className:"text-center text-pink",children:"Administar de Evasiones"}),f.length>0?e.jsxs("table",{className:"table shadow-sm rounded text-center my-5 ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Imagen"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Entidad"}),e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{className:"table-group-divider  ",children:f.map(p=>{var y;return e.jsxs("tr",{className:"align-middle ",children:[e.jsx("td",{children:e.jsx("img",{src:((y=p.base64)==null?void 0:y.trim())||fe,alt:p.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle ",style:{width:"80px",height:"80px",objectFit:"cover"}})}),e.jsx("td",{children:p.nombre_apellido||"NN"}),e.jsx("td",{children:p.entidad}),e.jsx("td",{children:p.date}),e.jsxs("td",{children:[e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",role:"switch",id:`toggleCaptura-${p.id}`,checked:p.captura,onChange:()=>p.captura?v(p.id,p.captura):C(p.id)}),e.jsx("label",{className:"form-check-label",htmlFor:`toggleCaptura-${p.id}`,children:p.captura?"Captura Activa":"Captura Inactiva"})]})," ",e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",role:"switch",id:`toggleAlerta-${p.id}`,checked:p.alerta,onChange:()=>w(p.id),"aria-label":`Desactivar alerta de ${p.nombre_apellido||"NN"}`}),e.jsx("label",{className:"form-check-label",htmlFor:`toggleAlerta-${p.id}`,children:p.alerta?"Alerta Activa":"Alerta Inactiva"})]})]})]},p.id)})})]}):e.jsx("div",{className:"alert alert-info",children:"No hay documentos con alerta."})]}),e.jsx("div",{className:`modal fade ${n?"show bg-dark":""}`,style:{display:n?"block":"none"},tabIndex:"-1",role:"dialog","aria-labelledby":"marcarCapturaModalLabel","aria-hidden":!n,children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"marcarCapturaModalLabel",children:"Información de Captura"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>o(!1),"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body text-capitalize text-center",children:[e.jsx("label",{className:"fw-semibold",children:"Autor de la captura / Entidad :"}),e.jsx("input",{type:"text",value:u,onChange:p=>j(p.target.value),className:"form-control mb-2 shadow-sm"}),e.jsx("label",{className:"fw-semibold",children:"Breve reseña de la captura:"}),e.jsx("textarea",{value:g,onChange:p=>N(p.target.value),className:"form-control mb-2 shadow-sm"}),e.jsx("label",{className:"fw-semibold",children:"Usuario que informa la captura:"}),e.jsx("input",{type:"text",value:b,readOnly:!0,className:"form-control mb-2  text-center  border-0 text-pink fw-semibold"})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-pink",onClick:D,disabled:!u||!g,children:"Confirmar"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>o(!1),children:"Cancelar"})]})]})})})]})},tt=()=>{const[s,r]=a.useState(!0),[t,c]=a.useState(!1);return a.useEffect(()=>{(async()=>{await new Promise(l=>setTimeout(l,2e3)),r(!1)})()},[]),e.jsxs("div",{className:"container-lg  my-5",children:[e.jsxs("div",{className:"row justify-content-between align-items-center",children:[e.jsx("div",{className:"col-md-9 col-12 text-center ",children:e.jsx("h1",{children:"Administrar - Evasiones "})}),e.jsx("div",{className:"col-md-3 col-12 text-center mb-3",children:e.jsxs("button",{className:"btn btn-outline-primary fw-semibold border border-3 border-primary shadow-sm ",onClick:()=>c(!t),children:[t?"Ocultar Evasiones":"Mostrar Evasiones",e.jsx("i",{className:"ms-3 bi bi-card-checklist"})]})})]}),t&&e.jsx(e.Fragment,{children:s?e.jsx(ne,{}):e.jsx("div",{className:"row mt-5",children:e.jsx(at,{})})})]})},it=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Auditoria",element2:"Capturas Calientes",element3:"bi bi-ui-checks"}),e.jsx(Qa,{}),e.jsxs("div",{className:"container-lg",id:"bodyGallery",children:[e.jsx(Xa,{}),e.jsx(st,{}),e.jsx(tt,{})]}),e.jsx(je,{}),e.jsx(Ee,{})]});function rt(){const[s,r]=a.useState([]),[t,c]=a.useState("todas"),[i,l]=a.useState([]),[n,o]=a.useState(()=>{const w=localStorage.getItem("leidas");return w?JSON.parse(w):{}}),[x,h]=a.useState(!0),[u,j]=a.useState(!1),[g,N]=a.useState([]),d=s.sort((w,D)=>{var _,k;const p=n[w.id]?1:0,y=n[D.id]?1:0;if(p!==y)return p-y;const S=((_=w.timestamp)==null?void 0:_.seconds)*1e3||0;return(((k=D.timestamp)==null?void 0:k.seconds)*1e3||0)-S}).filter(w=>t==="leidas"?n[w.id]:t==="noLeidas"?!n[w.id]:!0);a.useEffect(()=>{const w=Y(A,"db_notificaciones"),D=Te(w,p=>{const S=p.docs.map(F=>({id:F.id,...F.data()})).sort((F,_)=>{var $,U;const k=(($=F.timestamp)==null?void 0:$.seconds)*1e3||0;return(((U=_.timestamp)==null?void 0:U.seconds)*1e3||0)-k});r(S)});return()=>D()},[]),a.useEffect(()=>{(async()=>{const p=(await X(Y(A,"db_personas"))).docs.map(y=>({id:y.id,...y.data()}));l(p),h(!1)})()},[]);const b=w=>{o(D=>{const p={...D,[w]:!0};return localStorage.setItem("leidas",JSON.stringify(p)),p})},m=w=>{const D=s.find(p=>p.id===w);if(D!=null&&D.asociada){const p=i.filter(y=>D.asociada.includes(y.nombre_apellido));N(p),j(!0)}},f=()=>{j(!1),N([])},C=w=>{switch(w){case"1":return"Novedad";case"2":return"Paradero";case"3":return"Evasión";case"4":return"Prioritaria";default:return"No definida"}},v=w=>/^https?:\/\//.test(w)?w:`https://${w}`;return e.jsx("div",{className:"container-lg my-5 ",children:x?e.jsx(ne,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h2",{className:"m-0",children:"📢 Notificacioness"}),e.jsxs("button",{type:"button",className:"btn btn-primary text-white position-relative",children:[e.jsx("i",{className:"bi bi-bell"}),e.jsxs("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",children:[e.jsx("span",{children:s.length}),e.jsx("span",{className:"visually-hidden",children:"unread messages"})]})]})]}),e.jsx("div",{className:"d-flex justify-content-center justify-content-md-end mt-4 px-2 ",children:e.jsxs("div",{className:"btn-group  rounded-pill overflow-hidden Gradiante25 shadow",role:"group",style:{backgroundColor:"#0d6efd"},children:[e.jsxs("button",{className:`btn ${t==="todas"?"btn-light text-indigoMui fw-semibold":"btn-outline-indigoMui text-white"}`,onClick:()=>c("todas"),children:[e.jsx("i",{className:"bi bi-list-ul me-2"}),"Todas"]}),e.jsxs("button",{className:`btn ${t==="leidas"?"btn-light text-indigoMui fw-semibold":"btn-outline-indigoMui text-white"}`,onClick:()=>c("leidas"),children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),"Leídas"]}),e.jsxs("button",{className:`btn ${t==="noLeidas"?"btn-light text-indigoMui fw-semibold":"btn-outline-indigoMui text-white"}`,onClick:()=>c("noLeidas"),children:[e.jsx("i",{className:"bi bi-bell-fill me-2"}),"No Leídas"]})]})}),d.length===0?e.jsxs("div",{className:"text-center text-muted my-5 alert alert-primary",children:[t==="leidas"&&e.jsxs("p",{children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),"No hay notificaciones leídas."]}),t==="noLeidas"&&e.jsxs("p",{children:[e.jsx("i",{className:"bi bi-bell-fill me-2"}),"No hay notificaciones sin leer."]}),t==="todas"&&e.jsxs("p",{children:[e.jsx("i",{className:"bi bi-inbox me-2"}),"No hay notificaciones disponibles."]})]}):d.map(w=>{var D,p;return e.jsxs("div",{className:"card shadow position-relative text-dark d-flex align-items-start gap-3 p-4 my-5 mx-3",style:{overflow:"visible"},children:[!n[w.id]&&e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2",onClick:()=>b(w.id),"aria-label":"Close"}),e.jsx("img",{src:n[w.id]?"img/Alertas/alertRead.png":"img/Alertas/alert1.gif",alt:"Alerta",className:"position-absolute rounded-circle",style:{width:n[w.id]?"60px":"80px",height:"80px",objectFit:"contain",top:"-20px",left:"-20px"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"40px"},children:[e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center mb-2 mt-2 w-100",children:[e.jsx("h5",{className:"mb-1 text-center text-sm-start w-100 w-sm-auto",children:e.jsx("strong",{className:"d-block d-sm-inline",children:w.titulo||"Nueva Notificación"})}),w.timestamp&&e.jsx("p",{className:"mb-0 text-muted small d-none d-sm-block",children:new Date(w.timestamp.seconds*1e3).toLocaleString()})]}),e.jsxs("p",{children:[n[w.id]&&e.jsx("i",{className:"badge text-bg-indigoMui text-white bi bi-check-circle-fill",children:" Esta Notificación fue Leída"})," ",w.caratula&&e.jsxs(e.Fragment,{children:[parseInt(w.caratula)===1&&e.jsx("span",{className:"badge text-bg-teal text-white shadow-sm",children:C(w.caratula)}),parseInt(w.caratula)===2&&e.jsx("span",{className:"badge text-bg-primaryMuiBlue text-white shadow-sm",children:C(w.caratula)}),parseInt(w.caratula)===3&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-danger"}),e.jsx("span",{className:"badge text-bg-danger text-white shadow-sm",children:C(w.caratula)})]}),parseInt(w.caratula)===4&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-orange"}),e.jsx("span",{className:"badge text-bg-orange text-white shadow-sm",children:C(w.caratula)})]})]})]}),w.contenido&&e.jsx("p",{className:"mb-3",children:w.contenido}),((D=w.enlace)==null?void 0:D.length)>0&&e.jsx("p",{className:"text-center",children:w.enlace.map((y,S)=>e.jsxs("a",{href:v(y),target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none d-flex align-items-center gap-2 rounded-pill",style:{maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:[e.jsx("i",{className:"bi bi-browser-chrome titilar",style:{fontSize:"20px"}}),y]},S))}),e.jsx("div",{className:"d-flex justify-content-center flex-wrap align-items-center gap-3 mt-3",children:(p=w.asociada)==null?void 0:p.map((y,S)=>{const F=i.find(_=>(_.nombre_apellido||"").toLowerCase()===(y||"").toLowerCase());return e.jsxs("div",{className:"d-flex align-items-center gap-2 border rounded shadow-sm p-2",style:{minWidth:"150px"},onClick:()=>m(w.id),children:[(F==null?void 0:F.base64)&&e.jsx("img",{src:F.base64,alt:F.nombre_apellido,className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("span",{className:"text-capitalize",children:[S+1,". ",y]})]},S)})})]})]},w.id)}),u&&g&&e.jsx("div",{className:"modal fade bg-dark show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Personas Asociadas"}),e.jsx("button",{type:"button",className:"btn-close",onClick:f})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"row",children:g.map((w,D)=>e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"card",children:[e.jsx("img",{src:w.base64||"default-image-url.jpg",alt:w.nombre_apellido,className:"card-img-top",style:{height:"200px",objectFit:"cover"}}),e.jsxs("div",{className:"card-body text-center text-capitalize",children:[e.jsx("h5",{className:"card-title text-pink",children:w.nombre_apellido}),e.jsxs("p",{children:[e.jsx("strong",{children:"Documento:"})," ",w.documento]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Datos:"})," ",w.descripcion_fisica]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Motivo Captura:"})," ",w.motivo_captura]})]})]})},D))})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn btn-pink",onClick:f,children:"Cerrar"})})]})})})]})})}const lt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Notificaciones",element2:"Cx2",element3:"bi bi-ui-checks"}),e.jsx("div",{className:"container-lg",id:"bodyGallery",children:e.jsx(rt,{})}),e.jsx(je,{}),e.jsx(Ee,{})]}),ps=()=>{const[s,r]=a.useState(null),[t,c]=a.useState([]),[i,l]=a.useState([]),n=x=>{const h=x.target.files[0];if(r(null),l([]),h){if(!h.name.endsWith(".csv")){r("Solo se permiten archivos CSV.");return}const u=new FileReader;u.onload=j=>{const g=j.target.result,N=g.includes(";")?";":",",b=g.split(`
`).map(C=>C.trim()).map(C=>C.split(N)),m=[],f=[];b.forEach((C,v)=>{if(C.some(S=>S.trim()===""))return;const D=C[0],p=C[1],y=C[2];isNaN(D)||D.length!==8?f.push({rowIndex:v+1,error:"El primer valor debe ser numérico y tener 8 caracteres."}):typeof p!="string"||p.trim()===""?f.push({rowIndex:v+1,error:"La segunda columna debe ser texto."}):o(y)?m.push(C):f.push({rowIndex:v+1,error:"La tercera columna debe tener formato de correo electrónico."})}),f.length>0&&l(f),m.length===0&&f.length===0&&r("No se encontraron filas válidas."),c(m)},u.onerror=()=>{r("Ocurrió un error al leer el archivo.")},u.readAsText(h)}},o=x=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(x);return e.jsx("div",{className:"container-lg mt-5 mt-sm-5 mt-md-0 mt-lg-0 ",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-orangeW text-dark shadow-sm ",children:e.jsxs("h4",{className:"fw-semibold p-2",children:["Subir Archivo CSV ",e.jsx("i",{className:"bi bi-filetype-csv ms-2"})]})}),e.jsxs("div",{className:"card-body ",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"csvFile",className:"form-label ",children:"Selecciona un archivo CSV para subir:"}),e.jsx("input",{type:"file",className:"form-control ",id:"csvFile",accept:".csv",onChange:n})]}),s&&e.jsx("div",{className:"alert alert-danger ",children:s}),i.length>0&&e.jsxs("div",{className:"alert alert-danger bg-redW shadow my-5",children:[e.jsxs("h6",{children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),"Errores en las siguientes filas:"]}),e.jsx("ul",{children:i.map((x,h)=>e.jsxs("li",{children:["Fila ",x.rowIndex,": ",x.error]},h))})]}),t.length>0&&e.jsxs("div",{className:"my-4",children:[e.jsxs("span",{className:" fw-semibold border border-2 rounded-pill p-2 px-5 border-teal bg-greenW2 text-dark",children:[" ",e.jsx("i",{className:"me-3 bi bi-person-lines-fill"}),"Contenido del archivo:"]}),e.jsx("div",{className:"table-responsive text-center bg-greenW2 mt-3",children:e.jsxs("table",{className:"table table-striped  ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("td",{children:"DNI"}),e.jsx("td",{children:"Nombre"}),e.jsx("td",{children:"Correo"}),e.jsx("td",{children:"Dependencia"})]})}),e.jsx("tbody",{children:t.map((x,h)=>e.jsx("tr",{children:x.map((u,j)=>e.jsx("td",{children:u},j))},h))})]})})]})]})]})})},nt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Usuarios Lista CSV",element2:"Capturas Calientes",element3:"bi bi-ui-checks"}),e.jsx("div",{className:"container-lg",id:"bodyGallery",children:e.jsx(ps,{})}),e.jsx(je,{}),e.jsx(Ee,{})]}),ot=({recepciones:s,loading:r})=>e.jsx("div",{className:" text-center mt-4",children:r?e.jsx("div",{className:"spinner-border text-primary",role:"status"}):Object.keys(s).length>0?e.jsxs("div",{className:"alert",children:[e.jsx("strong",{children:"Recepciones pendientes por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,c],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-primary",role:"status"}),e.jsx("span",{children:t}),e.jsxs("span",{className:"badge bg-primary",children:[c," pendientes"]})]},i))})]}):e.jsx("div",{className:"alert alert-primary",children:e.jsx("strong",{children:"No hay recepciones pendientes en este momento."})})}),ds={"comisaria 1":"1111","comisaria 2":"2222","comisaria 3":"3333","comisaria 4":"4444","comisaria 5":"5555","comisaria 6":"6666","comisaria 7":"7777","Comisaria 8":"8888"},ct=({notificaciones:s,loading:r,aceptarRecepcion:t,rechazarRecepcion:c})=>{const[i,l]=a.useState(""),[n,o]=a.useState(!1),[x,h]=a.useState(null),[u,j]=a.useState(""),[g,N]=a.useState(!1),d=async()=>{if(!x)return;N(!0);const{id:m,comisaria:f}=x,C=ds[f];setTimeout(()=>{u&&u===C?(t(m),l(""),o(!1),j("")):l(`El código ingresado "${u}" es incorrecto.`),N(!1)},1e3)},b=m=>{h(m),o(!0),l(""),j("")};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("p",{className:"text-center  text-center mb-4 bg-primary text-white rounded p-2 mt-4 mb-3",children:["       ",e.jsx("span",{className:"text-capitalize fs-3  ",children:" validación Recepción Art. 10 Bis "}),"  ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-4",children:e.jsx("div",{className:"position-relative",children:r?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border ",role:"status","aria-label":"Cargando...",children:" "})]}):e.jsxs("div",{className:"list-group",children:[i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i}),s&&s.length>0?s.map(m=>e.jsxs("div",{className:"list-group-item mb-3 shadow",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:m.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:m.dni})]}),e.jsxs("div",{className:"d-flex flex-wrap justify-content-end row",children:[e.jsx("div",{className:"col mb-1",children:e.jsxs("button",{className:"btn btn-primary btn-sm me-2 mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>b(m),"aria-label":`Aceptar recepción para ${m.nombre_apellido} en la Comisaría ${m.comisaria}`,children:["Aceptar ",e.jsx("i",{className:"bi bi-check-all ms-2"})]})}),e.jsx("div",{className:"col",children:e.jsxs("button",{className:"btn btn-pink btn-sm mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>c(m.id),"aria-label":`Cancelar recepción para ${m.nombre_apellido}`,children:["Cancelar ",e.jsx("i",{className:"bi bi-trash ms-2"})]})})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{children:e.jsxs("small",{children:[m.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:m.comisaria})," -"," ",m.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:m.unidad})]})})})]},m.id)):e.jsx("div",{className:"alert alert-info shadow",role:"alert",children:"No se encontraron notificaciones para validar."})]})})})]}),n&&x&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>o(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:x.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:u,onChange:m=>j(m.target.value),placeholder:"Código"}),i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:d,disabled:!u||g,children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>o(!1),children:"Cancelar"})]})]})})})]})},gs=()=>{const[s,r]=a.useState([]),[t,c]=a.useState(!1),[i,l]=a.useState(""),n=async()=>{try{c(!0);const j=ge(Y(A,"db_art_diez_bis"),Se("comisaria_recibe","==",!1)),N=(await X(j)).docs.map(d=>({id:d.id,...d.data()}));r(N)}catch(j){console.error("Error al obtener las recepciones pendientes: ",j)}finally{c(!1)}};a.useEffect(()=>{n()},[]);const o=async j=>{try{const g=JSON.parse(localStorage.getItem("user")),N=W(A,"db_art_diez_bis",j);await le(N,{comisaria_recibe:!0,visualidad:!0,fecha_ingreso_validado:Pe(),usuario_validado_ingreso:g.email}),r(d=>d.filter(b=>b.id!==j)),alert("Recepción aceptada correctamente.")}catch(g){console.error("Error al aceptar la recepción: ",g),alert("Hubo un error al aceptar la recepción.")}},x=async j=>{if(window.confirm("¿Estás seguro de que deseas rechazar esta recepción?"))try{const N=W(A,"db_art_diez_bis",j);await xe(N),r(d=>d.filter(b=>b.id!==j)),alert("Recepción rechazada correctamente.")}catch(N){console.error("Error al rechazar la recepción: ",N),alert("Hubo un error al rechazar la recepción.")}},h=s.reduce((j,g)=>{const N=g.comisaria||"Comisaría desconocida";return j[N]=(j[N]||0)+1,j},{}),u=i?s.filter(j=>j.comisaria===i):s;return e.jsx("div",{className:"container-lg mt-5",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 mb-4",children:[e.jsx(ot,{recepciones:h,loading:t}),e.jsxs("div",{className:"mt-4 card p-3 shadow-sm",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize fw-bold text-muted",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select",value:i,onChange:j=>l(j.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),Object.keys(h).map((j,g)=>e.jsx("option",{value:j,children:j},g))]})]})]}),e.jsx("div",{className:"col-12 col-md-8 mt-4 mt-md-0",children:e.jsx(ct,{notificaciones:u,loading:t,aceptarRecepcion:o,rechazarRecepcion:x})})]})})},dt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Validar Ingreso 10 Bis ",element2:"Cx2",element3:"bi bi-ui-checks"}),e.jsx(gs,{}),e.jsx("div",{className:"container-lg",id:"bodyGallery"}),e.jsx(je,{}),e.jsxs("div",{className:"pt-5",children:[" ",e.jsx(Ee,{})]})]});Xe.register(Ke,es,ss,Ws,as,ts,Hs,is,rs);const mt=(s,r)=>{const t=parseInt(s.replace("#",""),16),c=Math.max((t>>16)-r,0),i=Math.max((t>>8&255)-r,0),l=Math.max((t&255)-r,0);return`#${(c<<16|i<<8|l).toString(16).padStart(6,"0")}`},ut=({totalCapturas:s,totalPrioridadNormal:r,totalParadero:t,totalEvasiones:c,totalPrioritaria:i,totalEvasionesCapturados:l})=>{const[n,o]=a.useState("bar"),h=["#20c997","#ffca28","#f44336","#2196f3","#2196f3"].slice(0,4),u={labels:["C. Normal","C. Prioritarias","C. Evasion","B. Paradero"],datasets:[{label:"Estadísticas",data:[r,i,c,t],backgroundColor:h,borderColor:h.map(d=>mt(d,40)),borderWidth:1}]},j={datasets:[{label:"Capturas y Evasiones",data:[{x:1,y:s},{x:2,y:t},{x:3,y:c},{x:4,y:i},{x:5,y:l}],backgroundColor:"#2196f3"}]},g={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Informe Gráfico de Capturas y Evasiones"}},scales:{y:{beginAtZero:!0},x:{beginAtZero:!0}}},N=d=>{o(d.target.value)};return e.jsxs("div",{className:"container-lg mt-5 mt-sm-5 mt-md-0 mt-lg-0",children:[e.jsx("h2",{className:"text-center mb-4 bg-teal text-white",children:"Estadísticas / Gráficos"}),e.jsx("div",{className:"row justify-content-center mb-3",children:e.jsx("div",{className:"col-12 col-md-5",children:e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text bg-teal text-white",id:"inputGroup-sizing-sm",children:"Tipo de gráfico:"}),e.jsxs("select",{className:"form-select text-center border border-teal",onChange:N,value:n,children:[e.jsx("option",{value:"bar",children:"Barra"}),e.jsx("option",{value:"line",children:"Línea"}),e.jsx("option",{value:"pie",children:"Pastel"}),e.jsx("option",{value:"doughnut",children:"Doughnut"}),e.jsx("option",{value:"scatter",children:"Dispersión (Scatter)"})]})]})})}),e.jsx("div",{className:"row justify-content-center",children:e.jsxs("div",{className:"col-12 col-md-10",style:{height:"400px"},children:[n==="bar"&&e.jsx(ls,{data:u,options:g}),n==="line"&&e.jsx(Oe,{data:u,options:g}),n==="pie"&&e.jsx(ns,{data:u,options:g}),n==="doughnut"&&e.jsx(os,{data:u,options:g}),n==="scatter"&&e.jsx(Ys,{data:j,options:g})]})})]})},ht=({showModalLink:s,setShowModalLink:r,selectedNotifId:t,setNewLink:c,newLink:i,setNotificaciones:l})=>{const[n,o]=a.useState(!0),[x,h]=a.useState(""),u=()=>{r(!1),c(""),o(!0),h("")},j=async()=>{if(!i){o(!1),h("Por favor, ingresa un enlace.");return}if(!t){o(!1),h("Por favor, selecciona una notificación.");return}try{await le(W(A,"db_notificaciones",t),{enlace:Ie(i)}),c(""),o(!0),h(""),alert("Enlace agregado correctamente."),u()}catch(g){console.error("Error al agregar el enlace:",g),alert("Hubo un error al agregar el enlace.")}};return s&&e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Agregar Enlace a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:u,"aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"url",id:"link",className:`form-control ${n?"":"is-invalid"}`,placeholder:"https://example.com",value:i,onChange:g=>c(g.target.value)}),e.jsx("label",{htmlFor:"link",children:"Ingrese el enlace"}),!n&&e.jsx("div",{className:"invalid-feedback",children:x})," "]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:u,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:j,children:"Guardar Enlace"})]})]})})})},xt=({showModalNot:s,closeModalNot:r})=>{const t=we(),[c,i]=a.useState(""),[l,n]=a.useState(""),[o,x]=a.useState("1"),[h,u]=a.useState(""),[j,g]=a.useState(!1),N=()=>{const m=new Date,f=String(m.getDate()).padStart(2,"0"),C=String(m.getMonth()+1).padStart(2,"0"),v=m.getFullYear().toString().slice(-2);return`${f}/${C}/${v}`};a.useEffect(()=>{if(t.pathname==="/panelcontrol"){const m=()=>{r()};return window.history.pushState(null,document.title),window.addEventListener("popstate",m),()=>{window.removeEventListener("popstate",m)}}},[t,r]);const d=async m=>{if(m.preventDefault(),c.trim()===""){u("El mensaje no puede estar vacío.");return}if(c.length>280){u("El mensaje no puede exceder los 280 caracteres.");return}if(o===""){u("Por favor, selecciona una carátula.");return}u(""),g(!0);try{await ye(Y(A,"db_notificaciones"),{titulo:l,contenido:c,timestamp:Pe(),leido:!1,fecha:N(),caratula:o}),n(""),i(""),x("1"),r()}catch(f){console.error("Error al enviar notificación: ",f),u("Error al enviar la notificación. Inténtalo de nuevo.")}finally{g(!1)}},b=()=>{i(""),x("1"),u(""),r()};return e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{className:"modal-title text-center",id:"modalTitle",children:["Crear Notificación ",e.jsx("i",{className:"bi bi-app-indicator text-danger border border-blue rounded-circle p-2 border-5 ms-5 titilar "})]}),e.jsx("button",{type:"button",className:"btn-close",onClick:b})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("form",{onSubmit:d,children:[e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"titulo",value:l,onChange:m=>n(m.target.value)}),e.jsx("label",{className:"text-blue",children:"Titulo de la Notificación"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"mensaje",value:c,onChange:m=>i(m.target.value),style:{minHeight:"150px"}}),e.jsx("label",{className:"text-blue",children:"Mensaje"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsx("div",{className:"col-md",children:e.jsxs("div",{className:"form-floating shadow-sm",children:[e.jsxs("select",{className:"form-select text-center",id:"floatingSelectGrid",value:o,onChange:m=>x(m.target.value),children:[e.jsx("option",{value:"1",children:"Informativa "}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 👮🏻"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{className:"text-blue",children:"Selecciona Tipo de Notificación"})]})})}),h&&e.jsx("div",{className:"alert alert-danger mt-5",children:h}),j?e.jsx(ne,{}):e.jsx("div",{className:"d-grid",children:e.jsx("button",{type:"submit",className:"btn bg-primary border-white border-3 text-white rounded-pill position-absolute top-100 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Crear Notificación ",e.jsx("i",{className:"bi bi-send-check-fill ms-2 text-white"})]})})})]})})})]})})})},bt=({Date1:s,Date2:r,onCerrar:t,color:c})=>{const[i,l]=a.useState(!1),n=()=>{l(!0)};return e.jsxs("div",{className:`alert alert-${c} bg-blueW2 border-5 border-secondaryM my-4 position-relative d-flex align-items-start gap-3`,children:[e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:t}),e.jsx("img",{src:"img/ayuda.gif",alt:"Ayuda",style:{width:"80px",height:"70px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-secondaryM border border-2 d-none d-sm-table-cell"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Hola, soy el asistente de ayuda. Voy a guiarte en el proceso de creación de una notificación."}),e.jsxs("p",{children:["Para comenzar, presiona el botón ",e.jsx("strong",{className:"titilar",children:"'Crear Notificación'"}),". Luego, ingresa el título y el contenido del mensaje, y selecciona el tipo de notificación:"]}),e.jsxs("ul",{children:[e.jsx("p",{children:"Informativa (Normal)"}),e.jsx("p",{children:"Búsqueda de Paradero 🔎 "}),e.jsx("p",{children:"Prioritaria (Importante) ⭐ "}),e.jsx("p",{children:"Evadido (En caso de evasiones) 🚨"})]}),e.jsx("button",{type:"button",className:"btn btn-secondaryM text-white btn-sm mx-2",onClick:n,children:"Continuar"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:t,children:"Finalizar "}),i&&e.jsxs("div",{children:[e.jsxs("p",{className:"mt-3",children:[e.jsx("i",{className:"bi bi-person-fill-add rounded-circle bg-cyan text-white p-2 mx-2"}),'"Usa este ícono  para asociar personas a tu notificación. Esto permitirá que el usuario vea una tarjeta con la información de la persona asociada."']}),e.jsxs("p",{className:"mt-3",children:[e.jsx("i",{className:"bi bi-link rounded-circle bg-teal text-white p-2 mx-2"}),'"Usa este ícono  para agregar enlaces relacionados con la notificación. Esto permitirá que el usuario se dirija directamente al sitio web indicado."']}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:t,children:"Finalizar "})]})]})]})};function pt(){const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState(!1),[n,o]=a.useState(!1),[x,h]=a.useState(null),[u,j]=a.useState(null),[g,N]=a.useState(null),[d,b]=a.useState(""),[m,f]=a.useState(!1),[C,v]=a.useState(""),[w,D]=a.useState(""),[p,y]=a.useState(""),[S,F]=a.useState("desc"),[_,k]=a.useState(!1),[M,$]=a.useState(""),U=()=>k(!0),Q=()=>k(!1),[H,V]=a.useState(!1),ie=E=>{E!=null&&E.asociada_notificacion_id&&Array.isArray(E.asociada_notificacion_id)&&alert(`Esta persona está asociada a las siguientes notificaciones: ${E.asociada_notificacion_id.join(", ")}`)},oe=E=>{F(E.target.value),J(E.target.value)},J=(E,R)=>{let O=[...s];E==="asc"?O.sort((ee,K)=>{var ce,q;return((ce=ee.timestamp)==null?void 0:ce.seconds)-((q=K.timestamp)==null?void 0:q.seconds)}):O.sort((ee,K)=>{var ce,q;return((ce=K.timestamp)==null?void 0:ce.seconds)-((q=ee.timestamp)==null?void 0:q.seconds)}),r(O)};a.useEffect(()=>{f(!0);const E=ge(Y(A,"db_notificaciones"),$e("timestamp","desc")),R=Te(E,O=>{const ee=O.docs.map(K=>({id:K.id,...K.data()}));r(ee)},O=>{console.error("Error al obtener notificaciones:",O)});return f(!1),()=>R()},[]),a.useEffect(()=>{(async()=>{const R=ge(Y(A,"db_personas"),$e("nombre_apellido","asc")),ee=(await X(R)).docs.map(K=>({id:K.id,...K.data()}));c(ee)})()},[]);const Z=async(E,R)=>{try{if(!window.confirm("¿Desea eliminar este enlace?"))return;const ee=W(A,"db_notificaciones",R),K=await ze(ee);if(K.exists()){const ce=K.data();if(Array.isArray(ce.enlace)){const q=ce.enlace.filter((te,Ne)=>Ne!==E);await le(ee,{enlace:q}),alert("Enlace eliminado con exito ")}else alert("El campo 'enlace' no existe o no es un array.")}else alert("No se encontró el documento con el ID proporcionado.")}catch(O){alert.error("Error al eliminar el enlace:",O)}},L=async E=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta notificación?")){f(!0);try{await xe(W(A,"db_notificaciones",E)),r(O=>O.filter(ee=>ee.id!==E)),alert("Se eliminó la notificación")}catch(O){console.error("Error al eliminar la notificación:",O),alert("Hubo un error al eliminar la notificación.")}finally{f(!1)}}},G=E=>{h(E),l(!0)},se=()=>{l(!1),h(null),b("")},ae=E=>{h(E),o(!0)},re=async()=>{if(x&&d)try{const E=ge(Y(A,"db_personas"),Se("nombre_apellido","==",d)),R=await X(E);if(R.empty)alert("No se encontró la persona seleccionada.");else{const O=R.docs[0];await Promise.all([le(W(A,"db_notificaciones",x),{asociada:Ie(d)}),le(W(A,"db_personas",O.id),{asociada_notificacion_id:Ie(x)})]),alert(`La persona ${d} se asoció a la notificación.`),se()}}catch(E){console.error("Error al asociar captura:",E),alert("Hubo un error al asociar la captura.")}else alert("Por favor, selecciona una persona para asociar.")},ue=async(E,R,O)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar la asociación de la persona ${O} con la notificación?`)){f(!0);try{const K=W(A,"db_notificaciones",E);await le(K,{asociada:Re(O)});const ce=W(A,"db_personas",R);await le(ce,{asociada_notificacion_id:Re(E)}),alert(`Se eliminó la asociación de la persona ${O} con la notificación.`)}catch(K){console.error("Error al eliminar la asociación:",K),alert("Hubo un error al eliminar la asociación.")}finally{f(!1)}}else alert(`La asociación de la persona ${O} no fue eliminada.`)},I=E=>{switch(E){case"1":return"Informativa";case"2":return"Paradero 🔎";case"3":return"Evasión 👮🏻";case"4":return"Prioritaria ⭐";default:return"No definida"}},P=E=>{switch(E){case 1:return"Normal";case 2:return"Paradero 🔎";case 3:return"Evasión 👮🏻";case 4:return"Prioritaria ⭐";default:return"No definida"}},T=E=>/^https?:\/\//.test(E)?E:`https://${E}`,z=async E=>{if(w.trim()){f(!0);try{const R=W(A,"db_notificaciones",E);await le(R,{contenido:w}),alert("Contenido actualizado correctamente"),j(null)}catch(R){console.error("Error al actualizar contenido:",R),alert("Hubo un error al actualizar el contenido.")}finally{f(!1)}}else alert("El contenido no puede estar vacío")},B=async E=>{if(p.trim()){f(!0);try{const R=W(A,"db_notificaciones",E);await le(R,{titulo:p}),alert("titulo actualizado correctamente"),N(null)}catch(R){console.error("Error al actualizar titulo:",R),alert("Hubo un error al actualizar el titulo.")}finally{f(!1)}}else alert("El titulo no puede estar vacío")};return e.jsxs("div",{children:[e.jsxs("div",{className:"row g-3 justify-content-center align-items-center mt-1",children:[e.jsxs("div",{className:"container-lg",children:[H&&e.jsx(bt,{Date1:"Ninguno",Date2:"Desactivar Busqueda",onCerrar:()=>V(!1),color:"info"}),!H&&e.jsx("div",{className:"d-flex justify-content-end mb-1",children:e.jsxs("button",{className:"btn  fw-semibold",onClick:()=>V(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 titilar"})," ",e.jsx("small",{children:"Ayuda"})]})})]}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 text-center pb-4",children:e.jsx("button",{"aria-label":"Crear Notificación",onClick:U,className:"btn bg-primary border-white border-3 text-white rounded-pill shadow-sm  w-100",children:e.jsxs("span",{children:["Crear Notificación",e.jsx("i",{className:"bi bi-app-indicator rounded-circle border border-2 bg-white text-pink p-1 ms-2"})]})})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 text-center mb-4",children:e.jsxs("div",{className:"form-floating shadow-sm",children:[e.jsxs("select",{className:"form-select",id:"floatingSelectOrder",value:S,onChange:oe,children:[e.jsx("option",{value:"desc",children:"Más recientes primero"}),e.jsx("option",{value:"asc",children:"Más antiguos primero"})]}),e.jsx("label",{htmlFor:"floatingSelectOrder",children:"Ordenar"})]})})]}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10 ",children:e.jsx("div",{className:"list-group",children:s.map(E=>{var R;return e.jsxs("div",{className:"list-group-item mb-4 shadow mt-5",children:[e.jsxs("div",{className:"d-flex align-items-center bg-primary text-white p-3 rounded",children:[e.jsx("button",{className:"btn bg-primaryMuiBlue px-3 border-white border-3 text-white rounded-pill position-absolute top-0 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Notificación",e.jsx("i",{className:"bi bi-send-check-fill ms-1 text-white"})]})}),e.jsx("span",{className:`badge rounded-pill me-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[E.caratula]||"bg-warning text-dark"}`,children:I(E.caratula)}),e.jsx("div",{className:"flex-grow-1"}),e.jsx("small",{className:"text-end",children:new Date(((R=E.timestamp)==null?void 0:R.seconds)*1e3).toLocaleString()})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Título"}),E.id===g?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:p,onChange:O=>y(O.target.value),className:"form-control"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>B(E.id),disabled:m,children:m?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:E.titulo}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${E.id===g?"btn-danger":"btn-primary"}`,onClick:()=>{E.id===g?N(null):(y(E.titulo),N(E.id))},children:e.jsx("i",{className:`bi ${E.id===g?"bi-x-circle":"bi-pencil"}`})})}),e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Contenido"}),E.id===u?e.jsxs("div",{children:[e.jsx("textarea",{value:w,onChange:O=>D(O.target.value),className:"form-control",rows:"5"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>z(E.id),disabled:m,children:m?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:E.contenido}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${E.id===u?"btn-danger":"btn-primary"}`,onClick:()=>{E.id===u?j(null):(D(E.contenido),j(E.id))},children:e.jsx("i",{className:`bi ${E.id===u?"bi-x-circle":"bi-pencil"}`})})}),E.enlace&&E.enlace.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Enlaces Asociados"}),e.jsx("ul",{className:"list-unstyled",children:E.enlace.map((O,ee)=>e.jsxs("li",{className:"d-flex align-items-center justify-content-center gap-3 p-2 rounded-pill bg-light shadow-sm",children:[e.jsx("i",{className:"bi bi-browser-chrome text-primary girar",style:{fontSize:"20px"}}),e.jsx("a",{href:T(O),target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none text-primary text-center flex-grow-1",style:{maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:O}),e.jsx("button",{className:"btn btn-redUi1 btn-sm rounded-circle",onClick:()=>Z(ee,E.id),children:e.jsx("i",{className:"bi bi-trash text-white"})})]},ee))})]}):e.jsx("p",{className:"text-danger mt-3 text-center",children:"No posee enlaces asociados"}),E.asociada&&E.asociada.length>0?e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded",children:"Personas Asociadas"}),E.asociada.map((O,ee)=>{var ce,q;const K=t.find(te=>te.nombre_apellido===O);return K?e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light",children:[e.jsx("img",{src:((ce=K.base64)==null?void 0:ce.trim())||fe,alt:K.nombre_apellido||"Imagen no disponible",className:"rounded-circle me-3",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-center",children:[e.jsxs("span",{children:[ee+1,". ",O]}),((q=K.asociada_notificacion_id)==null?void 0:q.length)>0&&e.jsxs("span",{className:"badge bg-teal text-white ms-3",onClick:()=>ie(K),children:["Asociado ",K.asociada_notificacion_id.length]})]}),e.jsx("button",{className:"btn btn-sm btn-redUi1 text-white ms-3",onClick:()=>ue(E.id,K.id,O),children:e.jsx("i",{className:"bi bi-trash"})})]},ee):null})]}):e.jsx("span",{className:"text-danger text-center d-block",children:"No hay personas asociadas"})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 p-3",children:[e.jsx("button",{className:"btn btn-cyan text-white btn-sm rounded-circle ",onClick:()=>G(E.id),children:e.jsx("i",{className:"bi bi-person-fill-add"})}),e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle ",onClick:()=>ae(E.id),children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle ",onClick:()=>L(E.id),disabled:m,children:e.jsx("i",{className:"bi bi-trash3-fill"})})]})]},E.id)})})})}),e.jsx("div",{className:`modal fade bg-dark ${i?"show":""}`,style:{display:i?"block":"none"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!i,children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Asociar Persona a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:se,"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsx("label",{htmlFor:"persona",className:"form-label mt-3 fw-semibold",children:"Selecciona una persona:"}),e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por nombre o DNI",value:M,onChange:E=>$(E.target.value)}),e.jsx("button",{className:"btn btn-outline-secondary ms-2",onClick:()=>$(""),disabled:!M,children:"Limpiar"})]}),M&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-start fw-bold",children:"Resultados:"}),e.jsx("ul",{className:"list-group",style:{maxHeight:"150px",overflowY:"auto"},children:t.filter(E=>`${E.nombre_apellido} ${E.documento}`.toLowerCase().includes(M.toLowerCase())).map(E=>{var R;return e.jsxs("li",{className:"list-group-item d-flex align-items-center",onClick:()=>{b(E.nombre_apellido),$("")},style:{cursor:"pointer"},children:[e.jsx("img",{src:((R=E.base64)==null?void 0:R.trim())||fe,alt:E.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-0",children:[E.nombre_apellido," - ",E.documento]}),e.jsx("span",{className:`badge rounded-pill border border-white border-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[E.prioridad]||"bg-warning text-dark"}`,children:P(E.prioridad)})]})]},E.id)})})]}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",children:d||"Selecciona una persona"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"300px",overflowY:"auto"},children:t.filter(E=>`${E.nombre_apellido} ${E.documento}`.toLowerCase().includes(M.toLowerCase())).map(E=>{var R;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center",onClick:()=>b(E.nombre_apellido),children:[e.jsx("img",{src:((R=E.base64)==null?void 0:R.trim())||fe,alt:E.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),E.nombre_apellido," - ",E.documento," -",e.jsx("span",{className:`badge rounded-pill border border-white border-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[E.prioridad]||"bg-warning text-dark"}`,children:P(E.prioridad)})]})},E.id)})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:re,disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Asociando..."]}):"Asociar Captura"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:se,disabled:m,children:"Cerrar"})]})]})})}),e.jsx(ht,{showModalLink:n,setShowModalLink:o,selectedNotifId:x,setNewLink:v,newLink:C,setNotificaciones:r}),e.jsx(xt,{showModalNot:_,closeModalNot:Q})]})}const gt=({loading:s})=>e.jsxs("div",{className:"container text-center mt-5 mt-sm-5 mt-md-0 mt-lg-0",children:[e.jsx("h1",{className:"text-center  mb-3 animate__animated animate__bounce",children:"Administrador de Notificaciones"}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"position-relative",children:s?e.jsx(ne,{}):e.jsx("div",{className:"list-group",children:e.jsx(pt,{})})})})]}),Xs="/gif/dash.gif",jt=()=>e.jsxs("div",{children:[e.jsx("h5",{className:"text-secondary fs-1 text-center mb-5 text-purple mt-5 mt-sm-5 mt-md-0 mt-lg-0",children:"Bienvenido al Panel de Control"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column justify-content-center align-items-center",children:[e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-greenW text-purple"}),"Aquí podrás administrar los recursos del sistema de forma fácil y sencilla."]}),e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-lightbulb p-3 rounded-circle me-3 bg-greenW text-purple"}),"Recuerda que, ante cualquier problema, puedes solicitar asistencia técnica."]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-center align-items-center",children:e.jsx("img",{src:Xs,alt:"Descripción de la imagen",className:"img-fluid p-2 rounded-circle shadow",style:{maxWidth:"300px",height:"auto"}})})]})]}),ft=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),i=["alerta","captura","date","descripcion_fisica","documento","entidad","motivo_captura","nombre_apellido","numero_contacto","paradero","prioridad","sexo","usuario","asociada_notificacion_id"],l=async()=>{try{const j=(await X(Y(A,"db_personas"))).docs.map(g=>({id:g.id,...g.data()}));r(j)}catch(u){console.error("Error al obtener los datos:",u)}},n=u=>{c(j=>j.includes(u)?j.filter(g=>g!==u):[...j,u])},o=()=>{c(i)},x=()=>{c([])},h=()=>{if(s.length===0){console.error("No hay datos para descargar");return}if(t.length===0){console.error("Debe seleccionar al menos un campo");return}const u=s.map(N=>{const d={};return t.forEach(b=>{d[b]=N[b]}),d}),j=de.json_to_sheet(u),g=de.book_new();de.book_append_sheet(g,j,"Datos Seleccionados"),Le(g,"Datos_Seleccionados.xlsx")};return a.useEffect(()=>{l()},[]),e.jsxs("div",{className:"container-lg mt-5 mt-sm-5 mt-md-0 mt-lg-0",children:[e.jsxs("h2",{className:"text-center mb-4",children:["Exportar Datos de Capturas ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"text-center mb-5",children:"Selecciona los campos que deseas incluir en la exportación. "}),e.jsxs("div",{className:"d-flex justify-content-center mb-4",children:[e.jsx("button",{className:"btn btn-outline-green me-2",onClick:o,children:"Seleccionar Todos"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:x,children:"Limpiar Selección"})]}),e.jsx("form",{className:"mb-4",children:e.jsx("div",{className:"row border border-3 border-dark p-4 shadow rounded-4",children:i.map(u=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",style:{display:"flex",alignItems:"center"},children:e.jsxs("div",{className:"form-check w-100",children:[e.jsx("input",{type:"checkbox",className:"form-check-input bg-green",id:u,value:u,onChange:()=>n(u),checked:t.includes(u)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:u,children:u})]})},u))})}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn btn-green text-white fw-semibold",onClick:h,children:["Descargar Datos Seleccionados ",e.jsx("i",{className:"bi bi-filetype-xml"})]})})]})},Ks=({data1:s,data2:r})=>{var g;const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),[n,o]=a.useState(""),h=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),u=async N=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta persona?"))try{const d=W(A,"db_personas_desactivados",N.id),b=new Date,m=`${b.getDate().toString().padStart(2,"0")}/${(b.getMonth()+1).toString().padStart(2,"0")}/${b.getFullYear().toString().slice(-2)}`;await me(d,{...N,usuario_baja:h.email||"usuario_desconocido",usuario_baja_fecha:m});const f=W(A,"db_personas",N.id);await xe(f),r(),o("Persona eliminada y copiada a la colección de desactivados."),setTimeout(()=>o(""),3e3)}catch(d){console.error("Error al eliminar persona: ",d),o("Error al eliminar la persona. Inténtalo de nuevo."),setTimeout(()=>o(""),3e3)}},j=N=>{u(N),l()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-trash3-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Eliminar Persona"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:l})]}),"  ",e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(g=s.base64)==null?void 0:g.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-danger  bg-redW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas eliminar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:()=>{j(s)},children:"Confirmar Eliminación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Nt=({data1:s,data2:r})=>{const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),[n,o]=a.useState(),[x,h]=a.useState(s.descripcion_fisica),[u,j]=a.useState(s.documento),[g,N]=a.useState(s.entidad),[d,b]=a.useState(s.motivo_captura),[m,f]=a.useState(s.nombre_apellido),[C,v]=a.useState(s.prioridad),[w,D]=a.useState(s.sexo),[p,y]=a.useState(s.numero_contacto),[S,F]=a.useState(s.base64),[_,k]=a.useState("edicion desde menu de capturas"),[M,$]=a.useState(s.paradero),[U,Q]=a.useState(s.alerta),[H,V]=a.useState(!1),[ie,oe]=a.useState(!1),[J,Z]=a.useState(!1),L=()=>{const z={nombre_apellido:m,documento:u,sexo:w,descripcion_fisica:x,entidad:g,motivo_captura:d,numero_contacto:p,prioridad:C,alerta:U,paradero:M};return["nombre_apellido","documento","sexo","descripcion_fisica","entidad","motivo_captura","numero_contacto","prioridad","alerta","paradero"].filter(R=>z[R]!==s[R])},G=()=>{V(z=>!z)},se=()=>{oe(z=>!z)},ae=()=>{Z(z=>!z)},re=z=>{const B=z.target.files[0];if(B){const E=new FileReader;E.onloadend=()=>{F(E.result)},E.readAsDataURL(B)}else alert("Por favor, selecciona un archivo de imagen válido.")},ue=async()=>{const z=/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/;if(!m.trim()){alert("El campo Nombre y Apellido no puede estar vacío.");return}if(!z.test(m)){alert("El campo Nombre y Apellido solo debe contener letras.");return}const B=/^[0-9]+$/;if(!u.trim()){alert("El campo Documento no puede estar vacío.");return}if(!B.test(u)){alert("El campo Documento solo debe contener números.");return}if(u.length<8){alert("El Documento debe tener al menos 8 dígitos.");return}if(!_.trim()){alert("La descripción de las ediciones es obligatoria.");return}const E=W(A,"db_personas",s.id),R=L();try{o(!0);const O=new Date,ee=`${O.getDate().toString().padStart(2,"0")}/${(O.getMonth()+1).toString().padStart(2,"0")}/${O.getFullYear().toString().slice(-2)}`;await le(E,{descripcion_fisica:x,documento:u,entidad:g,motivo_captura:d,nombre_apellido:m,prioridad:C,sexo:w,numero_contacto:p,alerta:U,base64:S,paradero:M,ediciones:_.trim()?[...s.ediciones||[],{motivo:_,usuario:T.email,fecha:ee,campos:R}]:s.ediciones||[]}),r(),alert("Los cambios se han guardado correctamente.")}catch(O){console.error("Error al actualizar la persona: ",O),alert("Error al guardar los cambios. Inténtalo de nuevo.")}o(!1)},I=z=>{const B=parseInt(z.target.value,10);v(B),B===2&&($(!0),Q(!1)),B===1&&($(!1),Q(!1)),B===3&&(Q(!0),$(!1)),B===4&&($(!1),Q(!1))},T=(()=>{const z=localStorage.getItem("user");return z?JSON.parse(z):null})();return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-pen"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header ",children:[" ",e.jsx("img",{src:"img/asistente.gif",alt:"Asistente",style:{width:"60px",height:"60px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border "}),e.jsx("h5",{className:"modal-title mx-4",children:"Asistente de Edición "}),e.jsx("button",{type:"button",className:"btn-close ",onClick:l})]}),"  ",e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:`col-3 mt-3 d-flex align-items-center ${H?"titilar":""}`,children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:G,children:[e.jsx("img",{src:S||"https://via.placeholder.com/40",alt:(S==null?void 0:S.nombre_apellido)||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:H?"Editando":"Editar"})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:m,onChange:z=>f(z.target.value)}),e.jsx("label",{className:" badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"number",className:"form-control",value:u,onChange:z=>j(z.target.value)}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select text-center",value:w,onChange:z=>D(z.target.value),children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"masculino",children:"Masculino 👨"}),e.jsx("option",{value:"femenino",children:"Femenino 👩"}),e.jsx("option",{value:"otros",children:"Otros 👭🏻"})]}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Sexo"})]})})]})]}),e.jsxs("div",{className:"btn-group mt-3",role:"group","aria-label":"Basic example",children:[e.jsx("button",{type:"button",className:`btn btn-secondaryM text-white ${J?"titilar":""}`,onClick:ae,children:J?e.jsx(e.Fragment,{children:"Editando Datos de Captura "}):"Datos de Captura"}),e.jsx("button",{type:"button",className:`btn btn-primary text-white ${ie?"titilar":""}`,onClick:se,children:ie?e.jsx(e.Fragment,{children:"Editando Descripciones"}):"Descripciones"})]}),H&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Editar Fotografía ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:G})}),e.jsxs("div",{className:"my-3 text-center text-purple",children:[e.jsx("input",{type:"file",className:"form-control",onChange:re}),S&&e.jsx("img",{src:S,alt:"Imagen previa",className:"img-fluid mt-5",style:{maxWidth:"300px"}})]})]})]}),J&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Datos de la Captura ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-2 text-center",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:ae})}),e.jsx("span",{className:"badge text-bg-secondaryM text-white me-2 ",children:"Atención "}),e.jsxs("small",{children:["La prioridad ",e.jsx("strong",{children:"modifica el contexto"})," de la captura"]})]}),e.jsxs("div",{className:"form-floating ",children:[e.jsxs("select",{className:"form-select text-center shadow-sm border border-secondaryM mb-3  border-opacity-50 ",value:C,onChange:I,children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioridad ⭐"})]}),e.jsx("label",{className:"fw-semibold opacity-75 ms-2",children:"Prioridad"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Entidad que solicita captura"})}),e.jsx("input",{className:"form-control bg-blueW2",value:g,onChange:z=>N(z.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Numero de Contacto Entidad "})}),e.jsx("input",{className:"form-control bg-blueW2",value:p,onChange:z=>y(z.target.value)})]})]}),ie&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Descripciones ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:se})}),e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Descripción Fisica "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:x,onChange:z=>h(z.target.value),style:{minHeight:"160px"}})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Motivo Captura "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:d,onChange:z=>b(z.target.value),style:{minHeight:"150px"}})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:l,children:e.jsx("i",{className:"bi bi-x-circle"})}),e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle",onClick:ue,disabled:n,children:n?e.jsx("i",{className:"bi bi-floppy2 titilar"}):e.jsx("i",{className:"bi bi-floppy2"})})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},ms=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(""),[x,h]=a.useState(!1),u=()=>l(!0),j=()=>l(!1),g=()=>{c([])},d=(()=>{const m=localStorage.getItem("user");return m?JSON.parse(m):null})(),b=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas copiar estas personas a la colección de desactivados?"))){h(!0);try{const C=r.filter(v=>s.includes(v.id)).map(async v=>{const w=Y(A,"db_personas_desactivados"),D=new Date,p=`${D.getDate().toString().padStart(2,"0")}/${(D.getMonth()+1).toString().padStart(2,"0")}/${D.getFullYear().toString().slice(-2)}`;await ye(w,{...v,usuario_baja:(d==null?void 0:d.email)||"usuario_desconocido",usuario_baja_fecha:p});const y=W(A,"db_personas",v.id);await xe(y)});await Promise.all(C),o("Personas copiadas a la colección de desactivados y eliminadas de la colección original."),t(),g()}catch(f){console.error("Error al eliminar personas:",f),o("Hubo un error al copiar o eliminar algunas personas.")}setTimeout(()=>o(""),3e3),h(!1),j()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:u,disabled:x,children:e.jsx("i",{className:"bi bi-trash3-fill"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Eliminar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:j})]}),e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-redW p-2 rounded-pill text-secondaryMuiRed fw-bold",children:["Se eliminarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(m=>s.includes(m.id)).map(m=>{var f;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(f=m.base64)==null?void 0:f.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),m.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(C=>C.filter(v=>v!==m.id)),title:"Quitar de la selección"})]},m.id)})}),e.jsxs("p",{className:"text-danger text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas eliminar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:j,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:b,disabled:x,children:x?"Eliminando...":"Confirmar Eliminación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"}),n&&e.jsx("div",{className:"alert alert-success mt-2",children:n})]})},qe=({Date1:s,Date2:r,setSelectedDocs:t,onCerrar:c,color:i})=>e.jsxs("div",{className:`card bg-${i} shadow my-4 position-relative text-dark d-flex align-items-start gap-3 p-4`,style:{overflow:"visible"},children:[e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:c}),e.jsx("img",{src:"img/Perfiles/9.png",alt:"Asistente",className:" position-absolute",style:{width:"120px",height:"200px",objectFit:"contain",top:"-30px",left:"-20px"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:e.jsx("strong",{children:"Asistente de Selección"})}),e.jsxs("p",{className:"mb-3",children:["Personas Seleccionadas: ",e.jsxs("strong",{children:[s.length," 🧑"]})]}),e.jsx("strong",{children:s.length>0?e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-start p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(l=>s.includes(l.id)).map(l=>{var n;return e.jsxs("div",{className:"badge text-dark shadow d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.75rem"},children:[e.jsx("img",{src:(n=l.base64)==null?void 0:n.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),l.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>t(o=>o.filter(x=>x!==l.id)),title:"Quitar de la selección"})]},l.id)})}):e.jsx("span",{className:"text-danger",children:"Ninguna"})})]})]}),Ve=({searchTerm:s,setSearchTerm:r})=>e.jsxs("div",{className:"form-floating mb-3 position-relative",children:[e.jsx("input",{type:"text",className:"form-control shadow-sm pe-5",placeholder:"Buscar por nombre",value:s,onChange:t=>r(t.target.value)}),e.jsx("label",{children:"Buscar por Nombre"}),s&&e.jsx("button",{type:"button",className:"btn btn-link position-absolute top-50 end-0 translate-middle-y pe-3",onClick:()=>r(""),"aria-label":"Cancelar búsqueda",children:e.jsx("i",{className:"bi bi-x-circle"})})]}),ea=({prioridadFilter:s,setPrioridadFilter:r})=>e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:t=>r(t.target.value),children:[e.jsx("option",{value:"",children:"Todas las Prioridades"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{children:"Seleccione una Prioridad"})]}),Ge=({orden:s,setOrden:r})=>e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Ordenar alfabéticamente",value:s,onChange:t=>r(t.target.value),children:[e.jsx("option",{value:"asc",children:"Orden A-Z"}),e.jsx("option",{value:"desc",children:"Orden Z-A"})]}),e.jsxs("label",{children:["Ordenar ",e.jsx("i",{className:"bi bi-alphabet"})]})]}),vt=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0);a.useState("");const[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState(!0),[d,b]=a.useState("asc"),m=Y(A,"db_personas"),f=async()=>{o(!0);try{const y=(await X(m)).docs.map(S=>({...S.data(),id:S.id}));r(y),c(y)}catch(p){console.error("Error al obtener personas: ",p)}finally{o(!1)}},C=p=>p.sort((y,S)=>d==="asc"?y.nombre_apellido.localeCompare(S.nombre_apellido):S.nombre_apellido.localeCompare(y.nombre_apellido));a.useEffect(()=>{f()},[]),a.useEffect(()=>{const p=s.filter(S=>S.nombre_apellido&&S.nombre_apellido.toLowerCase().includes(x.toLowerCase())||S.documento&&S.documento.includes(x)).filter(S=>u?S.prioridad===parseInt(u,10):!0),y=C(p);c(y)},[x,s,u,d]),a.useMemo(()=>t.filter(p=>i.includes(p.id)),[i,t]);const v=p=>{l(y=>y.includes(p)?y.filter(S=>S!==p):[...y,p])},w=()=>{if(i.length===t.length)l([]);else{const p=t.map(y=>y.id);l(p)}},D=p=>{switch(Number(p)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg ",children:[e.jsxs("div",{className:"row",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5 ",children:"Listado de Capturas"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Ve,{searchTerm:x,setSearchTerm:h})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(ea,{prioridadFilter:u,setPrioridadFilter:j})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ge,{orden:d,setOrden:b})})]}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2  mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(ms,{data1:i,data2:s,dataRefresh:f,setSelectedDocs:l}),e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:()=>l([])})]}),g&&e.jsx(qe,{Date1:i,Date2:s,setSelectedDocs:l,onCerrar:()=>N(!1),color:"blueW2"}),!g&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>N(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2"})," ",e.jsxs("small",{children:["Ver Resumen ( ",e.jsxs("span",{className:"text-primary",children:[i.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:w})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(p=>{var y;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(p.id),onChange:()=>v(p.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((y=p.base64)==null?void 0:y.trim())||"https://via.placeholder.com/40",alt:p.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize",children:p.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:p.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:D(p.prioridad)}),e.jsxs("td",{children:[e.jsx(Nt,{data1:p,data2:f}),e.jsx(Ks,{data1:p,data2:f})]}),e.jsx("td",{})]},p.id)})})]})})]})})]})},sa=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(!1),x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas modificar estas personas a la colección?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await me(C,{...f,prioridad:1,paradero:!1,alerta:!1,ediciones:[...f.ediciones||[],{motivo:"cambio de prioridad",usuario:g.email,fecha:w}]})});await Promise.all(m),alert("Personas modificadas con exito."),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al modificar algunas personas.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-orange text-white btn-sm rounded-circle ",onClick:x,disabled:n,children:e.jsx("i",{className:"bi bi-star-fill"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Eliminar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-orange border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-orangeW p-2 rounded-pill text-orange fw-bold",children:["Se modificarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-orangeDb text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas modificar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-orangeDb text-white",onClick:N,disabled:n,children:n?"Cargando...":"Confirmar Modificación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},js=({prioridadFilter:s,setPrioridadFilter:r,personas:t})=>{const c=[...new Set(t.map(i=>i.entidad))];return e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:i=>r(i.target.value),children:[e.jsx("option",{value:"",children:"Todas las Entidades"}),c.map((i,l)=>e.jsx("option",{value:i,children:i},l))]}),e.jsx("label",{children:"Seleccione una Entidad"})]})},fs=(s,r,t)=>s.filter(c=>{var i,l;return((i=c.nombre_apellido)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))||((l=c.documento)==null?void 0:l.includes(r))}).filter(c=>!t||c.entidad===t),Ns=(s,r)=>s.sort((t,c)=>r==="asc"?t.nombre_apellido.localeCompare(c.nombre_apellido):c.nombre_apellido.localeCompare(t.nombre_apellido)),yt=(s,r)=>r?s.filter(t=>r==="capturado"?t.captura===!0:r==="evadido"?t.captura===!1:!0):s,vs=(s,r,t,c)=>{s(""),r(""),t("asc"),c&&c("")},wt=({data1:s,data2:r})=>{var g;const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),[n,o]=a.useState(!1),h=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),u=async N=>{if(window.confirm("¿Estás seguro de que deseas modificar esta persona?")){o(!0);try{const d=W(A,"db_personas",N.id),b=new Date,m=`${b.getDate().toString().padStart(2,"0")}/${(b.getMonth()+1).toString().padStart(2,"0")}/${b.getFullYear().toString().slice(-2)}`;await me(d,{...N,prioridad:1,paradero:!1,alerta:!1,ediciones:[...N.ediciones||[],{motivo:"cambio de prioridad",usuario:h.email,fecha:m}]}),r(),o(!1),alert("Modificación exitosa.")}catch(d){console.error("Error al eliminar persona: ",d),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},j=N=>{u(N),l()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-orange text-white btn-sm rounded-circle m-1",onClick:i,disabled:n,children:e.jsx("i",{className:"bi bi-star-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Modificar Prioridad Persona"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:l})]}),"  ",e.jsx("hr",{className:"border border-orange border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(g=s.base64)==null?void 0:g.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-orange  bg-orangeW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{className:"btn btn-orangeDb text-white",onClick:()=>{j(s)},children:"Confirmar Cambio"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},St=({data1:s,data2:r})=>{var d;const[t,c]=a.useState("busqueda paradero"),[i,l]=a.useState(!1),n=()=>l(!0),o=()=>l(!1),[x,h]=a.useState(!1),j=(()=>{const b=localStorage.getItem("user");return b?JSON.parse(b):null})(),g=async b=>{if(window.confirm("¿Estás seguro de que deseas modificar esta persona?")){h(!0);try{const m=W(A,"db_personas",b.id),f=new Date,C=`${f.getDate().toString().padStart(2,"0")}/${(f.getMonth()+1).toString().padStart(2,"0")}/${f.getFullYear().toString().slice(-2)}`;await me(m,{...b,prioridad:1,paradero:!1,alerta:!1,ediciones:[...b.ediciones||[],{motivo:"desactivar busqueda paradero",usuario:j.email,fecha:C}]}),r(),h(!1),alert("Modificación exitosa.")}catch(m){console.error("Error al eliminar persona: ",m),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},N=b=>{g(b),o()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primaryMuiBlue text-white btn-sm rounded-circle m-1",onClick:n,disabled:x,children:e.jsx("i",{className:"bi bi-search"})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsxs("h5",{className:"modal-title text-capitalize",children:["Modificar ",t]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:o})]}),"  ",e.jsx("hr",{className:"border border-primary border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(d=s.base64)==null?void 0:d.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-primary  bg-blueW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:o,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primaryMuiBlue text-white",onClick:()=>{N(s)},children:"Confirmar Cambio"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Ct=({data1:s,data2:r})=>{const[t,c]=a.useState(!1),i=()=>c(!1),[l,n]=a.useState(!1),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(""),d=(()=>{const v=localStorage.getItem("user");return v?JSON.parse(v):null})(),b=async()=>{if(window.confirm(`¿Estás seguro de que deseas ${j}?`)){n(!0);try{const v=W(A,"db_personas",s.id),w=new Date,D=`${w.getDate().toString().padStart(2,"0")}/${(w.getMonth()+1).toString().padStart(2,"0")}/${w.getFullYear().toString().slice(-2)}`;await me(v,{...s,captura:!0,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:d.email,captura_fecha:D,captura_autor:h,captura_descripcion:o}]}),r(),n(!1),alert(`${j} realizado.`)}catch(v){console.error("Error al modificar persona: ",v),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},m=async v=>{console.log(v),n(!0);try{const w=W(A,"db_personas",v),D=new Date,p=`${D.getDate().toString().padStart(2,"0")}/${(D.getMonth()+1).toString().padStart(2,"0")}/${D.getFullYear().toString().slice(-2)}`;await le(w,{...v,prioridad:1,capturas_informacion_estados:[...v.capturas_informacion_estados||[],{captura_motivo:"desactivar alerta",captura_informa_usuario:d.email,captura_fecha:p}]}),r(),n(!1),alert("Alerta desactivada correctamente.")}catch{alert("No se pudo desactivar la alerta.")}},f=()=>{c(!0),g("Informar Captura de Persona")},C=async()=>{if(window.confirm("¿Estás seguro de que deseas QUITAR EL ESTADO DE  CAPTURADO ?")){n(!0);try{const v=W(A,"db_personas",s.id),w=new Date,D=`${w.getDate().toString().padStart(2,"0")}/${(w.getMonth()+1).toString().padStart(2,"0")}/${w.getFullYear().toString().slice(-2)}`;await le(v,{...s,captura:!1,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"quitar estado de captura",captura_quita_estado_usuario:d.email,captura_quita_fecha:D}]}),r(),alert("Captura quitada correctamente."),n(!1)}catch(v){console.error("Error al quitar la captura:",v),alert("No se pudo quitar la captura. Inténtalo de nuevo."),n(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx("td",{className:s.captura?"bg-redW ":"",children:e.jsxs("div",{className:"d-flex flex-column gap-1",children:[s.captura?e.jsx("button",{className:"btn btn-pink text-white btn-sm w-100",onClick:()=>{C()},children:"Quitar Captura"}):e.jsx("button",{className:"btn btn-primary btn-sm w-100",onClick:f,disabled:l,children:"Marcar Capturado"}),s.alerta?e.jsx("button",{className:"btn btn-secondaryMuiRed text-white btn-sm w-100",onClick:()=>{window.confirm("¿Seguro que deseas desactivar la alerta?")&&m(s.id)},children:"Desactivar Alerta"}):e.jsx("button",{className:"btn btn-secondaryM btn-sm w-100",disabled:!0,children:"Alerta Inactiva"})]})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsxs("h5",{className:"modal-title mx-3",children:[j," "]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:i})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3 mt-3 d-flex align-items-center",children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},children:[e.jsx("img",{src:s.base64?s.base64.trim():"",alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:e.jsx("span",{children:"Capturado  👮 "})})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.nombre_apellido,disabled:!0}),e.jsx("label",{className:"badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border",value:s.documento,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.sexo,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Sexo"})]})})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM"}),j," ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:h,onChange:v=>u(v.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:o,onChange:v=>x(v.target.value)})]})]}),e.jsxs("p",{className:"text-primary bg-blueW rounded my-2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:i,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!h||!o||l,children:j})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},ys=({personas:s,selectedDocs:r,toggleSelectDoc:t,toggleSelectAll:c,getPrioridadLabel:i,fetchPersonas:l,isFiltered:n,color:o,prioridad:x})=>e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[!n&&e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:r.length===s.length,onChange:c})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Entidad"}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"DNI"}),x===3?e.jsx("th",{className:"d-none d-sm-table-cell",children:"Fecha"}):null,e.jsx("th",{className:"d-none d-sm-table-cell",children:"Prioridad"}),x===3?e.jsx("th",{}):null,e.jsx("th",{})]})}),e.jsx("tbody",{children:s.map(h=>{var u;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{className:h.captura?"bg-redW":"",children:e.jsx("input",{type:"checkbox",checked:r.includes(h.id),onChange:()=>t(h.id)})}),e.jsx("td",{className:h.captura?"bg-redW ":"",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((u=h.base64)==null?void 0:u.trim())||fe,alt:h.nombre_apellido,className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize d-inline-block text-truncate",children:h.nombre_apellido})]})}),e.jsx("td",{className:`d-none d-sm-table-cell text-dark ${h.captura?"bg-redW":o}`,children:h.entidad}),e.jsx("td",{className:h.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:h.documento}),x===3?e.jsx("th",{className:h.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:h.date}):null,e.jsx("td",{className:h.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:h.captura?e.jsx("span",{className:"badge bg-dark",children:"Capturado 👮"}):i(h.prioridad)}),x===3?e.jsx(Ct,{data1:h,data2:l}):null,e.jsxs("td",{className:h.captura?"bg-redW":"",children:[x===4?e.jsx(wt,{data1:h,data2:l}):null,x===2?e.jsx(St,{data1:h,data2:l}):null,e.jsx(Ks,{data1:h,data2:l})]})]},h.id)})})]})}),ws=s=>{switch(Number(s)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}},Ss=s=>{const[r,t]=a.useState([]),[c,i]=a.useState(!0),l=Y(A,"db_personas"),n=async()=>{i(!0);try{let x=(await X(l)).docs.map(h=>({...h.data(),id:h.id}));x=x.filter(h=>h.prioridad===s),t(x)}catch(o){console.error("Error al obtener personas: ",o)}finally{i(!1)}};return a.useEffect(()=>{n()},[]),{personas:r,loading:c,fetchPersonas:n}},Cs=s=>{const[r,t]=a.useState([]);return{selectedDocs:r,setSelectedDocs:t,toggleSelectDoc:l=>{t(n=>n.includes(l)?n.filter(o=>o!==l):[...n,l])},toggleSelectAll:()=>{if(s&&s.length>0)if(r.length===s.length)t([]);else{const l=s.map(n=>n.id);t(l)}}}},_t=()=>{const[s,r]=a.useState(4),{personas:t,loading:c,fetchPersonas:i}=Ss(s),[l,n]=a.useState([]),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(!0),[N,d]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:m,toggleSelectDoc:f,toggleSelectAll:C}=Cs(l||[]),v=o||h;return a.useEffect(()=>{const w=fs(t,o,h),D=Ns(w,N);n(D)},[o,t,h,N]),e.jsxs("div",{className:"container-lg",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  ",children:"Listado de Capturas Prioritarias"}),e.jsxs("div",{className:"card my-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Ve,{searchTerm:o,setSearchTerm:x})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(js,{prioridadFilter:h,setPrioridadFilter:u,personas:t})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ge,{orden:N,setOrden:d})})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>vs(x,u,d),className:"btn btn-primary btn-sm",children:"Limpiar Filtros"})})]})]}),c?e.jsx(ne,{}):e.jsx(e.Fragment,{children:l.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(sa,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx(ms,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:()=>m([])})]}),j&&e.jsx(qe,{Date1:b,Date2:t,setSelectedDocs:m,onCerrar:()=>g(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>g(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2"})," ",e.jsxs("small",{children:["Ver Resumen ( ",e.jsxs("span",{className:"text-primary",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(ys,{personas:l,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:C,getPrioridadLabel:ws,fetchPersonas:i,isFiltered:v,color:"bg-yellowW",prioridad:s})]})})]})},kt=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(!1),x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas recuperar estas personas?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await me(C,{...f,recuperado:[...f.recuperado||[],{motivo:"recuperado manual",usuario:g.email,fecha:w,datos_resguardo_baja_previa:[{usuario_baja:f.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:f.usuario_baja_fecha||"fecha_no_disponible"}]}]});const D=W(A,"db_personas_desactivados",f.id);await xe(D)});await Promise.all(m),alert("Personas recuperadas y eliminadas de la colección de desactivados."),t(),u()}catch(b){console.error("Error al recuperar personas:",b),alert("Hubo un error al recuperar o eliminar algunas personas.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:x,disabled:n,children:e.jsx("i",{className:"bi bi-recycle"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Recuperar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-teal border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-greenW p-2 rounded-pill text-primary fw-bold",children:["Se reactivan ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas reactivar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:N,disabled:n,children:n?"Recuperando...":"Confirmar Recuperación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Et=({data1:s,data2:r})=>{var u;const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),o=(()=>{const j=localStorage.getItem("user");return j?JSON.parse(j):null})(),x=async j=>{if(window.confirm("¿Estás seguro de que deseas recuperar esta persona?"))try{const g=W(A,"db_personas",j.id),N=new Date,d=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`,b="campos_modificados_aqui";await me(g,{...j,recuperado:[...j.recuperado||[],{motivo:"recuperado manual",usuario:o.email,fecha:d,datos_resguardo_baja_previa:[{usuario_baja:j.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:j.usuario_baja_fecha||"fecha_no_disponible"}]}]});const m=W(A,"db_personas_desactivados",j.id);await xe(m),r(),alert("Persona recuperada y copiada a la colección de capturas.")}catch(g){console.error("Error al eliminar persona: ",g)}},h=j=>{x(j),l()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-recycle"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Recuperar Persona"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("hr",{className:"border border-teal  border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(u=s.base64)==null?void 0:u.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-primary bg-greenW2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas recuperar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:()=>h(s),children:"Confirmar Recuperación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Dt=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState(!0),[d,b]=a.useState("asc"),m=Y(A,"db_personas_desactivados"),f=async()=>{o(!0);try{const y=(await X(m)).docs.map(S=>({...S.data(),id:S.id}));r(y),c(y)}catch(p){console.error("Error al obtener personas: ",p)}finally{o(!1)}},C=p=>p.sort((y,S)=>d==="asc"?y.nombre_apellido.localeCompare(S.nombre_apellido):S.nombre_apellido.localeCompare(y.nombre_apellido));a.useEffect(()=>{f()},[]),a.useEffect(()=>{const p=s.filter(S=>S.nombre_apellido&&S.nombre_apellido.toLowerCase().includes(x.toLowerCase())||S.documento&&S.documento.includes(x)).filter(S=>u?S.prioridad===parseInt(u,10):!0),y=C(p);c(y)},[x,s,u,d]);const v=p=>{l(y=>y.includes(p)?y.filter(S=>S!==p):[...y,p])},w=()=>{if(i.length===t.length)l([]);else{const p=t.map(y=>y.id);l(p)}},D=p=>{switch(Number(p)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg ",children:[e.jsxs("div",{className:"row",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5 ",children:"Listado de Capturas  Desactivadas"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Ve,{searchTerm:x,setSearchTerm:h})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(ea,{prioridadFilter:u,setPrioridadFilter:j})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ge,{orden:d,setOrden:b})})]}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2  mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(kt,{data1:i,data2:s,dataRefresh:f,setSelectedDocs:l}),e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:()=>l([])})]}),g&&e.jsx(qe,{Date1:i,Date2:s,setSelectedDocs:l,onCerrar:()=>N(!1),color:"blueW2"}),!g&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>N(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2"})," ",e.jsxs("small",{children:["Ver Resumen ( ",e.jsxs("span",{className:"text-primary",children:[i.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:w})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(p=>{var y;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(p.id),onChange:()=>v(p.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((y=p.base64)==null?void 0:y.trim())||"https://via.placeholder.com/40",alt:p.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize",children:p.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:p.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:D(p.prioridad)}),e.jsx("td",{children:e.jsx(Et,{data1:p,data2:f})}),e.jsx("td",{})]},p.id)})})]})})]})})]})},Ft=({alertaFilter:s,setAlertaFilter:r})=>e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:t=>r(t.target.value),children:[e.jsx("option",{value:"",children:"Todos los Estados"}),e.jsx("option",{value:"capturado",children:"Capturado"}),e.jsx("option",{value:"evadido",children:"Evadido"})]}),e.jsx("label",{children:"Seleccione un Estado"})]}),Pt=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1);a.useState("");const[n,o]=a.useState(!1),[x,h]=a.useState(""),[u,j]=a.useState(""),g=()=>l(!0),N=()=>l(!1),d=()=>{c([])},m=(()=>{const C=localStorage.getItem("user");return C?JSON.parse(C):null})(),f=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas dar por CAPTURADOS 👮 a este grupo personas ?"))){o(!0);try{const w=r.filter(D=>s.includes(D.id)).map(async D=>{const p=W(A,"db_personas",D.id),y=new Date,S=`${y.getDate().toString().padStart(2,"0")}/${(y.getMonth()+1).toString().padStart(2,"0")}/${y.getFullYear().toString().slice(-2)}`;await le(p,{...D,captura:!0,capturas_informacion_estados:[...D.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:m.email,captura_fecha:S,captura_autor:u,captura_descripcion:x}]})});await Promise.all(w),alert("Capturas Exitosas"),t(),d()}catch(v){console.error("Error al modificar personas:",v),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}o(!1),N()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-primary btn-sm w-100",onClick:g,disabled:n,children:["Marcar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3",children:"Marcar Grupo como Capturado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:N})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(C=>s.includes(C.id)).map(C=>{var v;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(v=C.base64)==null?void 0:v.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),C.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(w=>w.filter(D=>D!==C.id)),title:"Quitar de la selección"})]},C.id)})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:u,onChange:C=>j(C.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:x,onChange:C=>h(C.target.value)})]}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas marcar como capturados estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:N,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:f,disabled:!u||!x||n,children:n?"Trabajando...":"Confirmar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},At=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1);a.useState("");const[n,o]=a.useState(!1);a.useState(""),a.useState("");const x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas QUITAR LOS ESTADOS DE CAPTURA 👮 a estas personas ?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await le(C,{...f,captura:!1,capturas_informacion_estados:[...f.capturas_informacion_estados||[],{captura_motivo:"quitar captura",captura_informa_usuario:g.email,captura_fecha:w}]})});await Promise.all(m),alert("Se quito las capturas de forma Exitosa"),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-pink btn-sm w-100",onClick:x,disabled:n,children:["Quitar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3",children:"Quitar Estado de Capturados a Grupo "}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de  ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas quitar estado de captura ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:N,disabled:n,children:n?"Trabajando...":"Quitar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Mt=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1);a.useState("");const[n,o]=a.useState(!1);a.useState(""),a.useState("");const x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas DESACTIVAR SU ESTADO DE ALERTA EVADIDO 🚨 a este grupo de  personas ?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await le(C,{...f,prioridad:1,capturas_informacion_estados:[...f.capturas_informacion_estados||[],{captura_motivo:"desactivar alerta",captura_informa_usuario:g.email,captura_fecha:w}]})});await Promise.all(m),alert("Alrta Modificada Exitosas"),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-secondaryMuiRed btn-sm w-100 text-white",onClick:x,disabled:n,children:["Desactivar Alerta (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border titilar",children:"🚨"}),e.jsx("h5",{className:"modal-title ms-3",children:"Desactivar Alerta Evadido"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center  titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas desactivar el estado evadido ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:N,disabled:n,children:n?"Trabajando...":"Desactivar Evadido"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},It=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(!1),x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas modificar estas personas ?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await me(C,{...f,prioridad:1,paradero:!1,alerta:!1,ediciones:[...f.ediciones||[],{motivo:"desactivar busqueda paradero grupal",usuario:g.email,fecha:w}]})});await Promise.all(m),alert("Personas modificadas con exito."),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al modificar algunas personas.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-primaryMuiBlue text-white btn-sm rounded-circle ",onClick:x,disabled:n,children:e.jsx("i",{className:"bi bi-search"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Modificar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-primary border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-blueW p-2 rounded-pill text-primary fw-bold",children:["Se modificarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas modificar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primaryMuiBlue text-white",onClick:N,disabled:n,children:n?"Cargando...":"Confirmar Modificación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Lt=()=>{const[s,r]=a.useState(2),{personas:t,loading:c,fetchPersonas:i}=Ss(s),[l,n]=a.useState([]),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(!0),[N,d]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:m,toggleSelectDoc:f,toggleSelectAll:C}=Cs(l||[]),v=o||h;return a.useEffect(()=>{const w=fs(t,o,h),D=Ns(w,N);n(D)},[o,t,h,N]),e.jsxs("div",{className:"container-lg",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  ",children:"Listado Busqueda de Paradero"}),e.jsxs("div",{className:"card my-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Ve,{searchTerm:o,setSearchTerm:x})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(js,{prioridadFilter:h,setPrioridadFilter:u,personas:t})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ge,{orden:N,setOrden:d})})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>vs(x,u,d),className:"btn btn-primary btn-sm",children:"Limpiar Filtros"})})]})]}),c?e.jsx(ne,{}):e.jsx(e.Fragment,{children:l.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[s===4?e.jsx(sa,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}):null,s===2?e.jsx(It,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}):null,e.jsx(ms,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:()=>m([])})]}),j&&e.jsx(qe,{Date1:b,Date2:t,setSelectedDocs:m,onCerrar:()=>g(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>g(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2"})," ",e.jsxs("small",{children:["Ver Resumen ( ",e.jsxs("span",{className:"text-primary",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(ys,{personas:l,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:C,getPrioridadLabel:ws,fetchPersonas:i,isFiltered:v,color:"bg-blueW",prioridad:s})]})})]})},$t=()=>{const[s,r]=a.useState(3),{personas:t,loading:c,fetchPersonas:i}=Ss(s),[l,n]=a.useState([]),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(!0),[N,d]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:m,toggleSelectDoc:f,toggleSelectAll:C}=Cs(l||[]),v=o||h,[w,D]=a.useState(""),p=b.every(F=>{const _=t.find(k=>k.id===F);return(_==null?void 0:_.captura)===!0}),y=b.every(F=>{const _=t.find(k=>k.id===F);return(_==null?void 0:_.captura)===!1||(_==null?void 0:_.captura)===void 0}),S=!p&&!y;return a.useEffect(()=>{let F=fs(t,o,h);F=yt(F,w);const _=Ns(F,N);n(_)},[o,t,h,N,w]),e.jsxs("div",{className:"container-lg",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  ",children:"Listado de Evasiones"}),e.jsxs("div",{className:"card my-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-sm-4 col-md-6 col-lg-4",children:e.jsx(Ve,{searchTerm:o,setSearchTerm:x})}),e.jsx("div",{className:"col-12 col-sm-3 col-md-6 col-lg-3",children:e.jsx(js,{prioridadFilter:h,setPrioridadFilter:u,personas:t})}),e.jsx("div",{className:"col-12 col-sm-3 col-md-6 col-lg-3",children:e.jsx(Ft,{alertaFilter:w,setAlertaFilter:D})}),e.jsx("div",{className:"col-12 col-sm-2 col-md-6 col-lg-2",children:e.jsx(Ge,{orden:N,setOrden:d})})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>vs(x,u,d,D),className:"btn btn-primary btn-sm",children:"Limpiar Filtros"})})]})]}),c?e.jsx(ne,{}):e.jsx(e.Fragment,{children:l.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx("div",{className:"d-flex gap-2 mb-2 justify-content-end mb-2",children:!S&&e.jsxs(e.Fragment,{children:[p&&e.jsx(At,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),y&&e.jsx(Pt,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m})]})}),e.jsx(Mt,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx(ms,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:()=>m([])})]}),j&&e.jsx(qe,{Date1:b,Date2:t,setSelectedDocs:m,onCerrar:()=>g(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>g(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2"})," ",e.jsxs("small",{children:["Ver Resumen ( ",e.jsxs("span",{className:"text-primary",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(ys,{personas:l,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:C,getPrioridadLabel:ws,fetchPersonas:i,isFiltered:v,color:"bg-redW",prioridad:s})]})})]})},Rt=()=>{const[s,r]=a.useState("dashboard"),[t,c]=a.useState([]),[i,l]=a.useState(!1),n=localStorage.getItem("user");n&&JSON.parse(n);const o=async()=>{try{l(!0);const b=await X(Y(A,"db_personas")),m=[];b.forEach(f=>{m.push({id:f.id,...f.data()})}),c(m)}catch(b){console.error("Error al obtener los documentos: ",b)}finally{l(!1)}};a.useEffect(()=>{o()},[]);const x=t.filter(b=>b.prioridad===3).length,h=t.filter(b=>b.prioridad===1).length,u=t.filter(b=>b.prioridad===2).length,j=t.filter(b=>b.prioridad===4).length,g=t.filter(b=>b.captura===!0).length,N=t.length,d=()=>{switch(s){case"dashboard":return e.jsx(jt,{});case"reportes":return e.jsx(ft,{});case"Desactivados":return e.jsx(Dt,{});case"capturas":return e.jsx(vt,{});case"evasiones":return e.jsx($t,{});case"csv":return e.jsx(ps,{});case"paradero":return e.jsx(Lt,{});case"prioritaria":return e.jsx(_t,{});case"notificaciones":return e.jsx(gt,{loading:i});case"graficos":return e.jsx(ut,{totalCapturas:N,totalPrioridadNormal:h,totalParadero:u,totalEvasiones:x,totalPrioritaria:j,totalEvasionesCapturados:g});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsxs("div",{className:"container-lg mt-5 mb-sm-5 mb-md-5",children:[e.jsx("div",{className:"titulo-espaciado text-start mb-4",children:e.jsx("h3",{className:"text-secondary fw-semibold",children:"Panel de Control"})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"list-group shadow",children:[e.jsx("button",{className:`list-group-item list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>r("dashboard"),children:"Bienvenido"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="reportes"?"active":""}`,onClick:()=>r("reportes"),children:"Exportación"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="graficos"?"active":""}`,onClick:()=>r("graficos"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Graficos",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-teal rounded-pill",children:"Nuevo"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="notificaciones"?"active":""}`,onClick:()=>r("notificaciones"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Notificaciones",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-primaryMuiBlue rounded-pill",children:"Administrar"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="capturas"?"active":""}`,onClick:()=>r("capturas"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Capturas",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",N]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="evasiones"?"active":""}`,onClick:()=>r("evasiones"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Evasiones",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",x]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="paradero"?"active":""}`,onClick:()=>r("paradero"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Busqueda Paradero",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",u]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="prioritaria"?"active":""}`,onClick:()=>r("prioritaria"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Prioritarias",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",j]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="csv"?"active":""}`,onClick:()=>r("csv"),children:"Usuarios Csv"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="Desactivados"?"active":""}`,onClick:()=>r("Desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Desactivados",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-cyan rounded-pill",children:"Reactivar"})]})})]})}),e.jsx("div",{className:"col-md-9",children:d()})]})]})},zt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Panel de Control ",element2:"Cx2",element3:"bi bi-ui-checks"}),e.jsx("div",{className:"container-lg",id:"bodyGallery",children:e.jsx(Rt,{})}),e.jsx(je,{}),e.jsx(Ee,{})]}),Tt=({show:s,handleClose:r,elementos:t,setElementos:c})=>{if(!s)return null;const[i,l]=a.useState({nombre:"",descripcion:"",categoria:"general",cantidad:1}),n=()=>{if(!i.nombre.trim()){alert("Por favor, completa todos los campos obligatorios.");return}const o={nombre:i.nombre||"Sin nombre",descripcion:i.descripcion||"Sin descripción",categoria:i.categoria||"general",cantidad:i.cantidad||1};c([...t,o]),console.log("Nuevo elemento agregado:",o),l({nombre:"",descripcion:"",categoria:"general",cantidad:1}),r()};return e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Agregar Elemento"}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:r})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"nombre",className:"form-label",children:"Nombre del Elemento:"}),e.jsx("input",{id:"nombre",type:"text",className:"form-control",value:i.nombre,onChange:o=>l({...i,nombre:o.target.value})})]}),e.jsxs("div",{className:"col-4 ",children:[e.jsx("label",{htmlFor:"categoria ",className:"form-label",children:"Categoría:"}),e.jsxs("select",{id:"categoria",className:"form-control",value:i.categoria,onChange:o=>l({...i,categoria:o.target.value}),children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"electronico",children:"Electrónico"}),e.jsx("option",{value:"mueble",children:"Mueble"}),e.jsx("option",{value:"herramienta",children:"Herramienta"})]})]}),e.jsxs("div",{className:"col-2",children:[e.jsx("label",{htmlFor:"cantidad",className:"form-label",children:"Cantidad:"}),e.jsx("input",{id:"cantidad",type:"number",className:"form-control",value:i.cantidad,onChange:o=>l({...i,cantidad:parseInt(o.target.value,10)})})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:n,children:"Agregar"})]})]})})})},Ot=({show:s,handleClose:r,people:t,setPeople:c})=>{if(!s)return null;const[i,l]=a.useState({sexo:"otros",nombreApellido:"",dni:"",caridad:"denunciante"}),n=()=>{if(i){const o={sexo:i.sexo||"otros",nombreApellido:i.nombreApellido||"NN",dni:i.dni||"",caridad:i.caridad||"denunciante"};c([...t,o]),console.log("Nueva persona agregada:",o),l({sexo:"otros",nombreApellido:"",dni:"",caridad:"denunciante"}),r()}};return e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Agregar Persona"}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:r})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-8",children:[e.jsx("label",{htmlFor:"nombreApellido",className:"form-label",children:"Nombre y Apellido:"}),e.jsx("input",{id:"nombreApellido",type:"text",className:"form-control",value:i.nombreApellido,onChange:o=>l({...i,nombreApellido:o.target.value})})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("label",{htmlFor:"sexo",children:"Sexo:"}),e.jsxs("select",{id:"sexo",className:"form-control",value:i.sexo,onChange:o=>l({...i,sexo:o.target.value}),children:[e.jsx("option",{disabled:!0,children:"Seleccione"}),e.jsx("option",{value:"masculino",children:"👨 Masculino"}),e.jsx("option",{value:"femenino",children:"👩 Femenino"}),e.jsx("option",{value:"otros",children:"🧑‍🤝‍🧑 Otros"})]})]})]}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"dni",children:"DNI:"}),e.jsx("input",{id:"dni",type:"text",className:"form-control",value:i.dni,onChange:o=>l({...i,dni:o.target.value})})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"caridad",children:"Caridad:"}),e.jsxs("select",{id:"caridad",className:"form-control",value:i.caridad,onChange:o=>l({...i,caridad:o.target.value}),children:[e.jsx("option",{value:"denunciante",children:"Denunciante"}),e.jsx("option",{value:"imputado",children:"Imputado"})]})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:n,children:"Agregar"})]})]})})})},Bt=({show:s,handleClose:r,armas:t,setArmas:c})=>{if(!s)return null;const[i,l]=a.useState({tipo:"fuego",cantidad:1,descripcion:""}),n=()=>{const o={tipo:i.tipo||"otra",cantidad:i.cantidad||1,descripcion:i.descripcion||""};c([...t,o]),console.log("Nueva arma agregada:",o),l({tipo:"fuego",cantidad:1,descripcion:""}),r()};return e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Agregar Arma"}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:r})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"tipo",className:"form-label",children:"Tipo de Arma:"}),e.jsxs("select",{id:"tipo",className:"form-control",value:i.tipo,onChange:o=>l({...i,tipo:o.target.value}),children:[e.jsx("option",{value:"",children:"Seleccione"}),e.jsx("option",{value:"fuego",children:"Fuego"}),e.jsx("option",{value:"blanca",children:"Blanca"}),e.jsx("option",{value:"explosiva",children:"Explosiva"}),e.jsx("option",{value:"otra",children:"Otra"})]})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"cantidad",className:"form-label",children:"Cantidad:"}),e.jsx("input",{id:"cantidad",type:"number",className:"form-control",value:i.cantidad,onChange:o=>l({...i,cantidad:parseInt(o.target.value,10)||1})})]})]}),e.jsx("div",{className:"row mt-3",children:e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción:"}),e.jsx("textarea",{id:"descripcion",className:"form-control",value:i.descripcion,onChange:o=>l({...i,descripcion:o.target.value})})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:n,children:"Agregar"})]})]})})})},Ut=({show:s,handleClose:r,vehiculos:t,setVehiculos:c})=>{if(!s)return null;const[i,l]=a.useState({tipo:"",patente:"",modelo:"",descripcion:""}),n=()=>{const x={tipo:i.tipo.trim()!==""?i.tipo:"Desconocido",patente:i.patente||"Sin patente",modelo:i.modelo||"Sin modelo",descripcion:i.descripcion||""};c([...t,x]),console.log("Nuevo vehículo agregado:",x),l({tipo:"",patente:"",modelo:"",descripcion:""}),r()};return e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Agregar Vehículo"}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:r})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"tipo",className:"form-label",children:"Tipo:"}),e.jsxs("select",{id:"tipo",className:"form-control",value:i.tipo,onChange:o=>l({...i,tipo:o.target.value}),children:[e.jsx("option",{value:"",children:"Seleccione"}),e.jsx("option",{value:"bicicleta",children:"🚴 Bicicleta"}),e.jsx("option",{value:"moto",children:"🏍️ Moto"}),e.jsx("option",{value:"auto",children:"🚗 Auto"}),e.jsx("option",{value:"camion",children:"🚚 Camión"}),e.jsx("option",{value:"bus",children:"🚌 Autobús"}),e.jsx("option",{value:"otro",children:"Otro"})]})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"patente",className:"form-label",children:"Patente:"}),e.jsx("input",{id:"patente",type:"text",className:"form-control",value:i.patente,onChange:o=>l({...i,patente:o.target.value})})]})]}),e.jsx("div",{className:"row mb-3",children:e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"modelo",className:"form-label",children:"Modelo:"}),e.jsx("input",{id:"modelo",type:"text",className:"form-control",value:i.modelo,onChange:o=>l({...i,modelo:o.target.value})})]})}),e.jsx("div",{className:"row mb-3",children:e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"descripcion",className:"form-label",children:"Descripción:"}),e.jsx("textarea",{id:"descripcion",className:"form-control",rows:"3",value:i.descripcion,onChange:o=>l({...i,descripcion:o.target.value})})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:n,children:"Agregar"})]})]})})})};function qt(){const[s,r]=a.useState(!1),[t,c]=a.useState(!1),[i,l]=a.useState(!1),[n,o]=a.useState(!1),[x,h]=a.useState([]),[u,j]=a.useState([]),[g,N]=a.useState([]),[d,b]=a.useState([]),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(null),[p,y]=a.useState(""),[S,F]=a.useState(""),[_,k]=a.useState(""),[M,$]=a.useState(null),[U,Q]=a.useState([]),H=[{ciudad:"Santa Fe",unidad:"UR I"},{ciudad:"Rosario",unidad:"UR II"},{ciudad:"Rafaela",unidad:"UR V"},{ciudad:"Venado Tuerto",unidad:"UR VIII"},{ciudad:"Reconquista",unidad:"UR IX"},{ciudad:"Villa Gobernador Gálvez",unidad:"UR II"},{ciudad:"San Lorenzo",unidad:"UR XVII"},{ciudad:"Esperanza",unidad:"UR XI"},{ciudad:"Casilda",unidad:"UR IV"},{ciudad:"Cañada de Gómez",unidad:"UR X"},{ciudad:"Sunchales",unidad:"UR V"},{ciudad:"Firmat",unidad:"UR VIII"},{ciudad:"Arroyo Seco",unidad:"UR II"},{ciudad:"Tostado",unidad:"UR XII"},{ciudad:"San Jorge",unidad:"UR XVIII"},{ciudad:"Gálvez",unidad:"UR XV"},{ciudad:"Coronda",unidad:"UR XV"},{ciudad:"Avellaneda",unidad:"UR IX"},{ciudad:"El Trébol",unidad:"UR XVIII"},{ciudad:"Las Parejas",unidad:"UR X"},{ciudad:"Funes",unidad:"UR II"},{ciudad:"Puerto General San Martín",unidad:"UR XVII"},{ciudad:"Ceres",unidad:"UR XIII"},{ciudad:"San Justo",unidad:"UR XVI"},{ciudad:"Laguna Paiva",unidad:"UR I"},{ciudad:"Granadero Baigorria",unidad:"UR II"},{ciudad:"Villa Ocampo",unidad:"UR IX"},{ciudad:"Helvecia",unidad:"UR I"},{ciudad:"San Cristóbal",unidad:"UR XIII"},{ciudad:"Carcarañá",unidad:"UR IV"},{ciudad:"Teodelina",unidad:"UR VIII"},{ciudad:"Humboldt",unidad:"UR XI"}],V={"Santa Fe":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barranquitas","Comisaría 3ra. - Sección Rivadavia","Comisaría 4ta. - Sección Las Flores","Comisaría 5ta. - Sección El Pozo","Comisaría 6ta. - Sección Fomento 9 de Julio"],Rosario:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Puerto Norte","Comisaría 3ra. - Sección Tucumán","Comisaría 4ta. - Sección Echesortu","Comisaría 5ta. - Sección Pichincha","Comisaría 6ta. - Sección Zona Sur","Comisaría 7ma. - Sección La Florida","Comisaría 8va. - Sección Zona Oeste"],Rafaela:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Belgrano","Comisaría 3ra. - Sección 9 de Julio","Comisaría 4ta. - Sección Barrio 2 de Abril","Comisaría 5ta. - Sección Barrio La Cañada"],"Venado Tuerto":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Santa Fe","Comisaría 3ra. - Sección Malabrigo"],"San Lorenzo":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Zona Norte","Comisaría 3ra. - Sección Villa Felisa"],Firmat:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Las Delicias"],Casilda:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio San Pedro","Comisaría 3ra. - Sección Barrio Granaderos"],"Cañada de Gómez":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Sarmiento"],Reconquista:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio La Cortada","Comisaría 3ra. - Sección Barrio El Ombú"],Ceres:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio San José"],"San Justo":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio El Paraíso","Comisaría 3ra. - Sección Barrio San Carlos"],Alcorta:["Comisaría 1ra. - Sección Centro"],Totoras:["Comisaría 1ra. - Sección Centro"],"Las Parejas":["Comisaría 1ra. - Sección Centro"]},ie=()=>{l(!0)},oe=()=>{c(!0)},J=()=>{r(!0)},Z=()=>{l(!1)},L=()=>{c(!1)},G=()=>{o(!0)},se=()=>{o(!1)},ae=()=>{r(!1)},re=q=>{const te=x.filter(Ne=>Ne.dni!==q.dni);h(te)},ue=q=>{const te=d.filter((Ne,Fe)=>Fe!==q);b(te)},I=q=>{const te=g.filter((Ne,Fe)=>Fe!==q);N(te)},P=q=>{const te=u.filter((Ne,Fe)=>Fe!==q);j(te)};a.useEffect(()=>{const q=JSON.parse(localStorage.getItem("denuncia"));q&&(f(q.selectedLocalidad),v(q.denunciaIniciada),D(q.fechaHora),y(q.numero),F(q.dependenciaPolicial),k(q.relatoDenuncia),$(q.pdfFile),Q(q.dependenciasDisponibles))},[]);const T=()=>{f(""),v(""),D(null),y(""),F(""),k(""),$(null),Q([]),h([]),j([]),N([]),b([]),localStorage.removeItem("denuncia")},z=()=>{const q={selectedLocalidad:m,denunciaIniciada:C,fechaHora:w,numero:p,dependenciaPolicial:S,relatoDenuncia:_,pdfFile:M,dependenciasDisponibles:U};localStorage.setItem("denuncia",JSON.stringify(q))},B=q=>{const te=q.target.value;if(f(te),te){const Fe=new Date().getTime();D(Fe),v(` ${te}`);const fa=V[te]||[];Q(fa)}else v(""),D(null),y(""),F(""),k(""),Q([]);z()},E=q=>{const te=H.find(Ne=>Ne.ciudad===q);return te?te.unidad:null},R=q=>{if(!q)return"";const te=new Date(q),Ne=te.getHours().toString().padStart(2,"0"),Fe=te.getMinutes().toString().padStart(2,"0");return`${te.getDate()}/${te.getMonth()+1}/${te.getFullYear()} ${Ne}:${Fe}`},O=q=>{const te=q.target.value;/^\d*$/.test(te)&&(y(te),z())},ee=q=>{const te=q.target.value;F(te),z()},K=q=>{const te=q.target.value;k(te),z()},ce=q=>{const te=q.target.files[0];te&&te.type==="application/pdf"?$(te):($(null),alert("Por favor, sube un archivo PDF."))};return e.jsx("div",{className:"container-lg text-center",children:e.jsxs("div",{className:"row mt-5",children:[e.jsxs("div",{className:"col-sm-5 mt-5",children:[C&&e.jsxs("div",{className:"rounded-pill border border-pink border-5 shadow text-center",children:[e.jsxs("p",{className:"mt-3",children:[e.jsxs("span",{className:"text-pink me-2",children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2"}),"Iniciando Denuncia -"]}),e.jsxs("span",{className:"text-muted fw-semibold",children:[C," - "]}),e.jsxs("span",{children:[R(w)," hs"]})]}),e.jsxs("p",{children:[S&&e.jsxs("span",{className:"badge bg-pink me-3",children:[S.split("-")[0].trim()," ",e.jsxs("span",{className:"text-danger border border-red border-2 bg-white rounded-pill px-2 py-1 ms-2",children:[E(m)," "]})]}),p&&e.jsxs("span",{className:"badge text-bg-secondary me-3",children:["Sumario: ",p,M&&e.jsx("i",{className:"bi bi-file-earmark-pdf text-danger border border-red border-2 bg-white rounded-circle p-2 ms-2"})]}),_&&e.jsxs("span",{className:"badge text-bg-purple",children:["Relato :",e.jsx("i",{className:"bi bi-check-circle text-pink border border-pink border-2 bg-white rounded-circle p-2  ms-2"})]})]})]}),x.length>0&&e.jsxs("div",{className:"mt-0",children:[e.jsxs("div",{className:"text-purple",children:[" ",e.jsx("i",{className:"bi bi-arrow-down fs-3"})]}),e.jsx("div",{className:"border border-purple border-5 shadow-sm rounded-pill p-2",children:x.map((q,te)=>e.jsxs("div",{children:[e.jsx("span",{children:"🧑🏻"}),e.jsx("small",{className:"me-2",children:q.dni}),"  ",e.jsx("small",{className:"me-2",children:q.nombreApellido}),e.jsxs("small",{className:"ms-2",children:[q.sexo==="femenino"&&e.jsx("i",{className:"bi bi-gender-female  text-pink"}),q.sexo==="masculino"&&e.jsx("i",{className:"bi bi-gender-male  text-blue"}),q.sexo==="otros"&&e.jsx("i",{className:"bi bi-gender-ambiguous  text-teal"})]})," ",e.jsx("small",{className:`badge ms-2 text-capitalize ${q.caridad==="denunciante"?"text-bg-teal text-white ":q.caridad==="imputado"?"text-bg-pink":""}`,children:q.caridad}),e.jsx("button",{type:"button",className:"btn text-danger btn-sm ms-3",onClick:()=>re(q),children:e.jsx("i",{className:"bi bi-trash3"})})]},te))})]}),u.length>0&&e.jsxs("div",{className:"mt-0",children:[e.jsxs("div",{className:"text-greenUi",children:[" ",e.jsx("i",{className:"bi bi-arrow-down fs-3"})]}),e.jsx("div",{className:"border border-greenUi border-5 shadow-sm rounded-pill py-2",children:u.map((q,te)=>e.jsxs("div",{children:[e.jsxs("small",{className:"me-2 badge bg-purple text-white text-capitalize my-2",children:["Elemento ",q.categoria]}),e.jsxs("small",{className:" position-relative me-2  text-capitalize my-2",children:[q.nombre,"         ",e.jsx("span",{className:"ms-2 position-absolute top-0 start-100 translate-middle badge rounded-pill bg-pink ",children:q.cantidad})]}),e.jsx("button",{type:"button",className:"btn text-danger btn-sm ms-3 ",onClick:()=>P(te),children:e.jsx("i",{className:"bi bi-trash3"})})]},te))})]}),g.length>0&&e.jsxs("div",{className:"mt-0",children:[e.jsxs("div",{className:"text-primary",children:[" ",e.jsx("i",{className:"bi bi-arrow-down fs-3"})]}),e.jsx("div",{className:"border border-primary border-5 shadow-sm rounded-pill py-2",children:g.map((q,te)=>e.jsxs("div",{children:[e.jsxs("small",{className:" badge bg-blue position-relative me-2 text-white text-capitalize my-2",children:["Arma de Tipo  ",q.tipo,e.jsx("span",{className:"position-absolute top-0 start-100 translate-middle rounded-pill bg-pink  py-1 px-2",children:q.cantidad})]}),e.jsx("button",{type:"button",className:"btn text-danger btn-sm ms-3 ",onClick:()=>I(te),children:e.jsx("i",{className:"bi bi-trash3"})})]},te))})]}),d.length>0&&e.jsxs("div",{className:"mt-0",children:[e.jsxs("div",{className:"text-orange",children:[" ",e.jsx("i",{className:"bi bi-arrow-down fs-3"})]}),e.jsx("div",{className:"border border-orange border-5 shadow-sm rounded-pill py-2",children:d.map((q,te)=>e.jsxs("div",{children:[e.jsx("i",{className:`bi ${q.tipo==="auto"?"bi-car-front":q.tipo==="moto"?"bi-bicycle":q.tipo==="bus"?"bi-bus-front":q.tipo==="camion"?"bi-truck":q.tipo==="bicicleta"?"bi-bicycle":"bi-question-circle"} me-2 fs-4 text-orange `}),e.jsx("small",{className:"me-2 badge bg-orange text-white text-capitalize my-2",children:q.tipo}),e.jsx("small",{className:"me-2  text-capitalize my-2",children:q.patente}),e.jsx("small",{className:"me-2  text-capitalize my-2",children:q.modelo}),e.jsx("button",{type:"button",className:"btn text-danger btn-sm ms-3 ",onClick:()=>ue(te),children:e.jsx("i",{className:"bi bi-trash3"})})]},te))})]})]}),e.jsxs("div",{className:"col-sm-7 border border-2 p-4 shadow-sm position-relative",children:[e.jsx("div",{className:"position-absolute top-0 start-50 bg-redW translate-middle rounded-pill border-pink border border-3 bg-white text-pink px-4 py-2 shadow-sm",children:e.jsxs("h4",{className:"mb-0",children:[" Denuncia ",e.jsx("i",{className:"bi bi-flag ms-2 "})]})}),e.jsxs("form",{children:[e.jsxs("div",{className:"row mt-4",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"localidad",className:"form-label",children:"¿Cuál es la Localidad?"}),e.jsxs("select",{id:"localidad",className:"form-select text-center",value:m,onChange:B,children:[e.jsx("option",{value:"",children:"Seleccione una Ciudad"}),H.map((q,te)=>e.jsx("option",{value:`${q.ciudad}`,children:q.ciudad},te))]})]})}),e.jsx("div",{className:"col-6",children:m&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"dependenciaPolicial",className:"form-label",children:"Dependencia Policial"}),e.jsxs("select",{id:"dependenciaPolicial",className:"form-control text-center",value:S,onChange:ee,children:[e.jsx("option",{disabled:!0,value:"",children:"Seleccione una Dependencia"}),U.map((q,te)=>e.jsx("option",{value:q,children:q},te))]})]})}),"     ",e.jsx("div",{className:"col-4",children:S&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"numero",className:"form-label",children:"N° de Sumario"}),e.jsx("input",{id:"numero",type:"number",className:"form-control text-center",value:p,onChange:O,placeholder:"Ingresa un número"})]})}),e.jsx("div",{className:"col-8",children:p&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"pdfFile",className:"form-label",children:"¿Posee archivo PDF asociado?"}),e.jsx("input",{type:"file",id:"pdfFile",className:"form-control",accept:"application/pdf",onChange:ce}),M&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"text-pink",children:["Archivo PDF cargado: ",M.name]})})]})}),"    ",p&&e.jsxs("div",{className:"col-12",children:[" ",e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control",placeholder:"Completa",type:"text",value:_,id:"relatoDenuncia",onChange:K}),e.jsx("label",{children:"Relato de la denuncia "})]})," "]})]}),p&&e.jsxs("div",{className:"d-flex flex-row-reverse mt-5",children:[e.jsxs("div",{className:" btn rounded-5  bg-white border-teal border-2 text-teal me-2",onClick:G,children:[e.jsx("i",{className:"bi bi-boxes text-teal me-1"})," Elementos "]}),e.jsxs("div",{className:" btn rounded-5  bg-white border-primary border-2 text-primary me-2 ",onClick:J,children:[e.jsx("i",{className:"bi bi-shield text-primary me-1"}),"  Armas"]}),e.jsxs("div",{className:" btn rounded-5  bg-white border-indigo border-2 text-indigo me-2",onClick:ie,children:[e.jsx("i",{className:"bi bi-person-fill-add text-indigo me-1"}),"  Persona"]}),e.jsxs("div",{className:" btn rounded-5  bg-white border-orange border-2 text-orange me-2",onClick:oe,children:[e.jsx("i",{className:"bi bi-bicycle text-orange me-1"})," Vehiculos"]})]}),e.jsx("div",{className:"form-footer d-flex flex-row-reverse mt-5 ",children:e.jsxs("button",{type:"button",className:"text-danger btn rounded-pill border-red border border-2 ",onClick:T,children:[e.jsx("i",{className:"bi bi-trash"})," Restablecer Campos"]})})]})]}),e.jsx(Bt,{show:s,armas:g,handleClose:ae,setArmas:N}),e.jsx(Tt,{show:n,handleClose:se,elementos:u,setElementos:j}),e.jsx(Ot,{show:i,handleClose:Z,people:x,setPeople:h}),e.jsx(Ut,{show:t,handleClose:L,vehiculos:d,setVehiculos:b})]})})}const Vt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Nodo de Denuncias ",element2:"Capturas Calientes",element3:"bi bi-ui-checks"}),e.jsx(qt,{}),e.jsx("div",{className:"container-lg",id:"bodyGallery"}),e.jsx(je,{}),e.jsx(Ee,{})]}),Gt=({recepciones:s,loading:r})=>e.jsx("div",{className:"text-center mt-4",children:r?e.jsx("div",{className:"spinner-border text-primary",role:"status","aria-label":"Cargando..."}):Object.keys(s).length>0?e.jsxs("div",{className:"alert",children:[e.jsx("strong",{children:"Personas visibles por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,c],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-teal",role:"status","aria-label":"Comisaría con personas visibles"}),e.jsx("span",{className:"text-truncate",children:t}),e.jsxs("span",{className:"badge bg-teal",children:[c," personas"]})]},i))})]}):e.jsx("div",{className:"alert alert-primary shadow",children:e.jsx("strong",{children:"No hay personas visibles en este momento."})})}),Wt=ds,Ht=({dataInfo:s,loading:r,actualizarListado:t})=>{const[c,i]=a.useState("");console.log(r);const[l,n]=a.useState(null),[o,x]=a.useState(""),[h,u]=a.useState(!1),[j,g]=a.useState(null),[N,d]=a.useState({}),[b,m]=a.useState(!1),f=p=>Wt[p]||"",C=(p,y)=>{const S=new Date(y.seconds*1e3).getTime()+216e5,F=setInterval(()=>{const _=Date.now(),k=S-_;if(k<=0){clearInterval(F),d(H=>({...H,[p]:"00:00:00"}));return}const M=Math.floor(k/36e5),$=Math.floor(k%36e5/6e4),U=Math.floor(k%6e4/1e3),Q=`${M.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`;d(H=>({...H,[p]:Q}))},1e3);return F},v=async p=>{for(const y of p){const S=y.fecha_ingreso_validado;if(S&&S.seconds){const F=new Date(S.seconds*1e3);if(new Date().getTime()-F.getTime()>36e5){console.log(`Han pasado más de 1 hora desde la salida de ${y.nombre_apellido}`),alert(`Han pasado más de 1 hora el sistema da como salida a  ${y.nombre_apellido} del Articulo 10 bis`);const M=W(A,"db_art_diez_bis",y.id),$=await ze(M);if($.exists()){const U=W(A,"db_art_diez_bis_desactivados",y.id);await me(U,$.data()),await xe(M),await le(U,{visualidad:!1,salida_art:Pe(),salida_art_usuario:"sistema"}),t(),console.log(`Documento copiado, actualizado y eliminado para ${y.nombre_apellido}`)}}}}};a.useEffect(()=>{s&&s.length>0&&(v(s),s.forEach(p=>{p.fecha_ingreso_validado&&p.fecha_ingreso_validado.seconds&&C(p.id,p.fecha_ingreso_validado)}))},[s]);const w=async()=>{if(!j)return;m(!0);const{id:p,comisaria:y}=j,S=f(y);setTimeout(async()=>{if(o&&o===S)try{const F=JSON.parse(localStorage.getItem("user")),_=W(A,"db_art_diez_bis",p),k=await ze(_);if(k.exists()){const M=k.data();await me(W(A,"db_art_diez_bis_desactivados",p),{...M,visualidad:!1,salida_art:Pe(),salida_art_usuario:(F==null?void 0:F.email)||"sistema"}),await xe(_),i(""),alert("Recepción aceptada correctamente."),u(!1),x(""),t()}else alert("El documento no existe.")}catch(F){console.error("Error al aceptar la recepción: ",F),alert("Hubo un error al aceptar la recepción.")}finally{m(!1)}else i(`El código ingresado (${o}) es incorrecto.`),m(!1)},1e3)},D=p=>{g(p),u(!0)};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("p",{className:"text-center  text-center mb-4 bg-secondaryM text-white rounded p-2 mt-4 mb-3",children:["       ",e.jsx("span",{className:"text-capitalize fs-3  ",children:" Salida Art. 10 Bis "}),"  ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-4",children:r?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border ",role:"status","aria-label":"Cargando...",children:" "}),"  "]}):e.jsxs("div",{className:"list-group",children:[c&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:c}),s&&s.length>0?s.map(p=>e.jsxs("div",{className:"list-group-item mb-3 shadow",children:[e.jsx("div",{className:"text-end me-2",children:e.jsxs("span",{className:"badge bg-primary",children:[e.jsx("i",{className:"bi bi-clock titilar me-1"})," ",N[p.id]||"Cargando..."]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:p.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:p.dni})]}),e.jsx("button",{className:"btn btn-teal text-white btn-sm w-25",onClick:()=>D(p),disabled:l===p.id,children:l===p.id?"Procesando...":"Finalizar"})]}),e.jsxs("small",{className:"mt-2",children:[p.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:p.comisaria})," - ",p.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:p.unidad})]})]},p.id)):e.jsxs("div",{className:"alert alert-info text-capitalize shadow",role:"alert",children:["No se encontraron Personas en dependencias.",e.jsx("i",{className:"bi bi-hand-thumbs-up ms-2"})]})]})})]}),h&&j&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>u(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:j.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:o,onChange:p=>x(p.target.value),placeholder:"Código"}),c&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:c})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:w,disabled:!o||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>u(!1),children:"Cancelar"})]})]})})})]})},_s=()=>{const[s,r]=a.useState(!1),[t,c]=a.useState(""),[i,l]=a.useState({}),[n,o]=a.useState([]),x=async()=>{try{r(!0);const u=ge(Y(A,"db_art_diez_bis"),Se("visualidad","==",!0)),g=(await X(u)).docs.map(d=>({id:d.id,...d.data()}));o(g);const N=g.reduce((d,b)=>{const m=b.comisaria||"Comisaría desconocida";return d[m]=(d[m]||0)+1,d},{});l(N)}catch(u){console.error("Error al obtener datos: ",u)}finally{r(!1)}};a.useEffect(()=>{x()},[]);const h=t?n.filter(u=>(u.comisaria||"").toLowerCase()===t.toLowerCase()):n;return e.jsxs("div",{className:"container-lg mt-5",children:[e.jsx("div",{className:"row"}),e.jsxs("div",{className:"row gy-4",children:[e.jsxs("div",{className:"col-12 col-lg-4",children:[e.jsx(Gt,{recepciones:i,loading:s}),e.jsxs("div",{className:"mt-4 card p-3 shadow-sm",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize fw-bold text-muted",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select",value:t,onChange:u=>c(u.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),Object.keys(i).map((u,j)=>e.jsx("option",{value:u,children:u},j))]})]})]}),e.jsx("div",{className:"col-12 col-lg-8",children:e.jsx(Ht,{dataInfo:h,loading:s,actualizarListado:x})})]})]})},Yt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Salida 10 Bis ",element2:"Cx2",element3:"bi bi-ui-checks"}),e.jsx(_s,{}),e.jsx("div",{className:"container-lg",id:"bodyGallery"}),e.jsx(je,{}),e.jsxs("div",{className:"pt-5",children:[" ",e.jsx(Ee,{})]})]}),ks=({message:s,duration:r=1e4,onClose:t})=>(a.useEffect(()=>{const c=setTimeout(()=>{t()},r);return()=>clearTimeout(c)},[r,t]),e.jsxs("div",{className:"toast show position-fixed bottom-0 end-0 m-3 mb-5 shadow",role:"alert","aria-live":"assertive","aria-atomic":"true",children:[e.jsxs("div",{className:"toast-header",children:[e.jsx("strong",{className:"me-auto",children:"Notificación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:t,"aria-label":"Close"})]}),e.jsxs("div",{className:"toast-body",children:[e.jsx("i",{className:"bi bi-circle-fill px-3 text-indigo"})," ",s]})]}));ks.propTypes={message:ve.string.isRequired,duration:ve.number,onClose:ve.func.isRequired};const Jt=({onSubmit:s,savedImage:r,resetImage:t})=>{const[c,i]=a.useState(()=>{const f=localStorage.getItem("formData");return f?JSON.parse(f):{nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,captura:!1,prioridad:1,alertaParaderoCaptura:""}}),[l,n]=a.useState({}),[o,x]=a.useState(!1),[h,u]=a.useState(!1),[j,g]=a.useState("");a.useEffect(()=>{console.log(localStorage),localStorage.setItem("formData",JSON.stringify(c))},[c]);const N=({target:{id:f,value:C,type:v,checked:w}})=>{i(D=>{let p={...D,[f]:v==="checkbox"?w:C};if(f==="alertaParaderoCaptura")switch(C){case"paradero":p={...p,prioridad:2,paradero:!0,alerta:!1};break;case"evadido":p={...p,prioridad:3,captura:!0,alerta:!0};break;case"prioritaria":p={...p,prioridad:4,alerta:!1};break;default:p={...p,prioridad:1,paradero:!1,alerta:!1};break}return p}),n(D=>({...D,[f]:""}))},d=()=>{const f={};return r?(c.nombreApellido.match(/[A-Za-zÑñÁáÉéÍíÓóÚú\s]+/)||(f.nombreApellido="Ingrese solo letras y espacios."),c.documento.length<5&&(f.documento="El número de documento debe tener al menos 5 caracteres."),n(f),Object.keys(f).length===0):(alert("Debes cargar una imagen antes de enviar el formulario."),g("Debes cargar una imagen antes de enviar el formulario."),u(!0),!1)},b=async f=>{if(f.preventDefault(),!d())return;if(!window.confirm("¿Estás seguro de que deseas enviar este formulario?")){alert("El envío ha sido cancelado.");return}x(!0);try{const v={...c,imagen:r};if(typeof s=="function")await s(v),alert("Formulario enviado correctamente."),g("Formulario enviado correctamente."),u(!0);else throw new Error("onSubmit no es una función válida")}catch(v){console.error(v),alert("Hubo un error al enviar el formulario."),g("Hubo un error al enviar el formulario."),u(!0)}finally{x(!1),m()}},m=()=>{i({nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,prioridad:1,alertaParaderoCaptura:""}),n({}),t()};return e.jsxs("div",{className:"col-md-6 mt-3",children:[o&&e.jsx(ne,{})," ",h&&e.jsx(ks,{message:j,onClose:()=>u(!1)}),e.jsxs("form",{onSubmit:b,children:[e.jsx("div",{className:"row mt-sm-5 mt-md-1 text-center",children:e.jsx(Je,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-person-fill text-greenUi me-3 p-1"})," Nombre y Apellido"]}),id:"nombreApellido",type:"text",value:c.nombreApellido,error:l.nombreApellido,onChange:N,required:!0,className:"text-center"})}),e.jsxs("div",{className:"row  text-center",children:[e.jsx(Je,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-file-earmark-person text-greenUi me-3 p-1"})," Número de Documento"]}),id:"documento",type:"number",value:c.documento,error:l.documento,onChange:N,className:"col"}),e.jsx($s,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-gender-ambiguous text-greenUi me-3 p-1"})," Sexo"]}),id:"sexo",value:c.sexo,options:[{label:"Seleccione",value:""},{label:"Masculino 👨",value:"masculino"},{label:"Femenino 👩",value:"femenino"},{label:"Otros 👭🏻 ",value:"otro"}],onChange:N,className:"col"})]}),e.jsxs("div",{className:"row  text-center",children:[e.jsx(Je,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-building text-greenUi me-3 p-1"})," Entidad Solicita Captura"]}),id:"entidad",type:"text",value:c.entidad,onChange:N,className:"col"}),e.jsx(Je,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-telephone text-greenUi me-3 p-1"})," Número de Contacto"]}),id:"numeroContacto",type:"tel",value:c.numeroContacto,error:l.numeroContacto,onChange:N,className:"col"})]}),e.jsx(Rs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil text-greenUi me-3 p-1"})," Datos de la Persona"]}),id:"descripcionFisica",value:c.descripcionFisica,onChange:N,className:"text-center"}),e.jsx(Rs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil-square text-greenUi me-3 p-1"})," Motivo  Captura / Info Interés"]}),id:"motivoCaptura",value:c.motivoCaptura,onChange:N,className:"text-center"}),e.jsx($s,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill p-1 text-white me-3 "})," Selecciona una Tipo de Alerta"]}),id:"alertaParaderoCaptura",value:c.alertaParaderoCaptura,options:[{label:"Normal",value:"normal"},{label:"Búsqueda Paradero 🔍 ",value:"paradero"},{label:"Alerta Evadido 🚨",value:"evadido"},{label:"Captura Prioritaria ⚠️",value:"prioritaria"}],onChange:N}),e.jsxs("div",{className:"d-flex justify-content-end pt-4  mt-3",children:[e.jsxs("button",{type:"submit",className:"btn btn-outline-blue shadow me-2",disabled:o,children:[e.jsx("i",{className:"bi bi-send"})," Enviar"]}),e.jsxs("button",{type:"button",onClick:m,className:"btn btn-outline-pink shadow",children:[e.jsx("i",{className:"bi bi-x-circle"})," Borrar"]})]})]})]})},Je=({label:s,id:r,type:t="text",value:c,error:i,onChange:l,className:n="",required:o=!1})=>e.jsxs("div",{className:`mb-5  ${n}`,children:[e.jsx("span",{htmlFor:r,className:"input-group-text text-center d-flex justify-content-center mb-0",children:s}),e.jsx("input",{type:t,className:`shadow text-center form-control ${i?"is-invalid":""}`,id:r,value:c,onChange:l,required:o}),e.jsx("div",{className:"invalid-feedback",children:i})]}),$s=({label:s,id:r,value:t,options:c,onChange:i,className:l=""})=>e.jsxs("div",{className:`mb-5 ${l} text-center`,children:[e.jsx("span",{htmlFor:r,className:`input-group-text text-center d-flex justify-content-center shadow ${r==="alertaParaderoCaptura"?"bg-danger text-white":""}`,children:s}),e.jsx("select",{className:"form-select shadow text-center",id:r,value:t,onChange:i,children:c.map(({label:n,value:o})=>e.jsx("option",{value:o,children:n},o))})]}),Rs=({label:s,id:r,value:t,onChange:c,className:i=""})=>e.jsxs("div",{className:`form-floating mb-5 ${i}`,children:[e.jsx("textarea",{className:"form-control",id:r,value:t,onChange:c,style:{height:"100px"},placeholder:" "}),e.jsx("label",{htmlFor:r,children:s})]}),Zt=({onImageSave:s})=>{const[r,t]=a.useState(!1),[c,i]=a.useState(null),[l,n]=a.useState(""),o=a.useRef(null),[x,h]=a.useState(!1),[u,j]=a.useState({x:0,y:0}),[g,N]=a.useState({x:0,y:0}),[d,b]=a.useState(1),m=a.useRef(null),f=S=>{h(!0);const{offsetX:F,offsetY:_}=S.nativeEvent;N({x:F,y:_})},C=S=>{if(!x||!c)return;const{offsetX:F,offsetY:_}=S.nativeEvent;j(k=>({x:k.x+(F-g.x),y:k.y+(_-g.y)})),N({x:F,y:_})},v=()=>{h(!1)},w=()=>{t(!1),n(""),i(null),j({x:0,y:0}),b(1);const S=document.getElementById("file-input");S&&(S.value=""),m.current&&(URL.revokeObjectURL(m.current),m.current=null)},D=()=>t(!0),p=S=>{const F=S.target.files[0];if(F){if(!F.type.startsWith("image/")){n("Por favor, selecciona un archivo de imagen.");return}if(F.size>5*1024*1024){n("La imagen debe ser menor de 5 MB.");return}const _=URL.createObjectURL(F);m.current=_,i(_),n("")}},y=()=>{if(!c||!o.current){n("Por favor, selecciona una imagen antes de guardar.");return}const S=o.current,F=S.width,_=S.height,k=document.createElement("canvas");k.width=F,k.height=_;const M=k.getContext("2d"),$=new Image;$.src=c,$.onload=()=>{M.clearRect(0,0,F,_),M.drawImage($,u.x,u.y,$.width*d,$.height*d);const U=k.toDataURL("image/jpeg",.92);s(U),w()}};return a.useEffect(()=>{if(c&&o.current){const S=o.current,F=S.getContext("2d"),_=new Image;_.src=c,_.onload=()=>{F.clearRect(0,0,S.width,S.height),F.drawImage(_,u.x,u.y,_.width*d,_.height*d)}}},[c,u,d]),a.useEffect(()=>{const S=o.current,F=_=>{if(_.preventDefault(),!c)return;const k=1.1,M=_.deltaY<0?d*k:d/k;b(Math.max(M,.1))};if(S)return S.addEventListener("wheel",F,{passive:!1}),()=>{S.removeEventListener("wheel",F)}},[c,d]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container-lg text-center py-2 text-capitalize text-secondary fs-3 fw-semibold col-10 col-sm-12 px-4 col-md-10",children:e.jsxs("button",{className:"btn btn-secondaryMuiRed text-white border border-white border-5 rounded-pill w-100 mb-4 shadow-sm d-flex align-items-center position-relative",type:"button",onClick:D,children:[e.jsx("span",{className:"bg-light text-secondaryMuiRed d-flex justify-content-center align-items-center rounded-circle shadow-lg position-absolute top-50 translate-middle-y start-0 ms-3 border border-5",style:{width:"60px",height:"60px"},children:e.jsx("i",{className:"bi bi-images fs-3"})}),e.jsx("span",{className:"flex-grow-1 text-center fw-semibold",children:e.jsx("span",{children:"Subir Imagen"})})]})}),e.jsx("div",{className:`modal fade ${r?"show":""}`,style:{display:r?"block":"none"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!r,children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Subir Imagen "}),e.jsx("button",{type:"button",className:"btn-close",onClick:w,"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("input",{id:"file-input",type:"file",className:"form-control",accept:"image/*",onChange:p}),c&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("h6",{className:"p-2 text-purple fw-semibold ",children:["Vista Previa / Edición ",e.jsx("i",{className:"bi bi-image ms-3 fs-3 text-purple"})]}),e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("canvas",{ref:o,className:"shadow",onMouseDown:f,onMouseMove:C,onMouseUp:v,onMouseLeave:v,width:500,height:500,style:{border:"1px solid black",cursor:x?"grabbing":"grab"}})}),e.jsx("p",{className:"text-redUi1 fs-6 text-center mt-4",children:" 🤔 Para hacer zoom en la imagen, simplemente usa el scroll (la rueda) de tu mouse. 🖲️  "}),e.jsx("p",{className:"text-purple  fs-6 text-center mt-1",children:" 🤔 Mantén presionado el botón del mouse para arrastrar la imagen. 🖱️  "})]}),l&&e.jsx("div",{className:"mt-2 text-danger",children:l})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:w,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-pink",onClick:y,children:"Guardar Imagen"})]})]})})}),e.jsx("div",{className:`modal-backdrop fade ${r?"show":""}`,style:{display:r?"block":"none"}})]})},Qt=()=>{const[s,r]=a.useState(null),[t,c]=a.useState(!1);a.useEffect(()=>{const x=()=>{c(window.innerWidth<576)};return window.addEventListener("resize",x),x(),()=>{window.removeEventListener("resize",x)}},[]);const i=x=>{r(x)},l=async x=>{console.log(x);const h=()=>{const N=new Date,d=String(N.getDate()).padStart(2,"0"),b=String(N.getMonth()+1).padStart(2,"0"),m=String(N.getFullYear()).slice(-2);return`${d}/${b}/${m}`},j=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),g={documento:x.documento,nombre_apellido:x.nombreApellido.toLowerCase(),sexo:x.sexo,entidad:x.entidad,numero_contacto:x.numeroContacto,descripcion_fisica:x.descripcionFisica,motivo_captura:x.motivoCaptura,base64:s,date:h(),usuario:j?j.email:"Desconocido",prioridad:x.prioridad,alerta:x.alerta||!1,paradero:x.paradero||!1};try{await ye(Y(A,"db_personas"),g),console.log("Datos guardados en Firebase:",g),n()}catch(N){console.error("Error al guardar los datos en Firebase:",N)}},n=()=>{r(null)},o=x=>{const h=x.target.files[0];if(h){const u=new FileReader;u.onloadend=()=>{const j=new Image;j.onload=()=>{const g=document.createElement("canvas"),N=g.getContext("2d"),d=500,b=500;let m=j.width,f=j.height;m>f?m>d&&(f*=d/m,m=d):f>b&&(m*=b/f,f=b),g.width=m,g.height=f,N.drawImage(j,0,0,m,f);const C=g.toDataURL("image/jpeg");r(C)},j.src=u.result},u.readAsDataURL(h)}};return e.jsx("div",{className:"container mt-3",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-5 d-flex flex-column justify-content-center align-items-center text-center m-1",children:[s?e.jsx("img",{src:s,alt:"Imagen guardada",width:"350",style:{height:"auto"},className:"border border-1 shadow mb-5"}):e.jsx("img",{src:"svg/undraw_male_avatar_g98dG.svg",alt:"Avatar",width:"350",style:{height:"auto"},className:"mb-5"}),t?e.jsxs("div",{className:"mb-3 text-teal",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Subir Imagen"}),e.jsx("input",{type:"file",className:"form-control text-green",onChange:o})]}):e.jsx(Zt,{onImageSave:i})]}),e.jsx(Jt,{onSubmit:l,savedImage:s,resetImage:n})]})})},Xt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Formularios de ingreso",element2:"Cx2",element3:"bi bi-input-cursor"}),e.jsx("div",{className:"container-lg",id:"bodyGallery",children:e.jsx(Qt,{})}),e.jsx(je,{}),e.jsx(Ee,{})]}),aa="/gif/dash3.gif",Kt=()=>e.jsxs("div",{children:[e.jsx("h5",{className:"text-secondary fs-1 text-center mb-5 text-cyan mt-5 mt-md-0",children:"Bienvenido al Panel de Control 10 Bis"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-md-6 text-center d-flex justify-content-center",children:e.jsxs("div",{className:"row",children:[e.jsxs("p",{className:"p-2",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-blueW text-cyan"}),"Aquí podrás administrar los recursos del sistema de forma fácil y sencilla."]}),e.jsxs("p",{className:"p-2",children:[e.jsx("i",{className:"bi bi-lightbulb p-3 rounded-circle me-3 bg-blueW text-cyan"}),"Recuerda que, ante cualquier problema, puedes solicitar asistencia técnica."]})]})}),e.jsx("div",{className:"col-12 col-md-6 text-center",children:e.jsx("div",{children:e.jsx("img",{src:aa,alt:"Descripción de la imagen",className:"img-thumbnail p-2 rounded-circle shadow",style:{width:"300px",height:"210px"}})})})]})]}),ta=({showModal:s,closeModal:r})=>{const t={Rosario:["Comisaria 1ra. - Sección Centro","Comisaria 2da. - Sección Puerto Norte","Comisaria 3ra. - Sección Tucuman","Comisaria 4ta. - Sección Echesortu","Comisaria 5ta. - Sección Pichincha","Comisaria 6ta. - Sección Zona Sur","Comisaria 7ma. - Sección La Florida","Comisaria 8va. - Sección Zona Oeste"]},c=["CRE Rosario","CRE Baigorria","BOU","BOP","AUOP","MOTORIZADA","CGI","PAT","CYP","VIAL","PUMAS","OTROS"],[i,l]=a.useState("Rosario"),[n,o]=a.useState(""),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState(""),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!1),p=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/,[y,S]=a.useState([]),[F,_]=a.useState(""),[k,M]=a.useState(""),[$,U]=a.useState([]),Q=new Date().toLocaleString(),H=L=>p.test(L),V=()=>{if(!H(u)){f("El nombre y apellido solo deben contener letras y espacios.");return}if(g.length!==8||isNaN(g)){v("El DNI debe ser un número de 8 caracteres.");return}U([...$,{nombreApellido:u,dni:g}]),j(""),N(""),f("")},ie=()=>{if(k.length!==6||isNaN(k)){v("El NI debe ser un número de 6 caracteres.");return}if(!H(F)){v("El nombre no debe contener números.");return}S([...y,{nombre:F,ni:k}]),_(""),M(""),v("")},oe=async L=>{if(L.preventDefault(),!n){b("Por favor, selecciona una comisaría.");return}if(!x){b("Por favor, selecciona una unidad.");return}if($.length===0){b("Debes agregar al menos una persona.");return}if(y.length===0){b("Debes agregar al menos una persona para la entrega.");return}if(!window.confirm("¿Estás seguro de que deseas agregar Art. 10 Bis?")){alert("La operación fue cancelada.");return}b(""),D(!0);try{const se=JSON.parse(localStorage.getItem("user"));for(let ae=0;ae<$.length;ae++){const re=$[ae];await ye(Y(A,"db_art_diez_bis"),{nombre_apellido:re.nombreApellido,dni:re.dni,selectedLocalidad:i,comisaria:n.split(".")[0].trim(),unidad:x,timestamp:Q,usuario:(se==null?void 0:se.email)||"Usuario desconocido",visualidad:!1,comisaria_recibe:!1,personal_entrega:y})}alert("Se agregaron las personas con Art. 10 Bis."),j(""),N(""),o(""),h(""),l("Rosario"),S([]),r()}catch(se){console.error("Error al enviar notificación: ",se),b("Error al enviar la notificación. Inténtalo de nuevo.")}finally{D(!1)}},J=L=>{const G=$.filter((se,ae)=>ae!==L);U(G)},Z=L=>{const G=y.filter((se,ae)=>ae!==L);S(G)};return s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-dark",children:[e.jsx("h5",{className:"modal-title text-center fw-semibold text-white",children:"Agregar Persona - Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:r})]}),e.jsx("div",{className:"modal-body",children:e.jsx("form",{onSubmit:oe,children:e.jsxs("div",{className:"container ",children:[e.jsxs("div",{className:"mb-3 text-center",children:[d&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),d]}),m&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),m]}),C&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar"}),C]})]}),e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-primary fw-semibold shadow-sm text-white py-2 rounded",children:"Agregar personas 10 Bis"}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${m&&!p.test(u)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:u,onChange:L=>j(L.target.value)}),e.jsx("label",{htmlFor:"nombreApellido",children:"Nombre y Apellido"}),m&&!p.test(u)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${m&&(g.length!==8||isNaN(Number(g)))?"is-invalid":""}`,maxLength:"8",placeholder:"DNI",value:g,onChange:L=>N(L.target.value.replace(/[^\d]/g,""))}),e.jsx("label",{htmlFor:"dni",children:"DNI"}),m&&(g.length!==8||isNaN(Number(g)))&&e.jsx("div",{className:"invalid-feedback",children:"El DNI debe ser un número de hasta 8 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-primary shadow-sm rounded-circle",onClick:()=>V(),children:"+"})})]}),$.map((L,G)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 "}),L.nombreApellido," - ",L.dni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>J(G),children:e.jsx("i",{className:"bi bi-trash"})})]},G)),e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-pink fw-semibold shadow-sm text-white py-2 rounded",children:"Dependencia Destino"}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("select",{className:`form-select ${d&&!i?"is-invalid":""}`,value:i,onChange:L=>l(L.target.value),children:e.jsx("option",{value:"Rosario",children:"Rosario"})}),e.jsx("label",{htmlFor:"localidad",children:"Localidad"}),d&&!i&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una localidad."})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:`form-select ${d&&!n?"is-invalid":""}`,value:n,onChange:L=>o(L.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Comisaría"}),(t[i]||[]).map(L=>e.jsx("option",{value:L,children:L},L))]}),e.jsx("label",{htmlFor:"comisaria",children:"Comisaría"}),d&&!n&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una comisaría."})]})})]}),e.jsxs("div",{className:"mb-3 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-blue fw-semibold shadow-sm text-white py-2 rounded",children:"Unidad Procede a la Entrega"}),e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{id:"unidad",className:`form-select ${d&&!x?"is-invalid":""}`,value:x,onChange:L=>h(L.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Unidad"}),c.map(L=>e.jsx("option",{value:L,children:L},L))]}),e.jsx("label",{htmlFor:"unidad",children:"Unidad Procede a la Entrega"}),d&&!x&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una unidad."})]})]}),e.jsxs("div",{className:"mb-3 text-center mt-4",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-secondaryM fw-semibold shadow-sm text-white py-2 rounded",children:"Mi Unidad de Trabajo"}),e.jsxs("div",{className:"row g-2 mb-2",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${C&&!p.test(F)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:F,onChange:L=>_(L.target.value)}),e.jsx("label",{htmlFor:"nombreEntrega",children:"Nombre y Apellido"}),C&&!p.test(F)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${C&&(k.length!==6||isNaN(k))?"is-invalid":""}`,placeholder:"N.I",maxLength:"6",value:k,onChange:L=>M(L.target.value)}),e.jsx("label",{htmlFor:"niEntrega",children:"N.I"}),C&&(k.length!==6||isNaN(k))&&e.jsx("div",{className:"invalid-feedback",children:"El N.I debe ser un número de 6 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-primary shadow-sm rounded-circle",onClick:()=>ie(),children:"+"})})]}),y.map((L,G)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light mt-3",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 "}),L.nombre," - ",L.ni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>Z(G),children:e.jsx("i",{className:"bi bi-trash"})})]},G))]}),e.jsx("div",{className:"text-center mb-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary shadow",disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-arrow-repeat me-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),"Confirmar"]})})})," "]})})})]})})}):null},ei=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()},n=()=>{c(!t)};return a.useEffect(()=>{if(i.pathname==="/dashboard"){const o=x=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Herramientas Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("button",{className:`btn btn-${t?"secondary":"purple"}`,onClick:n,children:[t?"Ocultar Formulario":"Ingresar Nuevo Art. 10 Bis",e.jsx("i",{className:`ms-2 bi ${t?"bi-x-circle":"bi-person-add"}`})]})}),t&&e.jsx("div",{className:"container my-4",children:e.jsx(ta,{showModal:s,closeModal:l})})]})]})})}):null},si=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const n=o=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Recepción Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(gs,{})})})]})})}):null},ai=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const n=o=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Salida / Egreso Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(_s,{})})})]})})}):null},ia=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState("nombre"),x=async()=>{try{const b=(await X(Y(A,"db_comisarias"))).docs.map(m=>({id:m.id,...m.data()})).filter(m=>m.disponibilidad===!0);r(b)}catch(d){console.error("Error al obtener las comisarías: ",d)}},h=async()=>{try{const b=(await X(Y(A,"db_art_diez_bis"))).docs.map(C=>({id:C.id,...C.data()})),m=b.filter(C=>C.visualidad===!0&&C.comisaria_recibe===!0),f=b.filter(C=>C.visualidad===!1&&C.comisaria_recibe===!1);c(m),l(f)}catch(d){console.error("Error al obtener las notificaciones: ",d)}};a.useEffect(()=>{x(),h()},[]);const u=t.reduce((d,b)=>{const m=b.comisaria;return m&&(d[m]=(d[m]||0)+1),d},{}),j=i.reduce((d,b)=>{const m=b.comisaria;return m&&(d[m]=(d[m]||0)+1),d},{}),g=d=>{const b=s.find(m=>m.comisaria===d);if(b){const m=b.plazas_art_10_bis||0;return(u[d]||0)>=m?{estado:"Llena",clase:"badge bg-danger"}:{estado:"Disponible",clase:"badge bg-info"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},N=()=>n==="nombre"?[...s].sort((d,b)=>d.comisaria.localeCompare(b.comisaria)):n==="plaza"?[...s].sort((d,b)=>(b.plazas_art_10_bis||0)-(d.plazas_art_10_bis||0)):s;return e.jsxs("div",{children:[e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select",id:"filtroOrden",value:n,onChange:d=>o(d.target.value),"aria-label":"Ordenar por",children:[e.jsx("option",{value:"nombre",children:"Nombre (A-Z)"}),e.jsx("option",{value:"plaza",children:"Plazas Disponibles"})]}),e.jsx("label",{htmlFor:"filtroOrden",children:"Ordenar por"})]}),e.jsx("div",{className:"list-group",children:N().map(d=>{const{estado:b,clase:m}=g(d.comisaria),f=u[d.comisaria]||0,C=j[d.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{children:d.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:m,children:`${f} / ${d.plazas_art_10_bis||0} Plazas - ${b}`}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary",children:`${C} Pendientes ( Por Validar )`})})]})]})]})},d.comisaria)})})]})},ti=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const n=o=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-md",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Plazas Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(ia,{})})})]})})}):null},ii=()=>{const[s,r]=a.useState(!1),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState({search:"",estado:"",comisaria:""}),[x,h]=a.useState(!1),[u,j]=a.useState(!1),[g,N]=a.useState(""),d=async()=>{r(!0);try{let v=Y(A,"db_art_diez_bis");if(n.estado==="desactivado")v=Y(A,"db_art_diez_bis_desactivados");else if(n.estado===""){const p=await X(Y(A,"db_art_diez_bis")),y=await X(Y(A,"db_art_diez_bis_desactivados")),S=p.docs.map(k=>({id:k.id,...k.data()})),F=y.docs.map(k=>({id:k.id,...k.data()})),_=[...S,...F];c(_),l(_),r(!1);return}const D=(await X(v)).docs.map(p=>({id:p.id,...p.data()}));c(D),l(D)}catch(v){console.error("Error al obtener las notificaciones: ",v)}finally{r(!1)}};a.useEffect(()=>{d()},[n.estado]);const b=v=>{const{name:w,value:D}=v.target;o(p=>({...p,[w]:D}))};a.useEffect(()=>{const{search:v,estado:w,comisaria:D}=n,p=t.filter(y=>{var k,M,$;const S=v===""||((k=y.nombre_apellido)==null?void 0:k.toLowerCase().includes(v.toLowerCase()))||((M=y.dni)==null?void 0:M.toString().includes(v)),F=w===""||(w==="activado"?y.visualidad:!y.visualidad),_=D===""||(($=y.comisaria)==null?void 0:$.toLowerCase())===D.toLowerCase();return S&&F&&_});l(p),p.length===0?h(!0):h(!1)},[n,t]);const m=async(v,w,D)=>{try{if(w){const p=W(A,"db_art_diez_bis",v);await le(p,{visualidad:!1}),await me(W(A,"db_art_diez_bis_desactivados",v),D),await xe(p),d(),alert("Estado desactivado y documento movido a desactivados")}else{const p=W(A,"db_art_diez_bis_desactivados",v),y=D;await me(W(A,"db_art_diez_bis",v),{...y,visualidad:!0}),await xe(p),d(),alert("Estado activado y documento movido a activados")}}catch(p){console.error("Error al actualizar la visualidad: ",p),alert("Hubo un error al cambiar la visualidad.")}},f=()=>j(!1),C=v=>{N(v),j(!0)};return e.jsxs("div",{className:"container-lg text-center mt-5  mt-sm-5 mt-md-0 ms-lg-0",children:[e.jsxs("div",{className:"alert alert-light text-danger text-center bg-white border border-2 shadow-sm",role:"alert",children:["Recuerda que las personas están dentro del contexto ",e.jsx("strong",{children:" 6 horas cumplidas como maximo ( Art. 10 Bis ) desde su Ingreso . "}),"Por lo tanto el sistema da salida automáticamente a esas personas cumplido el plazo."]}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-4 mb-3  mb-sm-5 mb-md-0 mb-lg-0",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:"form-control shadow-sm",name:"search",value:n.search,onChange:b,placeholder:"Buscar por nombre o DNI"}),e.jsx("label",{htmlFor:"search",children:"Buscar por nombre o DNI"})]})}),e.jsx("div",{className:"col-md-4  mb-3 mb-sm-5 mb-md-0 mb-lg-0",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm",name:"estado",value:n.estado,onChange:b,children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:"activado",children:"Activado"}),e.jsx("option",{value:"desactivado",children:"Desactivado"})]}),e.jsx("label",{htmlFor:"estado",children:"Filtrar por estado"})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm",name:"comisaria",value:n.comisaria,onChange:b,children:[e.jsx("option",{value:"",children:"Todas las comisarías"}),[...new Set(t.map(v=>v.comisaria).filter(Boolean))].map(v=>e.jsx("option",{value:v,children:v},v))]}),e.jsx("label",{htmlFor:"comisaria",children:"Filtrar por comisaría"})]})})]}),x&&e.jsx("div",{className:"alert alert-danger",children:"No se encontraron coincidencias"}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-6 col-md-3 mt-4",children:[e.jsxs("button",{className:"btn btn-primary text-white fw-semibold mt-3 w-100",onClick:()=>C("panel"),children:["Nuevo 10 Bis"," ",e.jsx("i",{className:"bi bi-person-add rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-teal text-white fw-semibold mt-3 w-100",onClick:()=>C("recepcion"),children:["Recepción 10 Bis"," ",e.jsx("i",{className:"bi bi-people-fill rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-secondaryMuiRed text-white fw-semibold mt-3 w-100",onClick:()=>C("estadio"),children:["Alojados 10 Bis"," ",e.jsx("i",{className:"bi bi-person-raised-hand rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-orange text-white fw-semibold mt-3 w-100",onClick:()=>C("plazas"),children:["Plazas 10 Bis"," ",e.jsx("i",{className:"bi bi-shield-lock rounded-circle border border-2 p-1 m-1"})]})]}),e.jsx("div",{className:"col-12 col-md-9 mt-4",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h3",{children:"Actividad Art 10 Bis"})}),s?e.jsx(ne,{}):e.jsx("div",{className:"list-group",children:i.map(v=>e.jsxs("div",{className:`list-group-item mb-3 shadow ${v.visualidad?"bg-greenW2":"bg-redW"}`,children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:v.nombre_apellido||"Sin nombre"})," -"," ",v.dni||"Sin DNI"]}),e.jsx("button",{className:`btn fw-semibold btn-sm ${v.visualidad?"btn-pink text-white rounded-pill":"btn-teal text-white rounded-pill"}`,onClick:()=>m(v.id,v.visualidad,v),children:v.visualidad?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-eye-slash me-1"})," Ocultar"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-eye me-2"})," Activar"]})})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("small",{children:[v.selectedLocalidad||"Localidad desconocida"," -"," ",v.comisaria||"Comisaría desconocida"," -"," ",v.timestamp?v.timestamp.split(",")[0]+" "+v.timestamp.split(",")[1].trim().slice(0,5)+" hs":"Fecha no disponible"]})})]},v.id))})]})})]}),u&&g==="panel"&&e.jsx(ei,{showModal:u,closeModal:f}),u&&g==="recepcion"&&e.jsx(si,{showModal:u,closeModal:f}),u&&g==="estadio"&&e.jsx(ai,{showModal:u,closeModal:f}),u&&g==="plazas"&&e.jsx(ti,{showModal:u,closeModal:f})]})},ri=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState(!0),n=["comisaria","fecha_ingreso_validado","dni","nombre_apellido","selectedLocalidad","timestamp","unidad","usuario_validado_ingreso","salida_art","salida_art_usuario"],o=async()=>{try{const g=Y(A,"db_art_diez_bis"),N=Y(A,"db_art_diez_bis_desactivados"),[d,b]=await Promise.all([X(g),X(N)]),m=d.docs.map(v=>({id:v.id,...v.data()})),f=b.docs.map(v=>({id:v.id,...v.data()})),C=[...m,...f];r(C),l(!1)}catch(g){console.error("Error al obtener los datos:",g),l(!1)}},x=g=>{c(N=>N.includes(g)?N.filter(d=>d!==g):[...N,g])},h=()=>{c(n)},u=()=>{c([])},j=()=>{if(s.length===0){console.error("No hay datos para descargar");return}if(t.length===0){console.error("Debe seleccionar al menos un campo");return}const g=s.map(b=>{const m={};return t.forEach(f=>{m[f]=b[f]}),m}),N=de.json_to_sheet(g),d=de.book_new();de.book_append_sheet(d,N,"Datos Seleccionados"),Le(d,"Datos_Seleccionados.xlsx")};return a.useEffect(()=>{o()},[]),e.jsxs("div",{className:"container-lg mt-5 mt-sm-5 mt-md-0 mt-lg-0",children:[e.jsxs("h2",{className:"text-center mb-4",children:["Exportar Datos de Art. 10 Bis ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"text-center mb-5",children:"Selecciona los campos que deseas incluir en la exportación. "}),i?e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm text-primary mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-primary mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-primary mx-2",role:"status"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-center mb-4",children:[e.jsx("button",{className:"btn btn-outline-green me-2",onClick:h,children:"Seleccionar Todos"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:u,children:"Limpiar Selección"})]}),e.jsx("form",{className:"mb-4",children:e.jsx("div",{className:"row border border-3 border-dark p-4 shadow rounded-4",children:n.map(g=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",style:{display:"flex",alignItems:"center"},children:e.jsxs("div",{className:"form-check w-100",children:[e.jsx("input",{type:"checkbox",className:"form-check-input bg-green",id:g,value:g,onChange:()=>x(g),checked:t.includes(g)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:g,children:g})]})},g))})}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn btn-green text-white fw-semibold",onClick:j,children:["Descargar Datos Seleccionados ",e.jsx("i",{className:"bi bi-filetype-xml"})]})})]})]})},li=(s,r)=>{const t=parseInt(s.replace("#",""),16),c=Math.max((t>>16)-r,0),i=Math.max((t>>8&255)-r,0),l=Math.max((t&255)-r,0);return`#${(c<<16|i<<8|l).toString(16).padStart(6,"0")}`},ni=({chartType:s,onChange:r})=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text bg-primary text-white",id:"inputGroup-sizing-sm",children:"Tipo de gráfico:"}),e.jsxs("select",{className:"form-select text-center border border-primary",onChange:r,value:s,children:[e.jsx("option",{value:"bar",children:"Barra"}),e.jsx("option",{value:"line",children:"Línea"}),e.jsx("option",{value:"pie",children:"Pastel"}),e.jsx("option",{value:"doughnut",children:"Doughnut"})]})]}),oi=({agrupacion:s,onChange:r})=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsxs("span",{className:"input-group-text bg-secondaryMuiRed text-white",children:[e.jsx("i",{className:"bi bi-diagram-3-fill me-1"})," Agrupar por"]}),e.jsxs("select",{className:"form-select text-center border border-secondaryMuiRed",value:s,onChange:r,children:[e.jsx("option",{value:"comisaria",children:"Comisaría"}),e.jsx("option",{value:"unidad",children:"Unidad"})]})]}),ci=({coleccionesSeleccionadas:s,onChange:r})=>{const t=["db_art_diez_bis","db_art_diez_bis_desactivados"],c=n=>{const o=s.includes(n);o&&s.length===1||r(o?s.filter(x=>x!==n):[...s,n])},i=n=>n==="db_art_diez_bis"?"Activos":"Históricos",l=n=>n==="db_art_diez_bis"?"bi-person-fill-check":"bi-person-fill-slash";return e.jsx("div",{className:"d-flex justify-content-center gap-3 flex-wrap my-3",children:t.map(n=>{const o=s.includes(n);return e.jsxs("button",{type:"button",className:`btn d-flex align-items-center gap-2 px-4 py-1 rounded-3 shadow-sm fw-semibold ${o?"btn-primary2 text-white":"btn-outline-primary2"}`,onClick:()=>c(n),children:[e.jsx("i",{className:`bi ${l(n)} fs-5`}),i(n)]},n)})})},di=({chartType:s,data:r,options:t})=>{switch(s){case"line":return e.jsx(Oe,{data:r,options:t});case"pie":return e.jsx(ns,{data:r,options:t});case"doughnut":return e.jsx(os,{data:r,options:t});case"bar":default:return e.jsx(ls,{data:r,options:t})}},mi=(s,r)=>{const[t,c]=a.useState({}),[i,l]=a.useState(!0),[n,o]=a.useState(null);return a.useEffect(()=>{const x=async()=>{try{const h={};for(const u of r)(await X(Y(A,u))).forEach(g=>{const N=g.data()[s];N&&(h[N]=(h[N]||0)+1)});c(h)}catch(h){o(h),console.error("Error fetching data:",h)}finally{l(!1)}};r.length>0?(l(!0),x()):(c({}),l(!1))},[s,r]),{data:t,loading:i,error:n}},ui=()=>{const[s,r]=a.useState("bar"),[t,c]=a.useState("comisaria"),[i,l]=a.useState(["db_art_diez_bis","db_art_diez_bis_desactivados"]),{data:n,loading:o,error:x}=mi(t,i);if(o)return e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm text-primary mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-primary mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-primary mx-2",role:"status"})]});if(x)return e.jsx("p",{className:"alert alert-danger text-center",children:"Error cargando datos."});if(!n)return null;const h=Object.values(n).reduce((m,f)=>m+f,0),j=[" #1de9b6"," #ffca28"," #f73378"," #16B1FF"," #7e57c2"," #e353d3"," #c7f7d4"," #ffef62"," #05F2D4"].slice(0,9),g=Object.keys(n),N=Object.values(n),d={labels:g,datasets:[{label:`Total por ${t[0].toUpperCase()+t.slice(1)} (${h})`,data:N,backgroundColor:j,borderColor:j.map(m=>li(m,40)),borderWidth:1}]},b={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:`Total de Casos por ${t[0].toUpperCase()+t.slice(1)}`}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}},x:{beginAtZero:!0}}};return e.jsxs("div",{className:"container-lg mt-5 mt-sm-5 mt-md-0 ms-lg-0",children:[e.jsx("h2",{className:"text-center mb-4 bg-primary2 p-1 text-white rounded-3",children:"Estadísticas / Gráficos"}),e.jsxs("div",{className:"row justify-content-center mb-3",children:[e.jsx("div",{className:"col-12 col-md-5 mb-2",children:e.jsx(ni,{chartType:s,onChange:m=>r(m.target.value)})}),e.jsx("div",{className:"col-12 col-md-5 mb-2",children:e.jsx(oi,{agrupacion:t,onChange:m=>c(m.target.value)})}),e.jsx("div",{className:"col-12 col-md-10",children:e.jsx(ci,{coleccionesSeleccionadas:i,onChange:l})})]}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10",style:{height:"400px"},children:e.jsx(di,{chartType:s,data:d,options:b})})})]})},ra=()=>{const[s,r]=a.useState([]),[t,c]=a.useState({totalDocumentos:0,personalEntrega:{},promedioTiempo:null,documentosPorComisaria:{},unidades:[],comisarias:[],salidasArtUsuarioMap:[]});a.useEffect(()=>{(async()=>{const o=(await X(Y(A,"db_art_diez_bis_desactivados"))).docs.map(x=>x.data());r(o),i(o)})()},[]);const i=l=>{const n={},o={},x={},h={};let u=0,j=0;l.forEach(m=>{if(m.personal_entrega.forEach(f=>{const C=f.nombre.split(" ")[0],v=`${f.ni} - ${C}`;n[v]=(n[v]||0)+1}),o[m.comisaria]=(o[m.comisaria]||0)+1,m.unidad&&(x[m.unidad]=(x[m.unidad]||0)+1),m.salida_art_usuario&&(h[m.salida_art_usuario]=(h[m.salida_art_usuario]||0)+1),m.fecha_ingreso_validado&&m.salida_art){const f=m.fecha_ingreso_validado.toDate(),C=m.salida_art.toDate();!isNaN(f)&&!isNaN(C)?(u+=(C-f)/(1e3*60*60),j++):console.warn("Fecha inválida: ",m.fecha_ingreso_validado,m.salida_art)}});const g=Object.entries(x).map(([m,f])=>({unidad:m,cantidad:f})).sort((m,f)=>f.cantidad-m.cantidad),N=Object.entries(o).map(([m,f])=>({comisaria:m,cantidad:f})).sort((m,f)=>f.cantidad-m.cantidad),d=Object.entries(n).map(([m,f])=>({key:m,value:f})).sort((m,f)=>f.value-m.value),b=Object.entries(h).map(([m,f])=>({usuario:m,cantidad:f})).sort((m,f)=>f.cantidad-m.cantidad);c({totalDocumentos:l.length,personalEntrega:d,promedioTiempo:j>0?(u/j).toFixed(2):null,documentosPorComisaria:o,unidades:g,comisarias:N,salidasArtUsuarioMap:b})};return e.jsxs("div",{className:"container ",children:[e.jsxs("h3",{className:"text-center mb-4 bg-secondaryM text-white rounded p-2 ",children:["Estadísticas Art. 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-bar-chart-fill"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-4 shadow-sm mt-2",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2  ",children:"Total Art 10 Bis"}),e.jsxs("p",{className:"card-text fs-3",children:["    ",e.jsx("i",{className:"bi bi-clipboard-data mx-3",style:{fontSize:"1.5rem",color:"#007bff"}})," ",t.totalDocumentos," Total "]})]})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-4 shadow-sm mt-2",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2 ",children:"Promedio Salida"}),e.jsx("i",{className:"bi bi-clock mx-3",style:{fontSize:"1.5rem",color:"#007bff"}}),e.jsxs("span",{className:"card-text fs-3",children:[t.promedioTiempo!==null?t.promedioTiempo:"N/A"," Horas"]})]})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-4 shadow-sm mt-2",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:"Comisarías"}),e.jsx("ul",{className:"list-unstyled mb-0 text-center",children:Object.entries(t.documentosPorComisaria).map(([l,n])=>e.jsxs("li",{children:[l,": ",n]},l))}),e.jsx("hr",{}),e.jsxs("div",{className:"text-center",children:[e.jsx("strong",{children:"Total Art. por  Comisarías: "}),Object.values(t.documentosPorComisaria).reduce((l,n)=>l+n,0)]})]})})})]}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento en Personal Entrega ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Posición"}),e.jsx("th",{scope:"col",children:"Personal Entrega"}),e.jsx("th",{scope:"col",children:"Procedimientos"}),e.jsx("th",{scope:"col",children:"Distinción"})]})}),e.jsx("tbody",{children:t.personalEntrega.length>0?t.personalEntrega.map(({key:l,value:n},o)=>e.jsxs("tr",{className:o===0?"table-warning":"",children:[e.jsx("td",{children:o===0?"👑 1":o===1?"🥈 2":o===2?"🥉 3":o+1}),e.jsx("td",{children:l}),e.jsxs("td",{children:[n," Procedimientos"]}),e.jsx("td",{children:o===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):o===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):o===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},l)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No hay datos disponibles"})})})]})]})}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento Unidades ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Unidad"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Distinción"})]})}),e.jsx("tbody",{children:t.unidades.length>0?t.unidades.map(({unidad:l,cantidad:n},o)=>e.jsxs("tr",{className:o===0?"table-warning":"",children:[e.jsxs("td",{children:[o===0?"👑 1":o===1?"🥈 2":o===2?"🥉 3":o+1," ",l]}),e.jsx("td",{children:n}),e.jsx("td",{children:o===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):o===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):o===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},l)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center",children:"No hay datos disponibles"})})})]})]})}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento Comisarías ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Comisaría"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Distinción"})]})}),e.jsx("tbody",{children:t.comisarias.length>0?t.comisarias.map(({comisaria:l,cantidad:n},o)=>e.jsxs("tr",{className:o===0?"table-warning":"",children:[e.jsxs("td",{children:[o===0?"👑 1":o===1?"🥈 2":o===2?"🥉 3":o+1," ",l]}),e.jsx("td",{children:n}),e.jsx("td",{children:o===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):o===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):o===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},l)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center",children:"No hay datos disponibles"})})})]})]})}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento Salida Art Usuario ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Usuario"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Distinción"})]})}),e.jsx("tbody",{children:t.salidasArtUsuarioMap.length>0?t.salidasArtUsuarioMap.map(({usuario:l,cantidad:n},o)=>e.jsxs("tr",{className:o===0?"table-warning":"",children:[e.jsxs("td",{children:[o===0?"👑 1":o===1?"🥈 2":o===2?"🥉 3":o+1," ",l]}),e.jsx("td",{children:n}),e.jsx("td",{children:o===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):o===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):o===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},l)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center",children:"No hay datos disponibles"})})})]})]})})]})};Xe.register(as,ts,is,rs,Ke,es,ss);const la=({personas:s,visible:r,setVisible:t})=>{const c=a.useMemo(()=>{const l={};s.forEach(x=>{var u,j;const h=(j=(u=x.fecha_ingreso_validado)==null?void 0:u.toDate)==null?void 0:j.call(u);if(h){const g=h.getDate().toString().padStart(2,"0"),N=(h.getMonth()+1).toString().padStart(2,"0"),d=h.getFullYear(),b=`${g}-${N}-${d}`;l[b]=(l[b]||0)+1}});const n=Object.keys(l).sort(),o=n.map(x=>l[x]);return{labels:n,datasets:[{label:"Ingresos por día",data:o,fill:!1,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgb(75, 192, 192)",tension:.2}]}},[s]),i={responsive:!0,plugins:{legend:{position:"top"},title:{display:!1},datalabels:{anchor:"end",align:"top",color:"#000",font:{weight:"bold"},formatter:l=>l}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto m",onClick:()=>t(!r)})}),e.jsx("div",{className:"card shadow-sm  mt-1",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center",children:"📆 Ingresos en el tiempo"}),e.jsx(Oe,{data:c,options:i})]})})]})},na=({personas:s,seleccionadas:r=[],visible:t,setVisible:c})=>{const i=a.useMemo(()=>{const l=s.length,n=r.length,o={},x={};return s.forEach(h=>{const u=h.unidad||"Sin unidad",j=h.comisaria||"Sin comisaría";o[u]=(o[u]||0)+1,x[j]=(x[j]||0)+1}),{total:l,totalSeleccionadas:n,porUnidad:o,porComisaria:x}},[s,r]);return e.jsx("div",{className:"mb-4",children:t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>c(!t)})}),e.jsxs("div",{className:"row row-cols-1 row-cols-md-4 g-3 ",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",backgroundColor:"rgba(13, 110, 253, 0.1)"},children:e.jsx("i",{className:"bi bi-people fs-3 text-primary"})}),e.jsx("h6",{className:"card-title text-muted mb-1",children:"Total registros"}),e.jsx("span",{className:"badge bg-primary fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.total})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#0d6efd",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",backgroundColor:"rgba(13, 110, 253, 0.1)"},children:e.jsx("i",{className:"bi bi-check-circle fs-3 text-secondaryM"})}),e.jsx("h6",{className:"card-title text-muted mb-1",children:"Seleccionados"}),e.jsx("span",{className:"badge bg-secondaryM fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.totalSeleccionadas})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#03dac6",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-car-front text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Unidades"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porUnidad).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:l}),e.jsx("span",{className:"badge bg-primary mb-2",children:n})]},l))})]})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Comisarías"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porComisaria).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:l}),e.jsx("span",{className:"badge bg-secondary mb-2",children:n})]},l))})]})})})]})]})})},oa=({searchTerm:s,setSearchTerm:r,orden:t,setOrden:c,prioridadFilter:i,setPrioridadFilter:l,comisariaFilter:n,setComisariaFilter:o,fechaInicio:x,setFechaInicio:h,fechaFin:u,setFechaFin:j,personas:g=[],visible:N,setVisible:d})=>{const b=[...new Set(g.map(v=>v.unidad))],m=[...new Set(g.map(v=>v.comisaria))],f=s||t!=="asc"||i||n||x||u,C=()=>{r(""),c("asc"),l(""),o(""),h(""),j("")};return N&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-5",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto",onClick:()=>d(!N)})}),e.jsxs("div",{className:"card shadow-sm border-0 mt-2",children:[e.jsx("div",{className:"card-header text-center bg-primary text-white p-1 rounded-2 mx-3",children:e.jsxs("h5",{className:"mb-0",children:[e.jsx("i",{className:"bi bi-funnel-fill me-2"}),"Filtros"]})}),e.jsxs("div",{className:"card-body px-4",children:[e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-secondary",children:"Buscar por Nombre"}),e.jsx("input",{type:"text",className:"form-control",value:s,onChange:v=>r(v.target.value),placeholder:"Ej: Juan Pérez"})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label fw-semibold small text-secondary",children:"Orden"}),e.jsxs("select",{className:"form-select",value:t,onChange:v=>c(v.target.value),children:[e.jsx("option",{value:"asc",children:"Ascendente (A-Z)"}),e.jsx("option",{value:"desc",children:"Descendente (Z-A)"})]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-secondary",children:"Unidad"}),e.jsxs("select",{className:"form-select",value:i,onChange:v=>l(v.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),b.map(v=>e.jsx("option",{value:v,children:v},v))]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-secondary",children:"Comisaría"}),e.jsxs("select",{className:"form-select",value:n,onChange:v=>o(v.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),m.map(v=>e.jsx("option",{value:v,children:v},v))]})]}),e.jsxs("div",{className:"col-md-6 mt-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-secondary",children:"Rango de fechas (Ingreso)"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"date",className:"form-control",value:x,onChange:v=>h(v.target.value)}),e.jsx("span",{className:"input-group-text",children:"a"}),e.jsx("input",{type:"date",className:"form-control",value:u,onChange:v=>j(v.target.value)})]})]})]}),f&&e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{className:"btn btn-danger text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"45px",height:"45px",boxShadow:"0 0.5rem 1rem rgba(0,0,0,0.15)"},onClick:C,title:"Restaurar filtros",children:e.jsx("i",{className:"bi bi-trash"})})})]})]})," "]})},ca=({columnasVisibles:s,setColumnasVisibles:r,visible:t,setVisible:c})=>t&&e.jsxs("div",{className:"my-4",children:[e.jsx("div",{className:"d-flex justify-content-end mt-1 mb-2",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto",onClick:()=>c(!t)})}),e.jsx("div",{className:"card shadow-sm border-0 m",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-3 text-center bg-primary text-white p-1 rounded-2",children:[e.jsx("i",{className:"bi bi-sliders me-2"}),"Mostrar / Ocultar columnas"]}),e.jsx("div",{className:"row",children:Object.entries(s).map(([i,l])=>e.jsx("div",{className:"col-6 col-md-4 mb-2",children:e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:`columna-${i}`,checked:l,onChange:()=>r(n=>({...n,[i]:!n[i]}))}),e.jsx("label",{className:"form-check-label",htmlFor:`columna-${i}`,children:i==="usuarioSalida"?"Usuario salida":i.charAt(0).toUpperCase()+i.slice(1)})]})},i))})]})})]}),da=({filteredPersonas:s,selectedDocs:r,toggleSelectAll:t,toggleSelectDoc:c,columnasVisibles:i})=>{const[l,n]=a.useState(!0);return e.jsx(e.Fragment,{children:s.length===0?e.jsx("div",{className:"alert alert-light text-danger shadow text-center titilar mt-3",children:"Sin registro encontrado."}):e.jsx("div",{className:"table-responsive-sm d-none d-sm-block my-4",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsxs("div",{className:"card-header bg-primary text-white px-3 p-1 d-flex justify-content-between align-items-center rounded-2 mx-2 mt-2",children:[e.jsx("div",{style:{width:"32px"}}),e.jsxs("h5",{className:"mb-0 text-center flex-grow-1",children:[e.jsx("i",{className:"bi bi-view-list me-2"}),"Tabla"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-light",onClick:()=>n(!l),children:[e.jsx("i",{className:`bi ${l?"bi-arrows-collapse":"bi-arrows-expand"} me-1`}),l?"Contraer":"Expandir"]})]}),l&&e.jsx("div",{className:"px-3 pb-3",children:e.jsxs("table",{className:"table table-striped table-hover text-center small mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:r.length===s.length,onChange:t})}),e.jsx("th",{children:"Nombre"}),i.unidad&&e.jsx("th",{children:"Unidad"}),i.dni&&e.jsx("th",{children:"Documento"}),i.comisaria&&e.jsx("th",{children:"Comisaría"}),i.ingreso&&e.jsx("th",{children:"F Ingreso"}),i.salida&&e.jsx("th",{children:"F Salida"}),i.usuarioSalida&&e.jsx("th",{children:"Salida"})]})}),e.jsx("tbody",{children:s.map(o=>{var x,h,u;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:r.includes(o.id),onChange:()=>c(o.id)})}),e.jsx("td",{className:"text-center",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"rounded-circle bg-primary text-white d-flex justify-content-center align-items-center",style:{width:"30px",height:"30px",fontSize:"0.9rem"},children:((x=o.unidad)==null?void 0:x.charAt(0).toUpperCase())||"?"}),e.jsx("span",{role:"button",onClick:()=>{var f,C,v;const j=((f=o.personal_entrega)==null?void 0:f.map(w=>`${w.nombre} (NI: ${w.ni})
🏢 Unidad: ${o.unidad||"No informada"}`).join(`

`))||"Sin datos",g=((C=o.fecha_ingreso_validado)==null?void 0:C.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"}))||"Sin fecha",N=((v=o.salida_art)==null?void 0:v.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"}))||"Sin fecha",d=o.usuario_validado_ingreso||"Desconocido",b=o.comisaria||"No informada",m=o.salida_art_usuario||"No informada";alert(`👤 Personal que entregó:
${j}

🏢 Comisaría: ${b}
📅 Fecha validación: ${g}
👮 Usuario que validó: ${d}
📅 Fecha salida: ${N}
👮 Usuario que validó salida: ${m}`)},className:"text-decoration-none",children:o.nombre_apellido})]})}),i.unidad&&e.jsx("td",{children:e.jsx("span",{className:"badge bg-primary",children:o.unidad})}),i.dni&&e.jsx("td",{children:o.dni}),i.comisaria&&e.jsx("td",{children:e.jsxs("div",{className:"d-flex flex-column align-items-center gap-1",children:[e.jsx("span",{className:"badge bg-pink",children:o.comisaria}),o.comisaria_recibe===!1&&e.jsx("span",{className:"badge bg-secondaryM titilar",children:"Pendiente Validar"})]})}),i.ingreso&&e.jsx("td",{children:(h=o.fecha_ingreso_validado)==null?void 0:h.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"medium",timeZone:"America/Argentina/Buenos_Aires"})}),i.salida&&e.jsx("td",{children:(u=o.salida_art)==null?void 0:u.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"medium",timeZone:"America/Argentina/Buenos_Aires"})}),i.usuarioSalida&&e.jsx("td",{children:e.jsx("span",{className:"badge bg-teal",children:o.salida_art_usuario})})]},o.id)})})]})})]})})})},hi=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState("asc"),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!1),[p,y]=a.useState(!1),[S,F]=a.useState(!1),[_,k]=a.useState(!1),M=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotales"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"tabla",componente:"TablaDatos"}],[$,U]=a.useState(M),[Q,H]=a.useState(null),[V,ie]=a.useState({unidad:!0,dni:!0,comisaria:!0,ingreso:!1,salida:!1,usuarioSalida:!1}),oe=Y(A,"db_art_diez_bis_desactivados"),J=async()=>{o(!0);try{const P=(await X(oe)).docs.map(T=>({...T.data(),id:T.id}));r(P),c(P)}catch(I){console.error("Error al obtener personas: ",I)}finally{o(!1)}},Z=I=>I.sort((P,T)=>g==="asc"?P.nombre_apellido.localeCompare(T.nombre_apellido):T.nombre_apellido.localeCompare(P.nombre_apellido)),L=I=>{H(I)},G=I=>{I.preventDefault()},se=I=>{const P=[...$],T=P.findIndex(E=>E.id===Q),z=P.findIndex(E=>E.id===I),[B]=P.splice(T,1);P.splice(z,0,B),U(P)};a.useEffect(()=>{J()},[]),a.useEffect(()=>{const I=s.filter(P=>P.nombre_apellido&&P.nombre_apellido.toLowerCase().includes(x.toLowerCase())).filter(P=>u?P.unidad===u:!0).filter(P=>d?P.comisaria===d:!0).filter(P=>{var E;if(!m&&!C)return!0;const T=(E=P.fecha_ingreso_validado)==null?void 0:E.toDate();if(!T)return!1;const z=m?new Date(m):null,B=C?new Date(C):null;return!(z&&T<z||B&&T>B)});c(Z(I))},[x,u,d,m,C,g,s]);const ae=I=>{l(P=>P.includes(I)?P.filter(T=>T!==I):[...P,I])},re=()=>{if(i.length===t.length)l([]);else{const I=t.map(P=>P.id);l(I)}},ue=()=>{const I=s.filter(B=>i.includes(B.id));if(I.length===0){alert("No hay personas seleccionadas para exportar.");return}const P=I.map(B=>{var E,R;return{Nombre:B.nombre_apellido,Documento:B.dni,Unidad:B.unidad,Comisaría:B.comisaria,"Fecha Ingreso":(E=B.fecha_ingreso_validado)==null?void 0:E.toDate().toLocaleString("es-AR"),"Fecha Salida":(R=B.salida_art)==null?void 0:R.toDate().toLocaleString("es-AR"),"Usuario Salida":B.salida_art_usuario}}),T=de.json_to_sheet(P),z=de.book_new();de.book_append_sheet(z,T,"Seleccionados"),Le(z,"personas_seleccionadas.xlsx")};return e.jsxs("div",{className:"container-lg mt-0 mt-5 mt-sm-5 mt-md-0 ms-lg-0 ",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado de Art. 10 Bis Historicos"})}),e.jsxs("div",{className:"container mb-4",children:[e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${p?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>y(!p),children:[e.jsx("i",{className:`bi ${p?"bi-eye-slash":"bi-eye"} me-1`}),p?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${S?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>F(!S),children:[e.jsx("i",{className:`bi ${S?"bi-eye-slash":"bi-eye"} me-1`}),S?"Ocultar filtro":"Ver filtro"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${_?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>k(!_),children:[e.jsx("i",{className:`bi ${_?"bi-eye-slash":"bi-eye"} me-1`}),_?"Ocultar columnas":"Ver columnas"]})})]}),e.jsxs("div",{className:"row my-3 row g-2 align-items-center justify-content-center",children:["  ",e.jsx("div",{className:"col-12 col-md-auto",children:e.jsxs("button",{className:"btn btn-green w-100",onClick:ue,disabled:i.length===0,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-2"}),"Exportar seleccionados a Excel"]})}),e.jsx("div",{className:"col-12 col-md-auto",children:e.jsx("button",{className:"btn btn-primary w-100",onClick:()=>D(!w),children:w?"Cerrar gráfico 📉":" Gráfico Fechas 📈"})})]})]}),n?e.jsx(ne,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-sm-none",children:t.map(I=>{var P,T;return e.jsx("div",{className:"card mb-3 shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:I.nombre_apellido}),e.jsx("input",{type:"checkbox",checked:i.includes(I.id),onChange:()=>ae(I.id)})]}),V.unidad&&e.jsx("div",{children:e.jsx("span",{className:"badge bg-primary",children:I.unidad})}),V.dni&&e.jsxs("div",{children:["DNI: ",I.dni]}),V.comisaria&&e.jsxs("div",{children:["Comisaría: ",e.jsx("span",{className:"badge bg-pink",children:I.comisaria})]}),V.ingreso&&e.jsxs("div",{children:["Ingreso: ",(P=I.fecha_ingreso_validado)==null?void 0:P.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.salida&&e.jsxs("div",{children:["Salida: ",(T=I.salida_art)==null?void 0:T.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.usuarioSalida&&e.jsxs("div",{children:["Usuario salida: ",e.jsx("span",{className:"badge bg-teal",children:I.salida_art_usuario})]})]})},I.id)})}),$.map(({id:I,componente:P})=>e.jsxs("div",{draggable:!0,onDragStart:()=>L(I),onDragOver:G,onDrop:()=>se(I),className:"my-3 ",children:[P==="ColumnasVisiblesPanel"&&e.jsx(ca,{columnasVisibles:V,setColumnasVisibles:ie,visible:_,setVisible:k}),P==="ResumenTotales"&&e.jsx(na,{personas:t,seleccionadas:i,visible:p,setVisible:y}),P==="FiltrosPanel"&&e.jsx(oa,{searchTerm:x,setSearchTerm:h,orden:g,setOrden:N,prioridadFilter:u,setPrioridadFilter:j,comisariaFilter:d,setComisariaFilter:b,fechaInicio:m,setFechaInicio:f,fechaFin:C,setFechaFin:v,personas:s,visible:S,setVisible:F}),P==="GraficoPorFechaIngreso"&&w&&e.jsx(la,{personas:t,visible:w,setVisible:D}),P==="TablaDatos"&&e.jsx(da,{filteredPersonas:t,selectedDocs:i,toggleSelectAll:re,toggleSelectDoc:ae,columnasVisibles:V})]},I))]})]})},xi=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState("asc"),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!1),[p,y]=a.useState(!1),[S,F]=a.useState(!1),[_,k]=a.useState(!1),M=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotales"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"tabla",componente:"TablaDatos"}],[$,U]=a.useState(M),[Q,H]=a.useState(null),[V,ie]=a.useState({unidad:!0,dni:!0,comisaria:!0,ingreso:!1,salida:!1,usuarioSalida:!1}),oe=Y(A,"db_art_diez_bis"),J=async()=>{o(!0);try{const P=(await X(oe)).docs.map(T=>({...T.data(),id:T.id}));r(P),c(P)}catch(I){console.error("Error al obtener personas: ",I)}finally{o(!1)}},Z=I=>I.sort((P,T)=>g==="asc"?P.nombre_apellido.localeCompare(T.nombre_apellido):T.nombre_apellido.localeCompare(P.nombre_apellido)),L=I=>{H(I)},G=I=>{I.preventDefault()},se=I=>{const P=[...$],T=P.findIndex(E=>E.id===Q),z=P.findIndex(E=>E.id===I),[B]=P.splice(T,1);P.splice(z,0,B),U(P)};a.useEffect(()=>{J()},[]),a.useEffect(()=>{const I=s.filter(P=>P.nombre_apellido&&P.nombre_apellido.toLowerCase().includes(x.toLowerCase())).filter(P=>u?P.unidad===u:!0).filter(P=>d?P.comisaria===d:!0).filter(P=>{var E;if(!m&&!C)return!0;const T=(E=P.fecha_ingreso_validado)==null?void 0:E.toDate();if(!T)return!1;const z=m?new Date(m):null,B=C?new Date(C):null;return!(z&&T<z||B&&T>B)});c(Z(I))},[x,u,d,m,C,g,s]);const ae=I=>{l(P=>P.includes(I)?P.filter(T=>T!==I):[...P,I])},re=()=>{if(i.length===t.length)l([]);else{const I=t.map(P=>P.id);l(I)}},ue=()=>{const I=s.filter(B=>i.includes(B.id));if(I.length===0){alert("No hay personas seleccionadas para exportar.");return}const P=I.map(B=>{var E,R;return{Nombre:B.nombre_apellido,Documento:B.dni,Unidad:B.unidad,Comisaría:B.comisaria,"Fecha Ingreso":(E=B.fecha_ingreso_validado)==null?void 0:E.toDate().toLocaleString("es-AR"),"Fecha Salida":(R=B.salida_art)==null?void 0:R.toDate().toLocaleString("es-AR"),"Usuario Salida":B.salida_art_usuario}}),T=de.json_to_sheet(P),z=de.book_new();de.book_append_sheet(z,T,"Seleccionados"),Le(z,"personas_seleccionadas.xlsx")};return e.jsxs("div",{className:"container-lg mt-5 mt-sm-5 mt-md-0 ms-lg-0 ",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado de Art. 10 Bis Activos"})}),e.jsxs("div",{className:"container mb-4",children:[e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${p?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>y(!p),children:[e.jsx("i",{className:`bi ${p?"bi-eye-slash":"bi-eye"} me-1`}),p?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${S?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>F(!S),children:[e.jsx("i",{className:`bi ${S?"bi-eye-slash":"bi-eye"} me-1`}),S?"Ocultar filtro":"Ver filtro"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${_?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>k(!_),children:[e.jsx("i",{className:`bi ${_?"bi-eye-slash":"bi-eye"} me-1`}),_?"Ocultar columnas":"Ver columnas"]})})]}),e.jsxs("div",{className:"row my-3 row g-2 align-items-center justify-content-center",children:["  ",e.jsx("div",{className:"col-12 col-md-auto",children:e.jsxs("button",{className:"btn btn-green w-100",onClick:ue,disabled:i.length===0,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-2"}),"Exportar seleccionados a Excel"]})}),e.jsx("div",{className:"col-12 col-md-auto",children:e.jsx("button",{className:"btn btn-primary w-100",onClick:()=>D(!w),children:w?"Cerrar gráfico 📉":" Gráfico Fechas 📈"})})]})]}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-sm-none",children:t.map(I=>{var P,T;return e.jsx("div",{className:"card mb-3 shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:I.nombre_apellido}),e.jsx("input",{type:"checkbox",checked:i.includes(I.id),onChange:()=>ae(I.id)})]}),V.unidad&&e.jsx("div",{children:e.jsx("span",{className:"badge bg-primary",children:I.unidad})}),V.dni&&e.jsxs("div",{children:["DNI: ",I.dni]}),V.comisaria&&e.jsxs("div",{children:["Comisaría: ",e.jsx("span",{className:"badge bg-pink",children:I.comisaria})]}),V.ingreso&&e.jsxs("div",{children:["Ingreso: ",(P=I.fecha_ingreso_validado)==null?void 0:P.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.salida&&e.jsxs("div",{children:["Salida: ",(T=I.salida_art)==null?void 0:T.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.usuarioSalida&&e.jsxs("div",{children:["Usuario salida: ",e.jsx("span",{className:"badge bg-teal",children:I.salida_art_usuario})]})]})},I.id)})}),$.map(({id:I,componente:P})=>e.jsxs("div",{draggable:!0,onDragStart:()=>L(I),onDragOver:G,onDrop:()=>se(I),className:"my-3 ",children:[P==="ColumnasVisiblesPanel"&&e.jsx(ca,{columnasVisibles:V,setColumnasVisibles:ie,visible:_,setVisible:k}),P==="ResumenTotales"&&e.jsx(na,{personas:t,seleccionadas:i,visible:p,setVisible:y}),P==="FiltrosPanel"&&e.jsx(oa,{searchTerm:x,setSearchTerm:h,orden:g,setOrden:N,prioridadFilter:u,setPrioridadFilter:j,comisariaFilter:d,setComisariaFilter:b,fechaInicio:m,setFechaInicio:f,fechaFin:C,setFechaFin:v,personas:s,visible:S,setVisible:F}),P==="GraficoPorFechaIngreso"&&w&&e.jsx(la,{personas:t,visible:w,setVisible:D}),P==="TablaDatos"&&e.jsx(da,{filteredPersonas:t,selectedDocs:i,toggleSelectAll:re,toggleSelectDoc:ae,columnasVisibles:V})]},I))]})})]})},bi=()=>{const[s,r]=a.useState([]),[t,c]=a.useState(""),[i,l]=a.useState("plazas"),[n,o]=a.useState(!0),[x,h]=a.useState(!1),[u,j]=a.useState({comisariaNombre:"",comisariaNumero:"",disponibilidad:!0,plazas_art_10_bis:""}),[g,N]=a.useState({}),[d,b]=a.useState({comisariaNombre:!1,plazas_art_10_bis:!1}),m="1234",f=async()=>{o(!0);try{const M=(await X(Y(A,"db_comisarias"))).docs.map($=>({id:$.id,...$.data()}));r(M)}catch(k){console.error("Error al obtener las comisarías: ",k)}finally{o(!1)}};a.useEffect(()=>{f()},[]);const C=k=>{const{name:M,value:$,type:U,checked:Q}=k.target;if(!(M==="comisariaNombre"&&(!/^[A-Za-zÁÉÍÓÚÑáéíóúñ\s]*$/.test($)||$.startsWith(" ")))){if(M==="comisariaNumero"){if($===""||/^\d+$/.test($)&&Number($)<=40&&Number($)>=0){j({...u,[M]:$});return}return}if(M==="plazas_art_10_bis"){const H=parseInt($,10);$!==""&&(isNaN(H)||H<0||H>99)?b({...d,plazas_art_10_bis:!0}):b({...d,plazas_art_10_bis:!1})}j({...u,[M]:U==="checkbox"?Q:$})}},v=(k,M,$)=>{N({...g,[k]:{...g[k],[M]:M==="disponibilidad"?$==="true":$}})},w=async k=>{const{plazas_art_10_bis:M,disponibilidad:$}=g[k]||{};if(window.confirm("¿Estás seguro de que quieres guardar los cambios?"))try{const Q=W(A,"db_comisarias",k),H={};if(M!==void 0){const V=parseInt(M,10);if(isNaN(V)||V<0||V>30){alert("Por favor, ingresa un número válido de plazas entre 0 y 30.");return}H.plazas_art_10_bis=V}$!==void 0&&(H.disponibilidad=$),await le(Q,H),N(V=>{const ie={...V};return delete ie[k],ie}),f()}catch(Q){console.error("Error al actualizar comisaría: ",Q)}},p=(()=>{const k=localStorage.getItem("user");return k?JSON.parse(k):null})(),y=async k=>{k.preventDefault();const M=u.comisariaNombre.trim(),$=u.comisariaNumero.trim(),U=parseInt(u.plazas_art_10_bis,10),Q={comisariaNombre:!M,plazas_art_10_bis:isNaN(U)||U<0||U>99};if(b(Q),Object.values(Q).some(J=>J)||!window.confirm("¿Estás seguro de agregar esta comisaría?"))return;const V=$?`${M} ${parseInt($,10)}`.toLowerCase():M.toLowerCase(),ie=new Date,oe=`${ie.getDate().toString().padStart(2,"0")}/${(ie.getMonth()+1).toString().padStart(2,"0")}/${ie.getFullYear().toString().slice(-2)}`;try{await ye(Y(A,"db_comisarias"),{comisaria:V,plazas_art_10_bis:U,disponibilidad:u.disponibilidad,usuario:p.email,fecha:oe}),j({comisariaNombre:"",comisariaNumero:"",disponibilidad:!0,plazas_art_10_bis:""}),f(),alert("Comisaría agregada con éxito.")}catch(J){console.error("Error al agregar comisaría: ",J)}},S=async k=>{if(!window.confirm("¿Estás seguro de que quieres eliminar esta comisaría?"))return;if(prompt("⚠️ Para continuar, ingresá el código llave:")!==m){alert("❌ Código incorrecto. No se eliminará la comisaría.");return}try{const U=W(A,"db_comisarias",k);await xe(U),f(),alert("✅ Comisaría eliminada correctamente.")}catch(U){console.error("Error al eliminar comisaría: ",U)}},_=[...s.filter(k=>k.comisaria.toLowerCase().includes(t.toLowerCase()))].sort((k,M)=>i==="plazas"?M.plazas_art_10_bis-k.plazas_art_10_bis:i==="nombre"?k.comisaria.localeCompare(M.comisaria):i==="estado"?k.disponibilidad===M.disponibilidad?0:k.disponibilidad?-1:1:0);return e.jsxs("div",{className:"container-lg mt-0 mt-5 mt-sm-5 mt-md-0 ms-lg-0 ",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Comisarias / Plazas"}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"card shadow position-relative text-dark d-flex align-items-start gap-3  p-4 mt-3 border-0",style:{overflow:"visible"},children:[e.jsx("div",{className:"bg-red",children:e.jsx("img",{src:"img/tupel.gif",alt:"Asistente",className:"position-absolute rounded-circle shadow p-2",style:{width:"130px",height:"auto",objectFit:"contain",top:"-15px",left:"-10px"}})}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:"Bienvenido 👮‍♂️ "}),e.jsx("p",{className:"mb-3 text-capitalize m-0",children:"Puedes crear una nueva comisaría, administrando sus plazas disponibles y estado"}),e.jsx("div",{className:"d-flex justify-content-end align-items-center",children:e.jsxs("button",{className:`btn fw-semibold text-white ${x?"btn-secondaryMuiRed":"btn-primary"}`,onClick:()=>h(!x),children:[e.jsx("i",{className:"bi bi-shield-plus me-2"}),x?"Cancelar":"Nueva Comisaría"]})})]})]})}),x&&e.jsx("form",{onSubmit:y,className:"my-5",children:e.jsxs("div",{className:"row g-3 align-items-center d-flex justify-content-center",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control ${d.comisariaNombre?"is-invalid":""}`,id:"comisariaNombre",name:"comisariaNombre",value:u.comisariaNombre,onChange:C}),e.jsx("label",{htmlFor:"comisariaNombre",children:"Nombre Comisaría"}),d.comisariaNombre&&e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten letras y espacios (no al inicio)."})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"number",className:"form-control",id:"comisariaNumero",name:"comisariaNumero",value:u.comisariaNumero,onChange:C}),e.jsx("label",{htmlFor:"comisariaNumero",children:"Número Comisaría "})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"number",className:`form-control ${d.plazas_art_10_bis?"is-invalid":""}`,id:"plazas_art_10_bis",name:"plazas_art_10_bis",value:u.plazas_art_10_bis,onChange:C}),e.jsx("label",{htmlFor:"plazas_art_10_bis",children:"Plazas Art. 10 Bis"}),d.plazas_art_10_bis&&e.jsx("div",{className:"invalid-feedback",children:"Debe ingresar un número válido de plazas."})]})}),e.jsx("div",{className:"col-md-1 text-center",children:e.jsx("button",{type:"submit",className:"btn btn-primary fw-semibold rounded-circle shadow-sm",children:"+"})})]})}),e.jsxs("h3",{className:"text-center my-4 bg-primary2 text-white rounded p-2",children:["Administrar Comisarías ",e.jsx("i",{className:"ms-2 bi bi-list"})]}),e.jsx("div",{className:"container my-4",children:e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 col-md-5 mb-4 mb-md-0",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-secondaryM text-white",children:e.jsx("i",{className:"bi bi-search"})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por nombre de comisaría...",value:t,onChange:k=>c(k.target.value)})]})}),e.jsx("div",{className:"col-12 col-md-5",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{id:"sortOrder",className:"form-select shadow-sm",value:i,onChange:k=>l(k.target.value),children:[e.jsx("option",{value:"plazas",children:"Plazas"}),e.jsx("option",{value:"nombre",children:"Nombre"}),e.jsx("option",{value:"estado",children:"Estado"})]}),e.jsx("label",{htmlFor:"sortOrder",children:"Ordenar por:"})]})})]})}),n?e.jsx(ne,{}):e.jsx("ul",{className:"list-group",children:_.length===0?e.jsxs("li",{className:"list-group-item text-center text-muted ",children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-danger"}),e.jsx("span",{className:"text-danger",children:" No hay comisarías registradas."})]}):_.map(({id:k,comisaria:M,plazas_art_10_bis:$,disponibilidad:U})=>{var Q,H;return e.jsxs("li",{className:"list-group-item mb-3",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-3 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("div",{className:"spinner-grow spinner-grow-sm me-2 text-purple",role:"status"}),e.jsxs("span",{className:"badge Gradiante25 me-2 text-capitalize",children:[M,"°"]})]}),e.jsxs("div",{className:"col-12 col-md-3 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("span",{className:"badge bg-primaryMuiBlue me-2",children:"Plazas"}),e.jsx("input",{type:"number",value:((Q=g[k])==null?void 0:Q.plazas_art_10_bis)??$,onChange:V=>v(k,"plazas_art_10_bis",V.target.value),className:"form-control d-inline-block w-100",style:{maxWidth:"120px"}})]}),e.jsxs("div",{className:"col-12 col-md-4 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("span",{className:`badge ${U?"bg-teal":"bg-danger"} me-2`,children:"Estado"}),e.jsxs("select",{value:((H=g[k])==null?void 0:H.disponibilidad)??U,onChange:V=>v(k,"disponibilidad",V.target.value),className:"form-select d-inline-block w-100",children:[e.jsx("option",{value:!0,children:"Disponible 👍"}),e.jsx("option",{value:!1,children:"Llena ✋ "})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-start justify-content-md-end w-100 mt-2 mt-md-0",children:[g[k]&&e.jsx("button",{className:"btn btn-sm btn-primary me-2 rounded-circle",onClick:()=>w(k),children:e.jsx("i",{className:"bi bi-floppy2"})}),e.jsx("button",{className:"btn btn-sm btn-danger rounded-circle text-white",onClick:()=>S(k),children:e.jsx("i",{className:"bi bi-trash"})})]})]},k)})})]})},pi=({personas:s,seleccionadas:r=[],visible:t,setVisible:c})=>{a.useEffect(()=>{console.log("Selected IDs recibidos:",s,r)},[s,r]);const i=a.useMemo(()=>{var g,N;const l=s.length,n=r.length,o={},x={},h={};s.forEach(d=>{const b=d.unidad||"Sin unidad",m=d.comisaria||"Sin comisaría",f=d.salida_art_usuario||"Sin usuario";o[b]=(o[b]||0)+1,x[m]=(x[m]||0)+1,h[f]=(h[f]||0)+1});const u=((g=Object.entries(o).sort((d,b)=>b[1]-d[1])[0])==null?void 0:g[0])||null,j=((N=Object.entries(x).sort((d,b)=>b[1]-d[1])[0])==null?void 0:N[0])||null;return{total:l,totalSeleccionadas:n,porUnidad:o,porComisaria:x,topUnidad:u,topComisaria:j,salidaUsuarios:h}},[s,r]);return e.jsx("div",{className:"mb-4",children:t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>c(!t)})}),e.jsxs("div",{className:"row row-cols-1 row-cols-md-4 g-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",backgroundColor:"rgba(13, 110, 253, 0.1)"},children:e.jsx("i",{className:"bi bi-people fs-3 text-primary"})}),e.jsx("h6",{className:"card-title text-muted mb-1",children:"Total registros"}),e.jsx("span",{className:"badge bg-primary fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.total})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#0d6efd",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:e.jsx("img",{src:"img/trophy.png",alt:"Trofeo",className:"rounded-circle shadow p-4",style:{width:"150px",height:"150px",objectFit:"contain"}})}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#03dac6",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-car-front text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Unidades"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porUnidad).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:[l," ",l===i.topUnidad&&"🏆"]}),e.jsx("span",{className:"badge bg-primary mb-2",children:n})]},l))})]})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Comisarías"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porComisaria).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:[l," ",l===i.topComisaria&&"🏆"]}),e.jsx("span",{className:"badge bg-secondary mb-2",children:n})]},l))})]})})})]})]})})},gi=({personas:s,visible:r,setVisible:t})=>{const c=a.useMemo(()=>{const l={},n={};return s.forEach(o=>{const x=o.salida_art_usuario;if(x){l[x]=(l[x]||0)+1;const h=o.comisaria||"Sin comisaría";n[x]||(n[x]={}),n[x][h]=(n[x][h]||0)+1}}),{conteo:l,comisariasPorUsuario:n}},[s]),i=a.useMemo(()=>{const l=Object.entries(c.conteo);return l.length===0?null:l.sort((n,o)=>o[1]-n[1])[0][0]},[c]);return r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>t(!1)})}),e.jsx("div",{className:"card shadow-sm border-0",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-3",children:[e.jsx("i",{className:"bi bi-person-check-fill text-primary2 me-2"}),"Personal Comisaría Salida"]}),Object.keys(c.conteo).length===0?e.jsx("p",{className:"text-muted",children:"No hay registros de salida."}):e.jsx("ul",{className:"list-group list-group-flush",children:Object.entries(c.conteo).sort((l,n)=>n[1]-l[1]).map(([l,n])=>{let o="";if(l==="sistema")o="Automático DG OJO ⚠️";else{const x=c.comisariasPorUsuario[l];o=Object.entries(x).sort((h,u)=>u[1]-h[1]).map(([h,u])=>`${h} (${u})`).join(", ")}return e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-semibold",children:[l===i&&"🏆","  ",l]}),e.jsxs("div",{className:"text-muted small",children:["🏢 ",o]})]}),e.jsx("span",{className:"badge bg-primary2 rounded-pill",children:n})]},l)})})]})})]}):null},ji=({visible:s,setVisible:r})=>{const[t,c]=a.useState([]);a.useEffect(()=>{(async()=>{const x=(await X(Y(A,"db_art_diez_bis_desactivados"))).docs.map(h=>h.data());c(x)})()},[]);const i=a.useMemo(()=>{const n={};return t.forEach(o=>{Array.isArray(o.personal_entrega)&&o.personal_entrega.forEach(x=>{var g;const h=x.ni,u=((g=x.nombre)==null?void 0:g.split(" ")[0])||x.nombre,j=o.comisaria;n[h]||(n[h]={nombre:u,count:0,comisarias:{}}),n[h].count+=1,j&&(n[h].comisarias[j]=(n[h].comisarias[j]||0)+1)})}),n},[t]);if(!s)return null;const l=Object.entries(i).sort((n,o)=>o[1].count-n[1].count);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>r(!1)})}),e.jsx("div",{className:"card shadow-sm border-0",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-3",children:[e.jsx("i",{className:"bi bi-award-fill text-primaryMuiBlue me-2"}),"Personal Entregas Destacadas"]}),l.length===0?e.jsx("p",{className:"text-muted",children:"No hay registros de entrega."}):e.jsx("ul",{className:"list-group list-group-flush",children:l.map(([n,o],x)=>{const{nombre:h,count:u,comisarias:j}=o,g=t.find(m=>(m.personal_entrega||[]).some(f=>`${f.ni}`===n)),N=(g==null?void 0:g.unidad)||"OTROS";let d="",b="bg-primaryMuiBlue";return x===0?(d="👑",b="bg-yellowMui"):x===1?(d="🥈",b="bg-yellowMui"):x===2&&(d="🥉",b="bg-yellowMui"),e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-semibold",children:[d," ",h," - ",n]}),e.jsxs("div",{className:"text-muted small",children:[N.toUpperCase().includes("MOTORIZADA")?"🏍️":"🚓"," ",N]})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("span",{className:`badge ${b} rounded-pill`,children:u}),e.jsxs("div",{className:"mt-2 text-muted small text-start",children:[e.jsx("strong",{children:"📍 Comisarías:"}),e.jsx("ul",{className:"mb-0 ps-3",children:Object.entries(j).map(([m,f])=>e.jsxs("li",{children:[m,": ",f," ",f===1?"vez":"veces"]},m))})]})]})]},`${n}-${x}`)})})]})})]})},fi=({personas:s})=>{const[r,t]=a.useState(null);return a.useEffect(()=>{let c=0,i=0;if(s.forEach(l=>{var x,h;const n=(x=l.fecha_ingreso_validado)==null?void 0:x.toDate(),o=(h=l.salida_art)==null?void 0:h.toDate();if(n&&o&&!isNaN(n)&&!isNaN(o)){const u=o-n;u>=0&&(c+=u,i++)}}),i>0){const l=c/i,n=Math.floor(l/(1e3*60*60)),o=Math.floor(l%(1e3*60*60)/(1e3*60)),x=Math.floor(l%(1e3*60)/1e3);t({horas:n,minutos:o,segundos:x})}else t(null)},[s]),e.jsx("div",{className:"card shadow my-5 border-0",children:e.jsxs("div",{className:"card-body ",children:[e.jsx("h5",{className:"card-title bg-primary 2 p-2 text-white rounded-3",children:"⏱️ Tiempo Promedio entre Ingreso y Salida"}),r?e.jsx("div",{className:" d-flex justify-content-end align-items-end",children:e.jsxs("p",{className:"mb-0 fs-5 me-3 ",children:[e.jsxs("strong",{children:[r.horas,"h ",r.minutos,"m ",r.segundos,"s"]})," ",e.jsx("span",{className:"titilar",children:" ⏳ "})]})}):e.jsx("p",{className:"text-muted mb-0 ",children:"No hay datos válidos para calcular."})]})})},Ni=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState("asc"),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!0),[p,y]=a.useState(!0),[S,F]=a.useState(!0),_=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotalesRendimiento"},{id:"personalEntregaCard",componente:"PersonalEntregaCard"},{id:"personalSalidaCard",componente:"PersonalSalidaCard"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"card",componente:"CardInfo"},{id:"cardComisaria",componente:"ComisariaCardInfo"},{id:"tablaRendimiento",componente:"TablaDatosRendimiento"}],[k,M]=a.useState(_),[$,U]=a.useState(null);console.log(k);const Q=Y(A,"db_art_diez_bis_desactivados"),H=async()=>{o(!0);try{const L=(await X(Q)).docs.map(G=>({...G.data(),id:G.id}));r(L),c(L)}catch(Z){console.error("Error al obtener personas: ",Z)}finally{o(!1)}},V=Z=>Z.sort((L,G)=>g==="asc"?L.nombre_apellido.localeCompare(G.nombre_apellido):G.nombre_apellido.localeCompare(L.nombre_apellido)),ie=Z=>{U(Z)},oe=Z=>{Z.preventDefault()},J=Z=>{const L=[...k],G=L.findIndex(re=>re.id===$),se=L.findIndex(re=>re.id===Z),[ae]=L.splice(G,1);L.splice(se,0,ae),M(L)};return a.useEffect(()=>{H()},[]),a.useEffect(()=>{const Z=s.filter(L=>L.nombre_apellido&&L.nombre_apellido.toLowerCase().includes(x.toLowerCase())).filter(L=>u?L.unidad===u:!0).filter(L=>d?L.comisaria===d:!0).filter(L=>{var re;if(!m&&!C)return!0;const G=(re=L.fecha_ingreso_validado)==null?void 0:re.toDate();if(!G)return!1;const se=m?new Date(m):null,ae=C?new Date(C):null;return!(se&&G<se||ae&&G>ae)});c(V(Z))},[x,u,d,m,C,g,s]),e.jsxs("div",{className:"container-lg mt-0 mt-5 mt-sm-5 mt-md-0 ms-lg-0 ",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Rendimiento Art. 10 Bis"})}),e.jsx("div",{className:"container mb-4",children:e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${w?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>D(!w),children:[e.jsx("i",{className:`bi ${w?"bi-eye-slash":"bi-eye"} me-1`}),w?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${p?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>y(!p),children:[e.jsx("i",{className:`bi ${p?"bi-eye-slash":"bi-eye"} me-1`}),p?"Ocultar Persdonal Salida":"Ver Personal Salida"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${S?"btn-outline-pink":"btn-outline-green"}`,onClick:()=>F(!S),children:[e.jsx("i",{className:`bi ${S?"bi-eye-slash":"bi-eye"} me-1`}),S?"Ocultar Personal Entrada":"Ver Personal Entrada"]})})]})}),e.jsx(fi,{personas:s,visible:S,setVisible:F}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:k.map(({id:Z,componente:L})=>e.jsxs("div",{draggable:!0,onDragStart:()=>ie(Z),onDragOver:oe,onDrop:()=>J(Z),className:"my-3 ",children:[L==="ResumenTotalesRendimiento"&&e.jsx(pi,{personas:t,seleccionadas:i,visible:w,setVisible:D}),L==="PersonalEntregaCard"&&e.jsx(ji,{personas:s,visible:S,setVisible:F}),L==="PersonalSalidaCard"&&e.jsx(gi,{personas:s,visible:p,setVisible:y})]},Z))})]})},vi=()=>{const[s,r]=a.useState("dashboard"),[t,c]=a.useState(!1),i=()=>{switch(s){case"dashboard":return e.jsx(Kt,{});case"administar":return e.jsx(ii,{});case"exportacion":return e.jsx(ri,{});case"graficos":return e.jsx(ui,{});case"comisarias2":return e.jsx(bi,{});case"rendimiento":return e.jsx(ra,{});case"rendimientoApp":return e.jsx(Ni,{});case"desactivados":return e.jsx(hi,{});case"activados":return e.jsx(xi,{});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsxs("div",{className:"container-lg py-4 mb-sm-5 mb-md-5 mt-0",children:[e.jsx("div",{className:"titulo-espaciado text-start mb-4",children:e.jsx("h3",{className:"text-secondary fw-semibold",children:"Panel de Control"})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"list-group shadow",children:[e.jsx("button",{className:`list-group-item list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>r("dashboard"),children:"Bienvenidos"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="exportacion"?"active":""}`,onClick:()=>r("exportacion"),children:"Exportación"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="graficos"?"active":""}`,onClick:()=>r("graficos"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Graficos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-teal rounded-pill",children:"Nuevo"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="rendimientoApp"?"active":""}`,onClick:()=>r("rendimientoApp"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Rendimiento Art.10 Bis",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"",children:" 🏆 "})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="comisarias2"?"active":""}`,onClick:()=>r("comisarias2"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Comisarias",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-primaryMuiBlue rounded-pill",children:"Administar"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="activados"?"active":""}`,onClick:()=>r("activados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Art 10 Bis Activos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-secondaryM rounded-pill",children:"Panel"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="desactivados"?"active":""}`,onClick:()=>r("desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Art 10 Bis Historicos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-secondaryM rounded-pill",children:"Panel"})]})})]})}),e.jsx("div",{className:"col-md-9",children:i()})]})]})},yi=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ae,{}),e.jsx(ke,{element:"Panel de Control Art 10 Bis ",element2:"Cx2",element3:"bi bi-ui-checks"}),e.jsx("div",{className:"container-lg",id:"bodyGallery",children:e.jsx(vi,{})}),e.jsx(je,{}),e.jsx(Ee,{})]}),wi=({toggleRendimiento:s})=>{const[r,t]=a.useState({personalEntrega:[],salidasArtUsuarioMap:[]});a.useEffect(()=>{(async()=>{const n=(await X(Y(A,"db_art_diez_bis_desactivados"))).docs.map(o=>o.data());c(n)})()},[]);const c=i=>{const l={},n={};i.forEach(h=>{h.personal_entrega.forEach(u=>{const j=u.nombre.split(" ")[0],g=`${u.ni} - ${j}`;l[g]=(l[g]||0)+1}),h.salida_art_usuario&&(n[h.salida_art_usuario]=(n[h.salida_art_usuario]||0)+1)});const o=Object.entries(l).map(([h,u])=>({key:h,value:u})).sort((h,u)=>u.value-h.value),x=Object.entries(n).map(([h,u])=>({usuario:h,cantidad:u})).sort((h,u)=>u.cantidad-h.cantidad);t({personalEntrega:o,salidasArtUsuarioMap:x})};return e.jsxs("div",{className:"container  ",children:[e.jsx("div",{className:"modal-header border border-0 ",children:e.jsx("button",{type:"button",className:"btn-close bg-white my-2",onClick:s})}),e.jsxs("div",{className:"card bg-transparent border-1 p-3  border-5",children:[e.jsxs("h5",{className:"card-title text-center  bg-gradiante2  text-white rounded p-2 m-2",children:["Rendimiento en  Entrega ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsx("div",{className:"card-body  ",children:e.jsxs("table",{className:"table table-striped text-center table-primary  ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Posición"}),e.jsx("th",{scope:"col ",children:"Personal"}),e.jsx("th",{scope:"col",children:"Distinción"})]})}),e.jsx("tbody",{children:r.personalEntrega.length>0?r.personalEntrega.map(({key:i,value:l},n)=>e.jsxs("tr",{className:n===0?"table-warning":"",children:[e.jsx("td",{children:n===0?"👑 1":n===1?"🥈 2":n===2?"🥉 3":n+1}),e.jsx("td",{children:i}),e.jsx("td",{children:n===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):n===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):n===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},i)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No hay datos disponibles"})})})]})})]})]})},Si=({notif:s})=>e.jsxs("div",{className:"list-group-item d-flex justify-content-between align-items-center my-2 py-3 shadow",children:[e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-person-arms-up me-3 text-primary"}),e.jsx("strong",{children:s.nombre_apellido||"Nombre desconocido"}),e.jsxs("span",{children:[" - ",s.dni||"DNI no disponible"]})]}),e.jsx("span",{className:"badge bg-primary",children:s.comisaria||"Sin fecha"})]}),Ci=({toggleBusqueda:s})=>{const[r,t]=a.useState([]),[c,i]=a.useState([]),[l,n]=a.useState(""),[o,x]=a.useState(!1),h=async()=>{try{x(!0);const j=ge(Y(A,"db_art_diez_bis"),Se("visualidad","==",!0)),N=(await X(j)).docs.map(d=>({id:d.id,...d.data()}));t(N),i(N)}catch(j){console.error("Error al obtener las notificaciones: ",j)}finally{x(!1)}};a.useEffect(()=>{h()},[]),a.useEffect(()=>{const j=r.filter(g=>g.nombre_apellido&&g.nombre_apellido.toLowerCase().includes(l.toLowerCase())||g.dni&&g.dni.toString().includes(l));i(j)},[l,r]);const u=()=>{n("")};return e.jsxs("div",{className:"container ",children:[e.jsx("div",{className:"modal-header border border-0 ",children:e.jsx("button",{type:"button",className:"btn-close bg-white my-2",onClick:s})}),e.jsxs("div",{className:"card bg-transparent border-1 p-3 border-5",children:[e.jsxs("h5",{className:"card-title text-center bg-gradiante2 text-white rounded p-2 m-2",style:{backdropFilter:"blur(5px)",backgroundColor:"rgba(0,0,0,0.4)"},children:["Buscar Persona ",e.jsx("i",{className:"ms-2 bi bi-search"})]}),e.jsxs("div",{className:"input-group my-4",children:[e.jsx("span",{className:"input-group-text bg-indigoMui ",children:e.jsx("i",{className:"bi bi-search text-white "})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por DNI o nombre...",value:l,onChange:j=>n(j.target.value)}),l&&e.jsx("button",{className:"btn btn-outline-pink bg-secondaryMuiRed",onClick:u,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash3-fill text-white"})})]}),o?e.jsx("div",{className:"text-center my-4",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsx("ul",{className:"list-group",children:c.length>0?c.map(j=>e.jsx(Si,{notif:j},j.id)):e.jsx("li",{className:"list-group-item text-center text-danger p-4",children:l?`No se encontraron resultados para "${l}"`:"No hay personas disponibles"})})]})]})},_i=({togglePlazas:s})=>{const[r,t]=a.useState([]),[c,i]=a.useState([]),[l,n]=a.useState([]),[o,x]=a.useState("nombre"),h=async()=>{try{const m=(await X(Y(A,"db_comisarias"))).docs.map(f=>({id:f.id,...f.data()})).filter(f=>f.disponibilidad===!0);t(m)}catch(b){console.error("Error al obtener las comisarías: ",b)}},u=async()=>{try{const m=(await X(Y(A,"db_art_diez_bis"))).docs.map(v=>({id:v.id,...v.data()})),f=m.filter(v=>v.visualidad===!0&&v.comisaria_recibe===!0),C=m.filter(v=>v.visualidad===!1&&v.comisaria_recibe===!1);i(f),n(C)}catch(b){console.error("Error al obtener las notificaciones: ",b)}};a.useEffect(()=>{h(),u()},[]);const j=c.reduce((b,m)=>{const f=m.comisaria;return f&&(b[f]=(b[f]||0)+1),b},{}),g=l.reduce((b,m)=>{const f=m.comisaria;return f&&(b[f]=(b[f]||0)+1),b},{}),N=b=>{const m=r.find(f=>f.comisaria===b);if(m){const f=m.plazas_art_10_bis||0;return(j[b]||0)>=f?{estado:"Llena",clase:"badge bg-danger"}:{estado:"Disponible",clase:"badge bg-info"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},d=()=>o==="nombre"?[...r].sort((b,m)=>b.comisaria.localeCompare(m.comisaria)):o==="plaza"?[...r].sort((b,m)=>(m.plazas_art_10_bis||0)-(b.plazas_art_10_bis||0)):r;return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"modal-header border border-0 ",children:e.jsx("button",{type:"button",className:"btn-close bg-white my-2",onClick:s})}),e.jsxs("div",{className:"card bg-transparent border-1 p-3  border-5",children:[e.jsxs("h5",{className:"card-title text-center  bg-gradiante2  text-white rounded p-2 m-2",children:["Plazas Art 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-shield-lock"})]}),e.jsxs("div",{className:"form-floating my-3",children:[e.jsxs("select",{className:"form-select",id:"filtroOrden",value:o,onChange:b=>x(b.target.value),"aria-label":"Ordenar por",children:[e.jsx("option",{value:"nombre",children:"Nombre (A-Z)"}),e.jsx("option",{value:"plaza",children:"Plazas Disponibles"})]}),e.jsx("label",{htmlFor:"filtroOrden",children:"Ordenar por"})]}),e.jsx("div",{className:"list-group",children:d().map(b=>{const{estado:m,clase:f}=N(b.comisaria),C=j[b.comisaria]||0,v=g[b.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow  ",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center ",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-capitalize",children:b.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:f,children:`${C} / ${b.plazas_art_10_bis||0} Plazas - ${m}`}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary",children:`${v} Pendientes ( Por Validar )`})})]})]})]})},b.comisaria)})})]})]})},ki=({notif:s})=>e.jsxs("div",{className:"list-group-item d-flex justify-content-between align-items-center my-2 py-3 shadow",children:[e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-person-arms-up me-3 text-primary"}),e.jsx("strong",{children:s.nombre_apellido||"Nombre desconocido"}),e.jsxs("span",{children:[" - ",s.dni||"DNI no disponible"]})]}),e.jsx("span",{className:"badge bg-primary",children:s.comisaria||"Sin fecha"})]}),Ei=({toggleBusqueda:s})=>{const[r,t]=a.useState([]),[c,i]=a.useState([]),[l,n]=a.useState(""),[o,x]=a.useState(!1),h=async()=>{try{x(!0);const j=ge(Y(A,"db_art_diez_bis"),Se("visualidad","==",!0)),N=(await X(j)).docs.map(d=>({id:d.id,...d.data()}));t(N),i(N)}catch(j){console.error("Error al obtener las notificaciones: ",j)}finally{x(!1)}};a.useEffect(()=>{h()},[]),a.useEffect(()=>{const j=r.filter(g=>g.nombre_apellido&&g.nombre_apellido.toLowerCase().includes(l.toLowerCase())||g.dni&&g.dni.toString().includes(l));i(j)},[l,r]);const u=()=>{n("")};return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"modal-header border border-0 m-0",children:e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:s})}),e.jsxs("h5",{className:"text-center  bg-primary text-white rounded p-2",children:["Ingreso Articulo 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-search"})]}),e.jsxs("div",{className:"input-group mb-4",children:[e.jsx("span",{className:"input-group-text bg-blueW",children:e.jsx("i",{className:"bi bi-search text-primary "})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por DNI o nombre...",value:l,onChange:j=>n(j.target.value)}),l&&e.jsx("button",{className:"btn btn-outline-pink bg-secondaryMuiRed",onClick:u,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash3-fill text-white"})})]}),o?e.jsx("div",{className:"text-center my-4",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsx("ul",{className:"list-group",children:c.length>0?c.map(j=>e.jsx(ki,{notif:j},j.id)):e.jsx("li",{className:"list-group-item text-center text-danger",children:l?`No se encontraron resultados para "${l}"`:"No hay notificaciones disponibles"})})]})},Di=({comisariaSeleccionada:s,cantidadDemorados:r,close:t,closeModalRaiz:c})=>{const i=["CRE Rosario","CRE Baigorria","BOU","BOP","AUOP","MOTORIZADA","CGI","PAT","CYP","VIAL","PUMAS","OTROS"],[l,n]=a.useState("Rosario"),[o,x]=a.useState(s),[h,u]=a.useState(""),[j,g]=a.useState(""),[N,d]=a.useState(""),[b,m]=a.useState(""),[f,C]=a.useState(""),[v,w]=a.useState(""),[D,p]=a.useState(!1),y=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/,[S,F]=a.useState(!0),[_,k]=a.useState([]),[M,$]=a.useState(""),[U,Q]=a.useState(""),[H,V]=a.useState([]),ie=new Date().toLocaleString(),oe=P=>y.test(P),J=()=>{if(H.length>=r){alert(`Ya agregaste la cantidad máxima de ${r} personas.`);return}if(!oe(j)){C("El nombre y apellido solo deben contener letras y espacios.");return}if(N.length!==8||isNaN(N)){C("El DNI debe ser un número de 8 caracteres.");return}V([...H,{nombreApellido:j,dni:N}]),g(""),d(""),C("")},Z=()=>{if(_.some(T=>T.ni===U)){w("El N.I. ya está registrado en la lista de integrantes.");return}if(U.length!==6||isNaN(U)){w("El N.I debe ser un número de 6 caracteres.");return}if(!oe(M)){w("El nombre no debe contener números.");return}k([..._,{nombre:M,ni:U}]),F(!1),$(""),Q(""),w("")},L=()=>{F(!S)},G=async P=>{if(P.preventDefault(),!o){m("Por favor, selecciona una comisaría.");return}if(!h){m("Por favor, selecciona una unidad.");return}if(H.length===0){m("Debes agregar al menos una persona.");return}if(_.length===0){m("Debes agregar al menos una persona para la entrega.");return}if(!window.confirm("¿Estás seguro de que deseas agregar Art. 10 Bis?")){alert("La operación fue cancelada.");return}m(""),p(!0);try{const z=JSON.parse(localStorage.getItem("user"));for(let B=0;B<H.length;B++){const E=H[B];await ye(Y(A,"db_art_diez_bis"),{nombre_apellido:E.nombreApellido,dni:E.dni,selectedLocalidad:l,comisaria:s,unidad:h,timestamp:ie,usuario:(z==null?void 0:z.email)||"Usuario desconocido",visualidad:!1,comisaria_recibe:!1,personal_entrega:_})}alert("Se agregaron las personas con Art. 10 Bis."),n("Rosario"),x(""),u(""),g(""),k(""),d(""),Q(""),c(),t()}catch(z){console.error("Error al enviar notificación: ",z),m("Error al enviar la notificación. Inténtalo de nuevo.")}finally{p(!1)}},se=P=>{const T=H.filter((z,B)=>B!==P);V(T)},ae=P=>{const T=_.filter((z,B)=>B!==P);k(T),_.length<2&&F(!0)},re=H.length>0,ue=h&&h.trim().length>0,I=_.length>0;return e.jsx("form",{onSubmit:G,children:e.jsxs("div",{className:"container ",children:[H.length>0&&e.jsxs("div",{className:"text-center my-2",children:[e.jsx("hr",{className:"text-light mb-3"}),e.jsxs("h6",{className:"fw-semibold text-white ",children:["Personas Agregadas "," ",e.jsx("span",{className:"badge bg-indigo",children:H.length})]})]}),e.jsx("ul",{className:"list-group mb-4",children:H.map((P,T)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center my-2 p-2 rounded shadow-sm bg-light",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 titilar"}),P.nombreApellido," - ",P.dni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>se(T),children:e.jsx("i",{className:"bi bi-trash"})})]},T))}),e.jsxs("div",{className:"mb-3 text-center",children:[h?e.jsx("div",{children:e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("hr",{className:"text-light mb-3"}),e.jsxs("h6",{className:"fw-semibold text-white",children:["Unidad Operacional "," ",e.jsx("span",{className:"badge bg-indigo",children:h}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>u(""),children:e.jsx("i",{className:"bi bi-trash"})})]})]})}):e.jsxs("div",{children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-gradiante2 fw-semibold shadow-sm text-white py-2 rounded",children:"Unidad Procede a la Entrega"}),e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{id:"unidad",className:`form-select ${b&&!h?"is-invalid":""}`,value:h,onChange:P=>u(P.target.value),children:[e.jsx("option",{value:"",className:"text-center mt-1",children:"Seleccionar Unidad"}),i.map(P=>e.jsx("option",{value:P,children:P},P))]}),e.jsx("label",{htmlFor:"unidad",children:"Unidad Procede a la Entrega"}),b&&!h&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una unidad."})]})]}),e.jsx("div",{className:"mb-3 text-center",children:b&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),b]})})]}),_.length>0&&e.jsxs("div",{className:"text-center  mt-4",children:[e.jsx("hr",{className:"text-light mb-3"}),e.jsxs("h6",{className:"fw-semibold text-white ",children:["integrantes Unidad"," ",e.jsx("span",{className:"badge bg-indigo ",children:_.length})]}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsxs("button",{type:"button",className:"btn border-light text-light my-1",onClick:L,children:[e.jsx("i",{className:"bi bi-car-front-fill mx-1"}),S?" Cerrar":" Agregar"]})})]}),e.jsx("ul",{className:"list-group mb-3 ",children:_.map((P,T)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light mt-3",children:[e.jsx("i",{className:"bi bi-car-front-fill text-primary me-3 titilar "}),P.nombre," - ",P.ni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>ae(T),children:e.jsx("i",{className:"bi bi-trash"})})]},T))}),e.jsx("hr",{className:"text-light mb-5"}),H.length<r&&e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center border border-3 fw-semibold shadow-sm text-white py-2 rounded",children:"Agregar personas 10 Bis"}),f&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),f]}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${f&&!y.test(j)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:j,onChange:P=>g(P.target.value)}),e.jsx("label",{htmlFor:"nombreApellido",children:"Nombre y Apellido"}),f&&!y.test(j)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${f&&(N.length!==8||isNaN(Number(N)))?"is-invalid":""}`,maxLength:"8",placeholder:"DNI",value:N,onChange:P=>d(P.target.value.replace(/[^\d]/g,""))}),e.jsx("label",{htmlFor:"dni",children:"DNI"}),f&&(N.length!==8||isNaN(Number(N)))&&e.jsx("div",{className:"invalid-feedback",children:"El DNI debe ser un número de hasta 8 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",onClick:()=>J(),children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})})]}),S?e.jsxs("div",{className:"mb-3 text-center mt-5",children:[e.jsxs("h6",{className:"fw-semibold text-capitalize text-center border border-3 fw-semibold shadow-sm text-white py-2 rounded",children:["Mi Unidad ",e.jsx("span",{className:"badge text-bg-indigo mx-1",children:" Integrantes"})]}),v&&e.jsxs("div",{className:"alert alert-light text-danger shadow my-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar"}),v]}),e.jsxs("div",{className:"row g-2 my-2",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${v&&!y.test(M)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:M,onChange:P=>$(P.target.value)}),e.jsx("label",{htmlFor:"nombreEntrega",children:"Nombre y Apellido"}),v&&!y.test(M)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${v&&(U.length!==6||isNaN(U))?"is-invalid":""}`,placeholder:"N.I",maxLength:"6",value:U,onChange:P=>Q(P.target.value)}),e.jsx("label",{htmlFor:"niEntrega",children:"N.I"}),v&&(U.length!==6||isNaN(U))&&e.jsx("div",{className:"invalid-feedback",children:"El N.I debe ser un número de 6 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",onClick:()=>Z(),children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})})]})]}):null,e.jsx("div",{className:"card  bg-transparent mt-5",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title mb-3",children:"Asistente de Estados "}),re&&ue&&I&&e.jsx("div",{className:"text-start",children:e.jsx("button",{type:"submit",className:"btn btn-primary shadow",disabled:D,children:D?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-arrow-repeat me-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),"Confirmar Envio"]})})}),e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:`btn btn-${re?"teal":"secondaryMuiRed"} btn-sm text-white rounded-circle ms-3`,title:re?"Condición cumplida":"Falta agregar persona",children:e.jsx("i",{className:"bi bi-person-fill"})}),e.jsx("button",{type:"button",className:`btn btn-${ue?"teal":"secondaryMuiRed"} btn-sm text-white rounded-circle ms-3`,title:ue?"Condición cumplida":"Falta seleccionar unidad",children:e.jsx("i",{className:"bi bi-shield-fill"})}),e.jsx("button",{type:"button",className:`btn btn-${I?"teal":"secondaryMuiRed"} btn-sm text-white rounded-circle ms-3`,title:I?"Condición cumplida":"Falta agregar persona para la entrega",children:e.jsx("i",{className:"bi bi-car-front-fill"})})]})]})})]})})},Fi=({comisariaSeleccionada:s,cantidadDemorados:r,closeModalRaiz:t})=>{const[c,i]=a.useState(!1),l=()=>{i(!0),window.history.pushState({modalOpen:!0},"")},n=()=>{var o;i(!1),(o=window.history.state)!=null&&o.modalOpen&&window.history.back()};return a.useEffect(()=>{const o=x=>{c&&i(!1)};return window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}},[c]),!s||!r?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-3",children:e.jsxs("button",{className:"btn btn-primary w-100",onClick:l,children:[e.jsx("i",{className:"bi bi-file-earmark-plus-fill me-2"})," Crear Formulario"]})}),c&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",style:{background:"linear-gradient(135deg, #6e7fdb, #4e5b9a ,#633D88,#8C57FF)",animation:c?"fadeIn 0.5s":"none"},children:[e.jsxs("div",{className:"modal-header border border-0 bg-gradiante2 text-white",children:[e.jsx("h5",{className:"modal-title",children:"Formulario de Ingreso"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:n})]}),e.jsx("hr",{className:"border-2 text-white opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row text-center text-white text-capitalize",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Destino :"})," ",e.jsxs("span",{className:"badge text-bg-indigo",children:[" ",s," "]})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Demorados :"})," ",e.jsx("span",{className:"badge text-bg-primary",children:r})]})})]}),e.jsx(Di,{comisariaSeleccionada:s,cantidadDemorados:r,close:n,closeModalRaiz:t})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{className:"btn btn-outline-light",onClick:n,children:[e.jsx("i",{className:"bi bi-backspace"})," Regresar"]}),e.jsxs("button",{className:"btn btn-outline-light",onClick:t,children:[e.jsx("i",{className:"bi bi-x-circle"})," Cancelar"]})]})]})})}),c&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Pi=({comisariaSeleccionada:s,cantidadDemorados:r,closeModalRaiz:t})=>{const c=s&&r>0;return e.jsxs("div",{className:"alert alert-info mt-3 ",children:[e.jsx("strong",{className:"text-center ",children:"Resumen de Selección"}),e.jsxs("p",{className:"my-2",children:["Comisaría Seleccionada:"," ",e.jsx("strong",{className:"text-capitalize",children:s?e.jsxs(e.Fragment,{children:[s," ",e.jsx("i",{className:"bi bi-building-fill-check text-primary"})]}):e.jsx("span",{className:"text-pink titilar ",children:"Ninguna"})})]}),e.jsxs("p",{className:"mb-0",children:["Cantidad de Demorados:"," ",e.jsx("strong",{children:r?e.jsxs(e.Fragment,{children:[r," ",e.jsx("i",{className:"bi bi-person-add text-primary"})]}):0})]}),c&&e.jsx(Fi,{comisariaSeleccionada:s,cantidadDemorados:r,closeModalRaiz:t})]})},Ai=({togglePlazas:s,cantidadDemorados:r,closeModalRaiz:t})=>{const[c,i]=a.useState([]),[l,n]=a.useState([]),[o,x]=a.useState([]),[h,u]=a.useState(""),[j,g]=a.useState("nombre"),[N,d]=a.useState(!0);a.useEffect(()=>{b(),m()},[]);const b=async()=>{try{const y=(await X(Y(A,"db_comisarias"))).docs.map(S=>({id:S.id,...S.data()})).filter(S=>S.disponibilidad===!0);i(y),d(!1)}catch(p){console.error("Error al obtener comisarías:",p),d(!1)}},m=async()=>{try{const y=(await X(Y(A,"db_art_diez_bis"))).docs.map(S=>({id:S.id,...S.data()}));n(y.filter(S=>S.visualidad===!0&&S.comisaria_recibe===!0)),x(y.filter(S=>S.visualidad===!1&&S.comisaria_recibe===!1))}catch(p){console.error("Error al obtener notificaciones:",p)}},f=l.reduce((p,y)=>{const S=y.comisaria;return S&&(p[S]=(p[S]||0)+1),p},{}),C=o.reduce((p,y)=>{const S=y.comisaria;return S&&(p[S]=(p[S]||0)+1),p},{}),v=p=>{const y=c.find(S=>S.comisaria===p);if(y){const S=y.plazas_art_10_bis||0,F=f[p]||0,_=S-F;return F>=S?{estado:"Llena",clase:"badge bg-danger"}:{estado:`Disponible (${_} libres)`,clase:"badge bg-secondaryM"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},w=()=>j==="nombre"?[...c].sort((p,y)=>p.comisaria.localeCompare(y.comisaria)):j==="plaza"?[...c].sort((p,y)=>(y.plazas_art_10_bis||0)-(p.plazas_art_10_bis||0)):c,D=p=>r?p.filter(y=>{const S=f[y.comisaria]||0;return(y.plazas_art_10_bis||0)-S>=r}):p;return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center my-4",children:[e.jsx("strong",{children:"Comisarías con plazas disponibles"}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:s,children:e.jsx("i",{className:"bi bi-trash3-fill"})})]}),N?e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsxs("div",{className:"list-group",children:[D(w()).map(p=>{const{estado:y,clase:S}=v(p.comisaria),F=f[p.comisaria]||0,_=C[p.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow",onClick:()=>{u(p.comisaria)},style:{cursor:"pointer"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-capitalize",children:p.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:S,children:`${F} / ${p.plazas_art_10_bis||0} Plazas `}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary mt-1",children:`${_} Pendientes (por validar)`})})]})]})]})},p.comisaria)}),e.jsx("div",{className:"container mt-1",children:e.jsx(Pi,{cantidadDemorados:r,comisariaSeleccionada:h,closeModalRaiz:t})})]})]})},Mi=({show:s,onClose:r,onConfirm:t,closeModalRaiz:c})=>{const[i,l]=a.useState(1),[n,o]=a.useState(!1),[x,h]=a.useState(null);if(!s)return null;const u=()=>{const j=parseInt(i,10);h(j),o(!0)};return e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",children:e.jsxs("div",{className:"modal-content ",style:{background:"linear-gradient(135deg, #6e7fdb, #4e5b9a ,#633D88,#8C57FF)",animation:s?"fadeIn 0.5s":"none"},children:[e.jsxs("div",{className:"modal-header border border-0 bg-gradiante2 text-white",children:[e.jsx("h5",{className:"modal-title text-capitalize ",children:"Cuantas Plazas Necesitas ?"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:r})]}),"   ",e.jsx("hr",{className:" border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"input-group ",children:[e.jsx("span",{className:"input-group-text  fw-semibold bg-transparent text-light",children:"Plaza/s"}),e.jsx("input",{type:"number",className:"form-control text-center",value:i,onChange:j=>l(j.target.value),min:"1",max:"10","aria-describedby":"cantidadAddon","aria-label":"Cantidad"}),e.jsx("button",{className:"btn btn-outline-light",type:"button",id:"cantidadAddon",onClick:u,children:"Aceptar"})]}),n&&e.jsx(Ai,{togglePlazas:()=>o(!1),cantidadDemorados:x,closeModalRaiz:c})]}),e.jsx("div",{className:"modal-footer",children:e.jsxs("button",{className:"btn btn-outline-light",onClick:r,children:[e.jsx("i",{className:"bi bi-backspace"}),"   Regresar"]})})]})})})},Ii=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),[i,l]=a.useState(!1),[n,o]=a.useState(!1),[x,h]=a.useState(!1),[u,j]=a.useState(!1),[g,N]=a.useState(!1),[d,b]=a.useState([]),m=we(),f=_=>{console.log(`Se demorarán ${_} personas`),c(!1)},C=()=>{l(!1),o(!1),N(!1),j(!1),h(!1),r()},v=()=>j(_=>!_),w=()=>h(_=>!_),D=()=>N(_=>!_),p=()=>o(_=>!_);a.useEffect(()=>{b([{id:"preformulario",component:e.jsx(Ei,{togglePreFormulario:p}),visible:n},{id:"busqueda",component:e.jsx(Ci,{toggleBusqueda:v}),visible:u},{id:"plazas",component:e.jsx(_i,{togglePlazas:w}),visible:x},{id:"rendimiento",component:e.jsx(wi,{toggleRendimiento:D}),visible:g}])},[u,x,g,n]);const y=(_,k)=>{_.dataTransfer.setData("index",k)},S=(_,k)=>{_.preventDefault();const M=_.dataTransfer.getData("index");if(M!==null){const $=[...d],[U]=$.splice(M,1);$.splice(k,0,U),b($)}},F=_=>_.preventDefault();return a.useEffect(()=>{if(m.pathname==="/dashboard"){const _=()=>C();return window.history.pushState(null,document.title),window.addEventListener("popstate",_),()=>window.removeEventListener("popstate",_)}},[]),a.useEffect(()=>{if(s){window.history.pushState({modalOpen:!0},"");const _=k=>{C()};return window.addEventListener("popstate",_),()=>{window.removeEventListener("popstate",_)}}},[s]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog",style:{display:"block",transition:"opacity 0.4s ease-in-out"},children:e.jsx("div",{className:"modal-dialog modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content bg-blueW2",style:{background:"linear-gradient(135deg, #4e5b9a , #633D88, #8C57FF)",animation:s?"fadeIn 0.5s":"none"},children:[e.jsxs("div",{className:"modal-header border-0 bg-gradiante2",children:[e.jsx("h5",{className:"modal-title ",children:"Menú Artículo 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close bg-prima btn-close-white",onClick:C})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3 my-3 ",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2  ${t?"btn-light ":"btn-outline-light "}`,onClick:()=>{j(!1),N(!1),h(!1),l(!1),c(!0)},children:e.jsx("i",{className:"bi bi-person-lines-fill fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:t?"Ocultar":"Personas"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2 ${u?"btn-light":"btn-outline-light"}`,onClick:v,children:e.jsx("i",{className:"bi bi-search fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:u?"Ocultar":"Búsqueda"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2 ${x?"btn-light":"btn-outline-light"}`,onClick:w,children:e.jsx("i",{className:"bi bi-shield-lock fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:x?"Ocultar":"Plazas"})]}),e.jsxs("div",{className:"text-center me-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2 ${g?"btn-light":"btn-outline-light"}`,onClick:D,children:e.jsx("i",{className:"bi bi-bar-chart fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:g?"Ocultar":"Rendimiento"})]})]}),e.jsx("div",{className:"mt-3",children:d.map((_,k)=>_.visible&&e.jsx("div",{draggable:!0,onDragStart:M=>y(M,k),onDragOver:F,onDrop:M=>S(M,k),className:"border border-0 p-1 m-1 mt-3 text-white bg-transparent ",style:{cursor:"grab"},children:_.component},_.id))}),e.jsx("div",{className:"container my-4",children:e.jsx(Mi,{show:t,onClose:()=>c(!1),onConfirm:f,closeModalRaiz:r})})]})]})})}):null},Li=()=>{const[s,r]=a.useState(!1),t=()=>r(!1);return e.jsxs("div",{className:"col-12 d-flex justify-content-center align-items-center",children:[e.jsx("div",{className:"w-75 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("h1",{className:"display-4 fw-bold mt-3",children:"Art. 10 BIS"}),e.jsx("p",{className:"lead my-3",children:"Administra todas las Funciones Referentes al Artículo"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx(pe,{onClick:()=>r(!0),className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})}),e.jsx("div",{className:"mt-1 small",children:"Nuevo"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx(pe,{to:"/validaringreso10Bis",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",children:e.jsx("i",{className:"bi bi-box-arrow-in-right fs-5"})}),e.jsx("div",{className:"mt-1 small",children:"Validar"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx(pe,{to:"/validarsalida10Bis",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",children:e.jsx("i",{className:"bi bi-box-arrow-left fs-5"})}),e.jsx("div",{className:"mt-1 small",children:"Salida"})]})]})]})}),e.jsx(Ii,{showModal:s,closeModal:t})]})},$i=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center ",children:e.jsx("div",{className:"w-75 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("h1",{className:"display-4 fw-bold ",children:"Bienvenido a CX2 Santa Fe"}),e.jsx("p",{className:"lead my-3  fs-5",children:"Descubrí todo lo que nuestro sistema tiene para ofrecer, ¡explorá nuestras funcionalidades y novedades!"}),e.jsx(pe,{to:"/galeriadev2",className:"btn btn-outline-light mt-3",children:"Ver Galería"})]})})})}),Ce=({data1:s,data2:r,data3:t})=>{const c=s||"© 2025 Tics, Inc",i=r||"Cx2",l=t||"Policía de Santa Fe";return e.jsx("div",{className:"container-lg text-center ",children:e.jsxs("footer",{className:"d-flex flex-wrap justify-content-between align-items-center pt-4 my-4 border-top ",children:[e.jsx("p",{className:"col-md-4 mb-0 text-white",children:c}),e.jsx("a",{href:"/",className:"col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none d-none d-md-block","aria-label":"Inicio",children:e.jsx("img",{className:"opacity-50",src:"/img/Escudo Pol SF Color Original_BN.png",width:"35",height:"32",alt:"Escudo Policía Santa Fe"})}),e.jsx("ul",{className:"nav col-md-4 justify-content-center text-light",children:e.jsxs("li",{className:"nav-item",children:[e.jsx("strong",{children:i})," / ",e.jsx("strong",{children:l})," "]})})]})})};Ce.propTypes={data1:ve.string,data2:ve.string,data3:ve.string};const Ri=()=>{const[s,r]=a.useState(null),[t,c]=a.useState(!1),[i,l]=a.useState(!1);a.useEffect(()=>{const o=x=>{x.preventDefault(),r(x),c(!0)};return window.matchMedia("(display-mode: standalone)").matches&&l(!0),window.addEventListener("beforeinstallprompt",o),()=>{window.removeEventListener("beforeinstallprompt",o)}},[]);const n=async()=>{s&&(s.prompt(),(await s.userChoice).outcome==="accepted"?console.log("El usuario aceptó la instalación."):console.log("El usuario rechazó la instalación."),r(null),c(!1))};return e.jsx(e.Fragment,{children:t&&e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center ",children:e.jsx("div",{className:"w-75 text-white ",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg border-white border",children:[e.jsx("h2",{className:"fs-4 fw-semibold mb-3",children:i?"¡PWA ya instalada!":"¿Querés instalar la app?"}),e.jsx("p",{className:"lead fs-6 ",children:i?"Ya tenés la app instalada. ¡Gracias por usarla!":"Guardá CX2 Santa Fe en tu dispositivo para un acceso más rápido y cómodo."}),!i&&e.jsxs("button",{className:"btn btn-outline-light px-4 py-2 fs-5",onClick:n,children:[e.jsx("i",{className:"bi bi-android2 me-2"})," Instalar App"]})]})})})})},zi=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),a.useEffect(()=>{const t=c=>{c.preventDefault(),c.returnValue="Estás a punto de dejar la página. ¿Quieres continuar?"};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(Li,{}),e.jsx($i,{}),e.jsx(Ri,{}),e.jsx(Ce,{})]})})},zs=()=>{const{currentUser:s}=a.useContext(Be),r=Qe(),[t,c]=a.useState(!1),i=async()=>{try{await xs(cs),r("/")}catch(n){console.error("Error al cerrar sesión:",n)}},l=()=>{c(!1)};return s&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:n=>{n.stopPropagation(),c(!0)},className:"btn text-secondaryMuiRed fw-semibold",children:[e.jsx("i",{className:"bi bi-box-arrow-right me-2 text-danger "})," Cerrar Sesión"]}),e.jsx("div",{className:`modal bg-dark fade ${t?"show":""}`,style:{display:t?"block":"none"},tabIndex:"-1","aria-labelledby":"logoutModalLabel","aria-hidden":!t,children:e.jsx("div",{className:"modal-dialog ",children:e.jsxs("div",{className:"modal-content   border border-white",children:[e.jsxs("div",{className:"modal-header bg-gradiante2 ",children:[e.jsx("h5",{className:"modal-title text-white  ",id:"logoutModalLabel",children:"Confirmar Cierre de Sesión"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:l,"aria-label":"Close"})]}),e.jsx("div",{className:"modal-body text-center  fw-semibold text-uppercase lh-lg",children:"¿Está seguro de que desea cerrar sesión?"}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-purpleUi ",onClick:()=>{i(),l()},children:"Cerrar Sesión"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},De=()=>{var c;const r=(()=>{const i=localStorage.getItem("user");return i?JSON.parse(i):null})(),t=((c=r==null?void 0:r.email)==null?void 0:c.split("@")[0])||"Usuario Sin Registro";return e.jsx("nav",{className:"navbar navbar-expand-lg navbar-dark bg-transparent position-absolute top-0 w-100 z-3",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx(pe,{className:"navbar-brand fw-bold text-white",to:"/dashboard",children:e.jsx("img",{src:"/img/marca-fondo-blanco-2024.png",height:"30",width:"100",alt:"Logo",className:"m-1"})}),e.jsx("div",{className:"position-relative",children:e.jsxs("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:[e.jsx("span",{className:"navbar-toggler-icon"}),e.jsx("span",{className:"position-absolute top-0 start-90 mt-1 translate-middle badge rounded-pill bg-danger",children:e.jsx(Ue,{})})]})}),e.jsxs("div",{className:"collapse navbar-collapse",id:"navbarNav",children:[e.jsxs("ul",{className:"navbar-nav ms-auto d-none d-md-flex flex-row flex-wrap justify-content-end w-100",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("div",{className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-person-fill me-2"}),t]})}),e.jsx("li",{className:"nav-item",children:e.jsx(_e,{to:"/dashboard",className:"nav-link text-white",children:e.jsx("i",{className:"bi bi-house-door-fill me-2"})})}),e.jsx("li",{className:"nav-item",children:e.jsxs(_e,{to:"/notificacionesDev2",className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-bell-fill me-2"}),e.jsx("span",{className:"position-absolute top-1 start-75 translate-middle badge rounded-pill bg-danger",children:e.jsx(Ue,{})})]})}),e.jsxs("li",{className:"nav-item dropdown",children:[e.jsxs("a",{className:"nav-link dropdown-toggle text-white",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx("i",{className:"bi bi-grid-fill me-2 ms-2"}),e.jsx("span",{className:"d-none d-md-inline",children:"Más"})]}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end text-center mb-3 shadow border-0",children:[e.jsxs(_e,{to:"/FormularioPageDev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario"})]}),e.jsxs(_e,{to:"/panelcontrol10dev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-file-earmark-lock2-fill me-2 textG2"}),e.jsx("span",{children:"10 bis"}),e.jsx("span",{className:"badge text-bg-secondaryM mx-1 text-white",children:"Panel"})]}),e.jsxs(_e,{to:"/panelcontroldev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-camera-fill me-2 textG2"}),e.jsx("span",{children:"Capturas "}),e.jsx("span",{className:"badge text-bg-indigoMui text-white",children:"Panel"})]}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider bg-indigo "})}),e.jsx("li",{children:e.jsx(zs,{})})]})]})]}),e.jsxs("ul",{className:"navbar-nav ms-auto d-flex d-md-none flex-row flex-wrap justify-content-between w-100",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("div",{className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-person-fill me-2"}),t]})}),e.jsx("li",{className:"nav-item",children:e.jsx(_e,{to:"/dashboard",className:"nav-link text-white",children:e.jsx("i",{className:"bi bi-house-door-fill me-2"})})}),e.jsx("li",{className:"nav-item",children:e.jsxs(_e,{to:"/notificacionesDev2",className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-bell-fill me-2"}),e.jsx("span",{className:"position-absolute top-1 start-75 translate-middle badge rounded-pill bg-danger",children:e.jsx(Ue,{})})]})}),e.jsxs("li",{className:"nav-item dropdown",children:[e.jsx("a",{className:"nav-link dropdown-toggle text-white",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"bi bi-grid-fill me-2 ms-2"})}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end text-center mb-3 shadow border-0",children:[e.jsxs(_e,{to:"/formularioPageDev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario"})]}),e.jsxs(_e,{to:"/panelcontrol10dev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-file-earmark-lock2-fill me-2 textG2"}),e.jsx("span",{children:"10 bis"}),e.jsx("span",{className:"badge text-bg-secondaryM mx-1 text-white",children:"Panel"})]}),e.jsxs(_e,{to:"/panelcontroldev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-camera-fill me-2 textG2"}),e.jsx("span",{children:"Capturas "}),e.jsx("span",{className:"badge text-bg-indigoMui text-white",children:"Panel"})]}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider bg-roseMui2"})}),e.jsx("li",{children:e.jsx(zs,{})})]})]})]})]})]})})},Ts=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-primary bg-gradiante",children:[e.jsx(De,{}),e.jsx(zi,{})]}),e.jsx(je,{})]});function Ti(){const[s,r]=a.useState([]),[t,c]=a.useState("noLeidas"),[i,l]=a.useState([]),[n,o]=a.useState(()=>{const w=localStorage.getItem("leidas");return w?JSON.parse(w):{}}),[x,h]=a.useState(!0),[u,j]=a.useState(!1),[g,N]=a.useState([]);a.useEffect(()=>{const w=Te(Y(A,"db_notificaciones"),D=>{const p=D.docs.map(y=>({id:y.id,...y.data()})).sort((y,S)=>{var F,_;return(((F=S.timestamp)==null?void 0:F.seconds)??0)-(((_=y.timestamp)==null?void 0:_.seconds)??0)});r(p)});return()=>w()},[]),a.useEffect(()=>{(async()=>{const p=(await X(Y(A,"db_personas"))).docs.map(y=>({id:y.id,...y.data()}));l(p),h(!1)})()},[]),a.useEffect(()=>{if(u){window.history.pushState({modalOpen:!0},"");const w=D=>{m()};return window.addEventListener("popstate",w),()=>{window.removeEventListener("popstate",w)}}},[u]);const d=w=>{o(D=>{const p={...D,[w]:!0};return localStorage.setItem("leidas",JSON.stringify(p)),p})},b=w=>{const D=s.find(p=>p.id===w);if(D!=null&&D.asociada){const p=i.filter(y=>D.asociada.includes(y.nombre_apellido));N(p),j(!0)}},m=()=>{j(!1),N([])},f=w=>({1:"Novedad",2:"Paradero",3:"Evasión",4:"Prioritaria"})[w]||"No definida",C=w=>/^https?:\/\//.test(w)?w:`https://${w}`,v=s.sort((w,D)=>{var S,F;const p=n[w.id]?1:0,y=n[D.id]?1:0;return p!==y?p-y:(((S=D.timestamp)==null?void 0:S.seconds)??0)-(((F=w.timestamp)==null?void 0:F.seconds)??0)}).filter(w=>t==="leidas"?n[w.id]:t==="noLeidas"?!n[w.id]:!0);return e.jsx("div",{className:"container-lg my-5",children:x?e.jsx(ne,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"w-75 text-white",children:e.jsx("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Notificaciones"}),e.jsxs("button",{type:"button",className:"btn btn-light position-relative",children:[e.jsx("i",{className:"bi bi-bell fs-4 text-dark"}),e.jsxs("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",children:[s.length,e.jsx("span",{className:"visually-hidden",children:"unread messages"})]})]})]})})})}),e.jsx("div",{className:"d-flex justify-content-center mt-4 px-2",children:e.jsx("div",{className:"btn-group shadow",role:"group",children:["todas","leidas","noLeidas"].map(w=>e.jsxs("button",{className:`btn ${t===w?"btn-light text-dark fw-semibold":"btn-outline-light bg-transparent text-white"} ${w==="todas"?"rounded-start-pill":w==="noLeidas"?"rounded-end-pill":""}`,onClick:()=>c(w),children:[e.jsx("i",{className:`bi me-2 ${w==="todas"?"bi-list-ul":w==="leidas"?"bi-check-circle":"bi-bell-fill"}`}),w==="todas"?"Todas":w==="leidas"?"Leídas":"No Leídas"]},w))})}),v.length===0?e.jsx("div",{className:"text-muted my-5 alert d-flex justify-content-center text-center",children:e.jsxs("p",{className:"text-white border border-4 p-4 rounded-pill w-75",children:[e.jsx("i",{className:`bi me-2 ${t==="todas"?"bi-inbox":t==="leidas"?"bi-check-circle":"bi-bell-fill"}`}),t==="todas"?"No hay notificaciones disponibles.":t==="leidas"?"No hay notificaciones leídas.":"No hay notificaciones sin leer."]})}):v.map(w=>{var D,p;return e.jsxs("div",{className:"card shadow position-relative d-flex gap-3 p-4 my-5 mx-3",children:[!n[w.id]&&e.jsx("button",{className:"btn-close position-absolute top-0 end-0 m-2",onClick:()=>d(w.id)}),e.jsx("img",{src:n[w.id]?"img/Alertas/alertRead.png":"img/Alertas/alert1.gif",alt:"Alerta",className:"position-absolute rounded-circle bg-white p-2 shadow",style:{width:n[w.id]?"75px":"80px",height:n[w.id]?"75px":"80px",top:"-20px",left:"-20px",objectFit:"contain"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"40px"},children:[e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center mb-2 mt-2",children:[e.jsx("h5",{className:"mb-1 text-center text-sm-start w-100 w-sm-auto",children:e.jsx("strong",{children:w.titulo||"Nueva Notificación"})}),w.timestamp&&e.jsx("p",{className:"mb-0 text-muted small d-none d-sm-block",children:new Date(w.timestamp.seconds*1e3).toLocaleString()})]}),e.jsxs("p",{children:[n[w.id]&&e.jsx("i",{className:"badge text-bg-indigoMui text-white bi bi-check-circle-fill",children:" Esta Notificación fue Leída"})," ",w.caratula&&e.jsxs(e.Fragment,{children:[parseInt(w.caratula)===1&&e.jsx("span",{className:"badge text-bg-teal text-white shadow-sm",children:f(w.caratula)}),parseInt(w.caratula)===2&&e.jsx("span",{className:"badge text-bg-primaryMuiBlue text-white shadow-sm",children:f(w.caratula)}),parseInt(w.caratula)===3&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-danger"}),e.jsx("span",{className:"badge text-bg-danger text-white shadow-sm",children:f(w.caratula)})]}),parseInt(w.caratula)===4&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-orange"}),e.jsx("span",{className:"badge text-bg-orange text-white shadow-sm",children:f(w.caratula)})]})]})]}),w.contenido&&e.jsx("p",{className:"mb-3",children:w.contenido}),((D=w.enlace)==null?void 0:D.length)>0&&e.jsx("p",{className:"text-center",children:w.enlace.map((y,S)=>e.jsxs("a",{href:C(y),target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none d-flex align-items-center gap-2 rounded-pill",style:{maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:[e.jsx("i",{className:"bi bi-browser-chrome titilar",style:{fontSize:"20px"}}),y]},S))}),e.jsx("div",{className:"d-flex justify-content-center flex-wrap align-items-center gap-3 mt-3",children:(p=w.asociada)==null?void 0:p.map((y,S)=>{const F=i.find(_=>(_.nombre_apellido||"").toLowerCase()===(y||"").toLowerCase());return e.jsxs("div",{className:"d-flex align-items-center gap-2 border rounded shadow-sm p-2",style:{minWidth:"150px"},onClick:()=>b(w.id),children:[(F==null?void 0:F.base64)&&e.jsx("img",{src:F.base64,alt:F.nombre_apellido,className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("span",{className:"text-capitalize",children:[S+1,". ",y]})]},S)})})]})]},w.id)}),u&&g.length>0&&e.jsx("div",{className:"modal fade bg-dark show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-dialog-scrollable ",children:e.jsxs("div",{className:"modal-content bg-gradiante2",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title",children:["Personas Asociadas ",g.length," "]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:m})]}),e.jsx("div",{className:"modal-body ",children:e.jsx("div",{className:"row ",children:g.map((w,D)=>e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"card text-center p-2 bg-dark bg-opacity-75 rounded-4 shadow-lg text-light",children:[e.jsx("img",{src:w.base64||"default-image-url.jpg",alt:w.nombre_apellido,className:"card-img-top",style:{height:"200px",objectFit:"cover"}}),e.jsxs("div",{className:"card-body text-center text-capitalize ",children:[e.jsx("h5",{className:"card-title text-blueMui ",children:w.nombre_apellido}),e.jsxs("p",{children:[e.jsx("strong",{children:"Documento:"})," ",w.documento]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Motivo Captura:"})," ",w.motivo_captura]}),w.descripcion_fisica&&e.jsxs("p",{children:[e.jsx("strong",{children:"Información :"})," ",w.descripcion_fisica]})]})]})},D))})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn  text-center p-2 bg-dark bg-opacity-50  shadow-lg text-white ",onClick:m,children:"Cerrar"})})]})})})]})})}const Oi=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(Ti,{}),e.jsx(Ce,{})]})})},Bi=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-primary bg-gradiante ",children:[e.jsx(De,{}),e.jsx(Oi,{}),e.jsx(je,{})]})}),Ui=({show:s,onClose:r,datos:t})=>{a.useState(!1);const[c,i]=a.useState(!1);return a.useEffect(()=>{if(s){window.history.pushState({modalOpen:!0},"");const l=n=>{r()};return window.addEventListener("popstate",l),()=>{window.removeEventListener("popstate",l)}}},[s]),s?e.jsxs("div",{className:"modal fade show bg-dark",style:{display:"block"},"aria-labelledby":"captureDetailsModalLabel","aria-hidden":"false",children:[e.jsx("div",{className:"modal-dialog   ",children:e.jsxs("div",{className:"modal-content bg-gradiante2 bg-opacity-75 border-0",children:[e.jsx("div",{className:"modal-header",children:e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:r})}),e.jsxs("div",{className:"modal-body text-center text-white",children:[e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:()=>i(!0),children:[e.jsx("div",{className:"fs-5 position-absolute top-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-top small",style:{opacity:.8},children:t.documento}),e.jsx("img",{src:t.base64&&t.base64.trim()!==""&&t.base64.trim()!=="null"?t.base64:"https://via.placeholder.com/150",className:"img-fluid mb-3 shadow-lg ",alt:t.nombre_apellido||"Imagen no disponible",style:{width:"500px",height:"auto"},loading:"lazy"}),e.jsx("div",{className:"fs-1 position-absolute text-capitalize bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:t.nombre_apellido})]}),e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4",children:["Datos de la Solicitud ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-white border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-purpleUi me-2",children:"Motivo Captura"})}),t.motivo_captura&&t.motivo_captura.trim()!==""?e.jsx("p",{className:"form-control bg-blueW2 text-dark",style:{minHeight:"auto"},children:t.motivo_captura}):null,(!t.motivo_captura||t.motivo_captura.trim()==="")&&e.jsxs("button",{className:"btn btn-sm btn-primary mx-4",onClick:()=>alert("Solicitud enviada. La información que requirió se le informará a los cargadores de captura para su carga. 🏤"),children:["Solicitar Información ",e.jsx("i",{className:"bi bi-person-raised-hand"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-purpleUi text-white me-2",children:"Información Adicional"})}),t.descripcion_fisica&&t.descripcion_fisica.trim()!==""?e.jsx("p",{className:"form-control bg-blueW2 text-dark",style:{minHeight:"auto"},children:t.descripcion_fisica}):null,(!t.descripcion_fisica||t.descripcion_fisica.trim()==="")&&e.jsxs("button",{className:"btn btn-sm btn-primaryM mx-4",onClick:()=>alert("Solicitud enviada. La información que requirió se le informará a los cargadores de captura para su carga. 🏤"),children:["Solicitar Información ",e.jsx("i",{className:"bi bi-person-raised-hand"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("hr",{className:"border border-white border-1 opacity-75"}),t.entidad&&t.entidad.trim()!==""&&e.jsxs("span",{className:"badge text-bg-primaryM text-white my-1 text-capitalize mx-3 p-2",children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),"Solicita - ",t.entidad]}),t.numero_contacto&&t.numero_contacto.trim()!==""&&e.jsxs("span",{className:"badge text-bg-primaryM text-white my-1 text-capitalize mx-3 p-2",children:[e.jsx("i",{className:"bi bi-telephone-forward-fill me-2"}),"Contactar ",t.numero_contacto]})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white",onClick:r,children:e.jsx("i",{className:"bi bi-x-lg"})})})]})}),c&&e.jsx("div",{className:"modal fade show d-flex align-items-center justify-content-center bg-dark ",style:{display:"block",width:"100vw",height:"100vh",position:"fixed",top:0,left:0,zIndex:1050},onClick:()=>i(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:l=>l.stopPropagation(),children:e.jsxs("div",{className:"modal-content bg-transparent border-0 text-center",children:[e.jsx("button",{type:"button",className:"btn-close btn-close-dark position-absolute top-0 end-0 m-3 bg-red",onClick:()=>i(!1)}),e.jsx("img",{src:t.base64||"https://via.placeholder.com/40",alt:"Imagen Ampliada",className:"img-fluid rounded shadow-lg",style:{maxWidth:"200vw",maxHeight:"200vh",objectFit:"contain"}})]})})})]}):null},qi=({show:s,onClose:r,datos:t})=>{var o;const[c,i]=a.useState(!1),[l,n]=a.useState(!1);return a.useEffect(()=>{if(location.pathname==="/dashboard"){const x=()=>{r()};return window.history.pushState(null,document.title),window.addEventListener("popstate",x),()=>{window.removeEventListener("popstate",x)}}},[r]),s?e.jsxs("div",{className:"modal fade show bg-dark",style:{display:"block"},"aria-labelledby":"captureDetailsModalLabel","aria-hidden":"false",children:[e.jsx("div",{className:"modal-dialog modal-dialog-centered ",children:e.jsxs("div",{className:"modal-content bg-gradiante2 border-0",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{className:"modal-title text-center text-white fw-semibold",children:"Detalles de la Captura 👮"}),e.jsx("button",{type:"button",className:"btn-close btn-close-dark",onClick:r})]}),e.jsxs("div",{className:"modal-body text-white",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 d-flex justify-content-center align-items-start mb-3",children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:()=>n(!0),children:[e.jsx("img",{src:t.base64||"https://via.placeholder.com/150",alt:t.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle shadow mt-2",style:{width:"130px",height:"130px",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:"Capturado"})]})}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("small",{className:"d-flex gap-2 justify-content-end mb-1",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-white border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control text-center text-capitalize",value:t.nombre_apellido,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control text-center",value:t.documento,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Documento"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end",children:["Detalles de la Captura ",e.jsx("i",{className:"bi bi-journal-text"})]}),e.jsx("hr",{className:"border border-white border-1 opacity-75"}),((o=t.capturas_informacion_estados)==null?void 0:o.length)>0?e.jsxs(e.Fragment,{children:[t.capturas_informacion_estados.slice().reverse().slice(0,c?t.capturas_informacion_estados.length:1).map((x,h)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:`rounded-pill px-3 py-2 text-white ${x.captura_fecha?"bg-primary":"bg-secondaryMuiRed"}`,children:[e.jsx("strong",{className:"me-3",children:x.captura_autor||"Sistema"}),x.captura_fecha||x.captura_quita_fecha]}),x.captura_fecha&&e.jsxs("p",{children:["Relato: ",e.jsx("span",{className:"fw-semibold",children:x.captura_descripcion||"Sin relato"})]})]},h)),t.capturas_informacion_estados.length>1&&e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"btn btn-link text-white text-decoration-none",onClick:()=>i(!c),children:c?"Ver menos":"Ver historial completo"})})]}):e.jsx("p",{className:"text-center",children:"No hay detalles de captura disponibles."})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white",onClick:r,children:e.jsx("i",{className:"bi bi-x-lg"})})})]})}),l&&e.jsx("div",{className:"modal fade show d-flex align-items-center justify-content-center bg-dark",style:{display:"block",width:"100vw",height:"100vh",position:"fixed",top:0,left:0,zIndex:1050},onClick:()=>n(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:x=>x.stopPropagation(),children:e.jsxs("div",{className:"modal-content bg-transparent border-0 text-center",children:[e.jsx("button",{type:"button",className:"btn-close btn-close-dark position-absolute top-0 end-0 m-3 bg-red",onClick:()=>n(!1)}),e.jsx("img",{src:t.base64||"https://via.placeholder.com/150",alt:"Imagen Ampliada",className:"img-fluid rounded shadow-lg",style:{maxWidth:"90vw",maxHeight:"90vh",objectFit:"contain"}})]})})})]}):null};function Vi({setGridView:s,gridView:r,sortOrder:t,setSortOrder:c,sortBy:i,setSortBy:l,searchTerm:n,setSearchTerm:o,priorityFilter:x,setPriorityFilter:h,currentPage:u,handlePriorityChange:j}){const[g,N]=a.useState(!1),d=()=>{N(!1),l("fecha"),c("desc"),h([])};return e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"w-75 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Personas"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-people-fill fs-4 text-dark"})})]}),e.jsx("form",{className:"d-flex justify-content-center my-4",onSubmit:b=>b.preventDefault(),children:e.jsxs("div",{className:"input-group input-group-lg w-100",style:{maxWidth:"600px"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar en Rosario...","aria-label":"Buscar",value:n,onChange:b=>o(b.target.value)}),e.jsx("button",{className:"btn btn-outline-light",type:"submit",children:e.jsx("i",{className:"bi bi-search"})})]})}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:[e.jsx("button",{type:"button",onClick:()=>s(!0),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${r?"active":""}`,title:"Vista en cuadrícula",children:e.jsx("i",{className:`bi bi-grid-3x3-gap-fill fs-5 ${r?"titilar":""}`})}),e.jsx("button",{type:"button",onClick:()=>s(!1),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${r?"":"active"}`,title:"Vista en lista",children:e.jsx("i",{className:`bi bi-list fs-5 ${r?"":"titilar"}`})}),e.jsx("button",{type:"button",onClick:()=>N(!g),className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",title:"Mostrar/Ocultar filtros",children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})]}),g&&e.jsxs("div",{className:"card shadow  bg-dark p-4 bg-opacity-25  rounded-4 shadow-lg text-white",style:{backgroundColor:"transparent",color:"white"},children:[e.jsxs("div",{className:"card-header fw-semibold  bg-primary bg-opacity-50 rounded-4  text-white d-flex justify-content-between align-items-center border-bottom border-white",children:[e.jsxs("span",{children:[e.jsx("i",{className:"bi bi-sort-alpha-down mx-1"})," Filtros de Galería"]}),e.jsx("i",{className:"bi bi-x-lg cursor-pointer",onClick:d,style:{cursor:"pointer"}})]}),e.jsxs("div",{className:"card-body ",children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select   border-white shadow-sm text-center ",value:i,onChange:b=>l(b.target.value),children:[e.jsx("option",{value:"fecha",children:"Fecha"}),e.jsx("option",{value:"nombreApellido",children:"Nombre"})]}),e.jsx("label",{className:" p-2",children:"Filtrar por"})]})}),e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"form-floating ",children:[e.jsx("select",{className:"form-select  border-white shadow-sm text-center",value:t,onChange:b=>c(b.target.value),children:i==="fecha"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"asc",children:"Antiguo - Reciente"}),e.jsx("option",{value:"desc",children:"Reciente - Antiguo"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"asc",children:"A - Z"}),e.jsx("option",{value:"desc",children:"Z - A"})]})}),e.jsx("label",{className:" p-2",children:"Ordenar Prioridad"})]})})]}),e.jsx("div",{className:"border border-white shadow-sm rounded-4 p-4 mb-4 text-white",children:e.jsxs("div",{className:"d-flex flex-wrap justify-content-center mb-3",children:[["No Prioritarias","Paradero","Evadidos","Prioritarias"].map((b,m)=>e.jsxs("div",{className:"form-check form-check-inline mb-2",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",value:m+1,checked:x.includes((m+1).toString()),onChange:j,disabled:u!==1,style:{cursor:u===1?"pointer":"not-allowed"}}),e.jsx("label",{className:"form-check-label text-white",children:b})]},m)),x.length>0&&e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white shadow-sm mx-2",onClick:()=>h([]),children:e.jsx("i",{className:"bi bi-trash"})})]})})]})]})]})})})}const hs=15;function Os(s){const[r,t,c]=s.split("/").map(Number),i=2e3+c;return new Date(i,t-1,r)}const Gi=()=>{const[s,r]=a.useState(!1),[t,c]=a.useState(!1),[i,l]=a.useState(!1),[n,o]=a.useState([]),[x,h]=a.useState(1),[u,j]=a.useState(0),[g,N]=a.useState(null),[d,b]=a.useState(null),[m,f]=a.useState(null),[C,v]=a.useState(null),[w,D]=a.useState(!0),[p,y]=a.useState(!1),[S,F]=a.useState(null),[_,k]=a.useState("fecha"),[M,$]=a.useState("desc"),[U,Q]=a.useState(""),[H,V]=a.useState(!0),[ie,oe]=a.useState(""),[J,Z]=a.useState(!0),L=async()=>{try{D(!0);const R=await X(Y(A,"db_personas")),O=[];R.forEach(ee=>{const K={id:ee.id,...ee.data()};O.push(K)}),o(O),j(Math.ceil(O.length/hs))}catch(R){console.error("Error obteniendo documentos: ",R),F("No se pudieron cargar los documentos.")}finally{D(!1)}};a.useEffect(()=>{L()},[]);const G=R=>{const O=R.target.value;oe(ee=>ee.includes(O)?ee.filter(K=>K!==O):[...ee,O])},se=a.useMemo(()=>n.filter(R=>{var K;const O=(K=R.nombre_apellido)==null?void 0:K.toLowerCase().includes(U.toLowerCase()),ee=ie.length===0||ie.includes(String(R.prioridad));return O&&ee}),[n,U,ie]),ae=a.useMemo(()=>se.sort((R,O)=>{if(R.prioridad===3&&O.prioridad!==3)return-1;if(O.prioridad===3&&R.prioridad!==3)return 1;if(R.prioridad===4&&O.prioridad!==4)return-1;if(O.prioridad===4&&R.prioridad!==4)return 1;if(_==="fecha"){const ee=Os(R.date)||0,K=Os(O.date)||0;return M==="asc"?ee-K:K-ee}else return M==="asc"?R.nombre_apellido.localeCompare(O.nombre_apellido):O.nombre_apellido.localeCompare(R.nombre_apellido)}),[se,_,M]),re=(x-1)*hs,ue=ae.slice(re,re+hs),I=()=>{x<u&&(y(!0),h(R=>R+1),setTimeout(()=>y(!1),500))},P=()=>{x>1&&(y(!0),h(R=>R-1),setTimeout(()=>y(!1),500))},T=R=>{v(!0),b(R)},z=()=>{N(null),v(null)},B=R=>{f(!0),b(R)},E=()=>f(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Vi,{setGridView:V,gridView:H,sortOrder:M,sortBy:_,setSortOrder:$,setSortBy:k,searchTerm:U,setSearchTerm:Q,showFilters:J,priorityFilter:ie,setPriorityFilter:oe,currentPage:x,handlePriorityChange:G}),e.jsxs("div",{className:"container-lg",children:[w&&e.jsx(ne,{}),S&&e.jsx("div",{className:"alert alert-danger",children:S}),p?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ne,{})}):e.jsx("div",{className:H?"row mt-5":"d-flex flex-column align-items-center mt-5",children:ue.map(R=>e.jsx("div",{className:H?"col-6 col-sm-6 col-md-4 mb-4":"col-12 col-sm-6 col-md-6 mb-4",children:e.jsx("div",{className:"card py-4  shadow-sm text-center bg-dark bg-opacity-50  rounded-4",children:e.jsxs("div",{className:"position-relative",children:[R.alerta&&!R.captura&&e.jsx("div",{onClick:()=>c(!t),children:t?e.jsx("div",{className:"position-absolute top-1  start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:" bi bi-exclamation-triangle-fill me-2 text-white titilar fs-5 shadow-sm "}),"Evadido ",R.date," "]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-redUi1   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-exclamation-triangle-fill fs-5 mx-1 text-white titilar "})})}),R.paradero&&e.jsx("div",{onClick:()=>r(!s),children:s?e.jsx("div",{className:"position-absolute top-1 bg-blueMui start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:" bi bi-search fs-5 mx-2 text-white  "}),"Paradero "]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-blueMui   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-search fs-5 mx-1 text-white "})})}),R.prioridad===4&&e.jsx("div",{onClick:()=>l(!i),children:i?e.jsx("div",{className:"position-absolute top-1 bg-yellowMui start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:"bi bi-star-fill fs-5 mx-2 text-white "}),"Prioritaria"]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-yellowMui   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-star-fill fs-5 mx-1 text-white "})})}),R.captura&&e.jsxs("div",{className:"captura-cinta",style:{maxWidth:"100%"},onClick:()=>B(R),children:[e.jsx("span",{children:"Capturado"}),e.jsx("span",{children:e.jsx("button",{className:"btn p-0 text-white ms-2 d-none d-md-inline",onClick:O=>{O.stopPropagation(),B(R)},children:"Ver detalles"})})]}),e.jsx("div",{}),e.jsx("img",{src:R.base64&&R.base64.trim()!==""&&R.base64.trim()!=="null"?R.base64:fe,className:`card-img-top img-fluid  ${R.captura?"grayscale":""}`,alt:R.nombre_apellido||"Imagen no disponible",loading:"lazy",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"cover"},onClick:()=>T(R)}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-white text-capitalize",children:R.nombre_apellido}),e.jsx("p",{className:"card-text text-white",children:R.unidad_comisaria}),e.jsx("button",{onClick:()=>T(R),className:"btn btn-outline-light bg-dark bg-opacity-50",children:"Ver detalles"})]})]})})},R.id))}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center mt-4",children:[x>1&&e.jsx("button",{className:"btn btn rounded-pill shadow-sm text-center bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",onClick:P,children:e.jsx("i",{className:"bi bi-arrow-left fw-semibold fs-3 titilar"})}),e.jsxs("span",{className:"fs-6 mx-3 ",children:["Página ",x," de ",u]}),x<u&&e.jsx("button",{className:"btn rounded-pill shadow-sm text-center bg-dark bg-opacity-50 rounded-4 shadow-lg text-white ",onClick:I,children:e.jsx("i",{className:"bi bi-arrow-right fw-semibold fs-3 titilar"})})]})]}),e.jsx(Ui,{show:C,datos:d,onClose:z}),e.jsx(qi,{show:m,datos:d,onClose:E})]})},Wi=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(Gi,{}),e.jsx(Ce,{})]})})},Hi=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-primaryM bg-gradiante2",children:[e.jsx(De,{}),e.jsx(Wi,{}),e.jsx(je,{})]})}),Bs=({onImageSave:s})=>{const[r,t]=a.useState(!1),[c,i]=a.useState(null),[l,n]=a.useState(""),o=a.useRef(null),[x,h]=a.useState(!1),[u,j]=a.useState({x:0,y:0}),[g,N]=a.useState({x:0,y:0}),[d,b]=a.useState(1),m=a.useRef(null),f=S=>{h(!0);const{offsetX:F,offsetY:_}=S.nativeEvent;N({x:F,y:_})},C=S=>{if(!x||!c)return;const{offsetX:F,offsetY:_}=S.nativeEvent;j(k=>({x:k.x+(F-g.x),y:k.y+(_-g.y)})),N({x:F,y:_})},v=()=>{h(!1)},w=()=>{t(!1),n(""),i(null),j({x:0,y:0}),b(1);const S=document.getElementById("file-input");S&&(S.value=""),m.current&&(URL.revokeObjectURL(m.current),m.current=null)},D=()=>t(!0),p=S=>{const F=S.target.files[0];if(F){if(!F.type.startsWith("image/")){n("Por favor, selecciona un archivo de imagen.");return}if(F.size>5*1024*1024){n("La imagen debe ser menor de 5 MB.");return}const _=URL.createObjectURL(F);m.current=_,i(_),n("")}},y=()=>{if(!c||!o.current){n("Por favor, selecciona una imagen antes de guardar.");return}const S=o.current,F=S.width,_=S.height,k=document.createElement("canvas");k.width=F,k.height=_;const M=k.getContext("2d"),$=new Image;$.src=c,$.onload=()=>{M.clearRect(0,0,F,_),M.drawImage($,u.x,u.y,$.width*d,$.height*d);const U=k.toDataURL("image/jpeg",.92);s(U),w()}};return a.useEffect(()=>{if(c&&o.current){const S=o.current,F=S.getContext("2d"),_=new Image;_.src=c,_.onload=()=>{F.clearRect(0,0,S.width,S.height),F.drawImage(_,u.x,u.y,_.width*d,_.height*d)}}},[c,u,d]),a.useEffect(()=>{const S=o.current,F=_=>{if(_.preventDefault(),!c)return;const k=1.1,M=_.deltaY<0?d*k:d/k;b(Math.max(M,.1))};if(S)return S.addEventListener("wheel",F,{passive:!1}),()=>{S.removeEventListener("wheel",F)}},[c,d]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:e.jsxs("button",{type:"button",onClick:D,className:"btn btn-outline-light d-flex align-items-center gap-2 px-4 py-2 rounded-3 shadow-sm",children:[e.jsx("span",{className:"fw-semibold",children:"Agregar Nueva Captura"}),e.jsx("i",{className:"bi bi-plus-circle-fill fs-5"})]})}),e.jsx("div",{className:`modal fade  bg-gradiante2 ${r?"show":""}`,style:{display:r?"block":"none"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!r,children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-header bg-gradiante2",children:e.jsx("h5",{className:"modal-title text-light  ",id:"modalLabel ",children:"Selecciona tu imagen  / Edita "})}),e.jsxs("div",{className:"modal-body",children:[e.jsx("input",{id:"file-input",type:"file",className:"form-control",accept:"image/*",onChange:p}),c&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("canvas",{ref:o,className:"shadow",onMouseDown:f,onMouseMove:C,onMouseUp:v,onMouseLeave:v,width:500,height:500,style:{border:"1px solid black",cursor:x?"grabbing":"grab"}})}),e.jsxs("p",{className:"alert alert-light text-redUi1 fs-6 text-center mt-4 d-flex justify-content-center align-items-center gap-2",children:[e.jsx("span",{className:"spinner-grow text-pink",style:{width:"1rem",height:"1rem"},role:"status"}),"Para hacer zoom en la imagen, simplemente usa el scroll (la rueda) de tu mouse. 🖲️"]}),e.jsxs("p",{className:"alert alert-light text-indigoMui fs-6 text-center mt-4 d-flex justify-content-center align-items-center gap-2",children:[e.jsx("span",{className:"spinner-grow text-indigoMui",style:{width:"1rem",height:"1rem"},role:"status"}),"Mantén presionado el botón del mouse para arrastrar la imagen. 🖱️"]})]}),l&&e.jsx("div",{className:"mt-2 text-danger",children:l})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:w,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn text-white bg-indigoMui",onClick:y,children:"Guardar Imagen"})]})]})})}),e.jsx("div",{className:`modal-backdrop fade ${r?"show":""}`,style:{display:r?"block":"none"}})]})},Yi=({onSubmit:s,savedImage:r,resetImage:t,formRef:c})=>{const[i,l]=a.useState(()=>{const C=localStorage.getItem("formData");return C?JSON.parse(C):{nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,captura:!1,prioridad:1,alertaParaderoCaptura:""}}),[n,o]=a.useState({}),[x,h]=a.useState(!1),[u,j]=a.useState(!1),[g,N]=a.useState("");a.useEffect(()=>{localStorage.setItem("formData",JSON.stringify(i))},[i]);const d=({target:{id:C,value:v,type:w,checked:D}})=>{l(p=>{let y={...p,[C]:w==="checkbox"?D:v};if(C==="alertaParaderoCaptura")switch(v){case"paradero":y={...y,prioridad:2,paradero:!0,alerta:!1};break;case"evadido":y={...y,prioridad:3,captura:!0,alerta:!0};break;case"prioritaria":y={...y,prioridad:4,alerta:!1};break;default:y={...y,prioridad:1,paradero:!1,alerta:!1};break}return y}),o(p=>({...p,[C]:""}))},b=()=>{const C={};return r?(i.nombreApellido.match(/[A-Za-zÑñÁáÉéÍíÓóÚú\s]+/)||(C.nombreApellido="Ingrese solo letras y espacios."),i.documento.length<6&&(C.documento="El número de documento debe tener al menos 6 caracteres."),o(C),Object.keys(C).length===0):(alert("Debes cargar una imagen antes de enviar el formulario."),N("Debes cargar una imagen antes de enviar el formulario."),j(!0),!1)},m=async C=>{if(C.preventDefault(),!b())return;if(!window.confirm("¿Estás seguro de que deseas enviar este formulario?")){alert("El envío ha sido cancelado.");return}h(!0);try{const w={...i,imagen:r};if(typeof s=="function")await s(w),alert("Formulario enviado correctamente."),N("Formulario enviado correctamente."),j(!0);else throw new Error("onSubmit no es una función válida")}catch(w){console.error(w),alert("Hubo un error al enviar el formulario."),N("Hubo un error al enviar el formulario."),j(!0)}finally{h(!1),f()}},f=()=>{localStorage.removeItem("formData"),l({nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,prioridad:1,alertaParaderoCaptura:""}),o({}),t()};return e.jsxs("div",{className:" mt-3",children:[x&&e.jsx(ne,{})," ",u&&e.jsx(ks,{message:g,onClose:()=>j(!1)}),e.jsxs("form",{ref:c,onSubmit:m,children:[e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-person-fill text-greenUi me-3 p-1"})," Nombre y Apellido"]}),id:"nombreApellido",type:"text",value:i.nombreApellido,error:n.nombreApellido,onChange:d,required:!0,className:"text-center"}),e.jsxs("div",{className:"row  text-center",children:[e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-file-earmark-person text-greenUi me-3 p-1"})," Número de Documento"]}),id:"documento",type:"number",value:i.documento,error:n.documento,onChange:d,className:"col"}),e.jsx(Us,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-gender-ambiguous text-greenUi me-3 p-1"})," Sexo"]}),id:"sexo",value:i.sexo,options:[{label:"Seleccione",value:""},{label:"Masculino 👨",value:"masculino"},{label:"Femenino 👩",value:"femenino"},{label:"Otros 👭🏻 ",value:"otro"}],onChange:d,className:"col"})]}),e.jsxs("div",{className:"row  text-center",children:[e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-building text-greenUi me-3 p-1"})," Entidad Solicita Captura"]}),id:"entidad",type:"text",value:i.entidad,onChange:d,className:"col"}),e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-telephone text-greenUi me-3 p-1"})," Número de Contacto"]}),id:"numeroContacto",type:"tel",value:i.numeroContacto,error:n.numeroContacto,onChange:d,className:"col"})]}),e.jsx(qs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil text-greenUi me-3 p-1"})," Datos de la Persona / Info Adicional"]}),id:"descripcionFisica",value:i.descripcionFisica,onChange:d,className:"text-center"}),e.jsx(qs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil-square text-greenUi me-3 p-1"})," Motivo  Captura "]}),id:"motivoCaptura",value:i.motivoCaptura,onChange:d,className:"text-center"}),e.jsx(Us,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill p-1 text-white me-3 titilar "})," Selecciona una Tipo de Alerta"]}),id:"alertaParaderoCaptura",value:i.alertaParaderoCaptura,options:[{label:"Normal",value:"normal"},{label:"Búsqueda Paradero 🔍 ",value:"paradero"},{label:"Alerta Evadido 🚨",value:"evadido"},{label:"Captura Prioritaria ⚠️",value:"prioritaria"}],onChange:d}),e.jsxs("div",{className:"d-flex justify-content-end pt-4  mt-3",children:[e.jsxs("button",{type:"button",onClick:f,className:"btn btn-danger text-light shadow",children:[e.jsx("i",{className:"bi bi-x-circle "})," Limpiar Formulario"]}),e.jsxs("button",{type:"submit",className:"btn btn-primary2 shadow ms-2",disabled:x,children:[e.jsx("i",{className:"bi bi-send"})," Enviar Formulario"]})]})]})]})},Ze=({label:s,id:r,type:t="text",value:c,error:i,onChange:l,className:n="",required:o=!1})=>e.jsxs("div",{className:`mb-4 ${n}`,children:[e.jsx("span",{htmlFor:r,className:"input-group-text bg-gradiante2 border-white  text-white text-center mb-1",children:s}),e.jsx("input",{type:t,className:`form-control bg-transparent text-white border-white ${i?"is-invalid":""}`,id:r,value:c,onChange:l,required:o}),e.jsx("div",{className:"invalid-feedback text-light",children:i})]}),Us=({label:s,id:r,value:t,options:c,onChange:i,className:l=""})=>e.jsxs("div",{className:`mb-5 ${l} text-center`,children:[e.jsx("span",{htmlFor:r,className:`input-group-text bg-gradiante2 text-white text-center d-flex justify-content-center shadow ${r==="alertaParaderoCaptura"?"bg-danger text-white":""}`,children:s}),e.jsx("select",{className:"form-select text-center",id:r,value:t,onChange:i,style:{color:"white",backgroundColor:"transparent",borderColor:"white"},children:c.map(({label:n,value:o})=>e.jsx("option",{value:o,style:{backgroundColor:"#5F3F8B",color:"white"},children:n},o))})]}),qs=({label:s,id:r,value:t,onChange:c,className:i=""})=>e.jsxs("div",{className:`form-floating mb-4 ${i}`,children:[e.jsx("textarea",{className:"form-control bg-transparent text-white border-white",id:r,value:t,onChange:c,style:{height:"100px"},placeholder:" "}),e.jsx("label",{htmlFor:r,className:"text-",children:s})]}),Ji=()=>{const[s,r]=a.useState(null),[t,c]=a.useState(!1),[i,l]=a.useState(!1),[n,o]=a.useState(!1),x=a.useRef(null);a.useEffect(()=>{const N=()=>{c(window.innerWidth<576)};return window.addEventListener("resize",N),N(),()=>window.removeEventListener("resize",N)},[]);const h=N=>{r(N),l(!1)},u=async N=>{var C;const d=()=>{const v=new Date,w=String(v.getDate()).padStart(2,"0"),D=String(v.getMonth()+1).padStart(2,"0"),p=String(v.getFullYear()).slice(-2);return`${w}/${D}/${p}`},m=(()=>{const v=localStorage.getItem("user");return v?JSON.parse(v):null})(),f={documento:N.documento,nombre_apellido:N.nombreApellido.toLowerCase(),sexo:N.sexo,entidad:N.entidad,numero_contacto:N.numeroContacto,descripcion_fisica:N.descripcionFisica,motivo_captura:N.motivoCaptura,base64:s,date:d(),usuario:m?m.email:"Desconocido",prioridad:N.prioridad,alerta:N.alerta||!1,paradero:N.paradero||!1};try{await ye(Y(A,"db_personas"),f),console.log("Datos guardados en Firebase:",f),(C=x.current)==null||C.reset(),j()}catch(v){console.error("Error al guardar los datos en Firebase:",v)}},j=()=>{r(null),l(!1),o(!1)},g=N=>{const d=N.target.files[0];if(d){const b=new FileReader;b.onloadend=()=>{const m=new Image;m.onload=()=>{const f=document.createElement("canvas"),C=f.getContext("2d"),v=500,w=500;let D=m.width,p=m.height;D>p?D>v&&(p*=v/D,D=v):p>w&&(D*=w/p,p=w),f.width=D,f.height=p,C.drawImage(m,0,0,D,p);const y=f.toDataURL("image/jpeg");r(y),l(!1)},m.src=b.result},b.readAsDataURL(d)}};return e.jsx(e.Fragment,{children:n?e.jsx("div",{className:"container",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10 col-lg-8 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Formulario"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-ui-checks fs-4 text-dark"})})]}),e.jsx("p",{className:"mt-2 text-white-50",children:"Gestioná tus registros de ingreso."}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-md-5 mb-4",children:e.jsxs("div",{className:"text-center position-relative",children:[!i&&s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-secondaryM text-purple position-absolute end-0 top-0 mt-5 m-2","aria-label":"Editar",onClick:()=>{r(null),l(!0)},children:e.jsx("i",{className:"bi bi-pencil-fill"})}),e.jsx("h5",{className:"text-light mt-4",children:"Vista previa de la imagen guardada:"}),e.jsx("img",{src:s,alt:"Captura subida",className:"img-fluid rounded-4 border border-light shadow mt-2",style:{maxWidth:"100%"}})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"text-light",children:"Subí una nueva imagen"}),t?e.jsx("div",{className:"mb-3 w-100 px-3",children:e.jsx("input",{type:"file",className:"form-control bg-gradiante2 text-white",onChange:N=>{g(N)}})}):e.jsx(Bs,{onImageSave:N=>{h(N)}})]})]})}),e.jsx("div",{className:"col-12 col-md-7",children:e.jsx(Yi,{onSubmit:u,savedImage:s,resetImage:j,formRef:x})})]})]})})})}):e.jsx("div",{className:"w-75 text-white",children:e.jsxs("div",{className:"text-center py-5 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("h2",{className:"mb-4 display-5 fw-bold",children:"Subí una imagen para comenzar"}),e.jsx("div",{className:"d-flex justify-content-center align-items-center gap-3",children:t?e.jsxs("div",{className:"mb-3 w-100 px-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Subir solo Imagen "}),e.jsx("input",{type:"file",className:"form-control bg-gradiante2 text-white",onChange:N=>{g(N),o(!0)}})]}):e.jsx(Bs,{onImageSave:N=>{h(N),o(!0)}})})]})})})},Zi=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(Ji,{}),e.jsx(Ce,{})]})})},Qi=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-primaryM bg-gradiante2",children:[e.jsx(De,{}),e.jsx(Zi,{}),e.jsx(je,{})]})}),Xi=({recepciones:s,loading:r})=>e.jsx("div",{className:" text-center mt-4",children:r?e.jsx("div",{className:"spinner-border text-white",role:"status"}):Object.keys(s).length>0?e.jsxs("div",{className:"text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("strong",{className:"fw-light fs-6 text-capitalize",children:"Recepciones pendientes por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,c],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-primaryMuiBlue spinner-grow-sm",role:"status"}),e.jsx("span",{children:t}),e.jsxs("span",{className:"badge bg-primaryMuiBlue",children:[c," pendientes"]})]},i))})]}):e.jsx("div",{className:"alert alert-primary",children:e.jsx("strong",{children:"No hay recepciones pendientes en este momento."})})}),Ki=({notificaciones:s,loading:r,aceptarRecepcion:t,rechazarRecepcion:c})=>{const[i,l]=a.useState(""),[n,o]=a.useState(!1),[x,h]=a.useState(null),[u,j]=a.useState(""),[g,N]=a.useState(!1),d=async()=>{if(!x)return;N(!0);const{id:m,comisaria:f}=x,C=ds[f];setTimeout(()=>{u&&u===C?(t(m),l(""),o(!1),j("")):l(`El código ingresado "${u}" es incorrecto.`),N(!1)},1e3)},b=m=>{h(m),o(!0),l(""),j("")};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("h1",{className:"display-4 fw-bold",children:["Validar Ingreso 10 Bis ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("p",{className:"lead",children:"Administra las recepciones de este  articulo."})]})})}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-4",children:e.jsx("div",{className:"position-relative",children:r?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border text-white ",role:"status","aria-label":"Cargando...",children:" "})]}):e.jsxs("div",{className:"list-group",children:[i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i}),s&&s.length>0?s.map(m=>e.jsxs("div",{className:"list-group-item mb-3 shadow",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:m.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:m.dni})]}),e.jsxs("div",{className:"d-flex flex-wrap justify-content-end row",children:[e.jsx("div",{className:"col mb-1",children:e.jsxs("button",{className:"btn btn-primary btn-sm me-2 mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>b(m),"aria-label":`Aceptar recepción para ${m.nombre_apellido} en la Comisaría ${m.comisaria}`,children:["Aceptar ",e.jsx("i",{className:"bi bi-check-all ms-2"})]})}),e.jsx("div",{className:"col",children:e.jsxs("button",{className:"btn btn-pink btn-sm mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>c(m.id),"aria-label":`Cancelar recepción para ${m.nombre_apellido}`,children:["Cancelar ",e.jsx("i",{className:"bi bi-trash ms-2"})]})})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{children:e.jsxs("small",{children:[m.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:m.comisaria})," -"," ",m.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:m.unidad})]})})})]},m.id)):e.jsx("div",{className:"alert alert-info shadow",role:"alert",children:"No se encontraron notificaciones para validar."})]})})})]}),n&&x&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>o(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:x.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:u,onChange:m=>j(m.target.value),placeholder:"Código"}),i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:d,disabled:!u||g,children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>o(!1),children:"Cancelar"})]})]})})})]})},er=()=>{const[s,r]=a.useState([]),[t,c]=a.useState(!1),[i,l]=a.useState(""),n=async()=>{try{c(!0);const j=ge(Y(A,"db_art_diez_bis"),Se("comisaria_recibe","==",!1)),N=(await X(j)).docs.map(d=>({id:d.id,...d.data()}));r(N)}catch(j){console.error("Error al obtener las recepciones pendientes: ",j)}finally{c(!1)}};a.useEffect(()=>{n()},[]);const o=async j=>{try{const g=JSON.parse(localStorage.getItem("user")),N=W(A,"db_art_diez_bis",j);await le(N,{comisaria_recibe:!0,visualidad:!0,fecha_ingreso_validado:Pe(),usuario_validado_ingreso:g.email}),r(d=>d.filter(b=>b.id!==j)),alert("Recepción aceptada correctamente.")}catch(g){console.error("Error al aceptar la recepción: ",g),alert("Hubo un error al aceptar la recepción.")}},x=async j=>{if(window.confirm("¿Estás seguro de que deseas rechazar esta recepción?"))try{const N=W(A,"db_art_diez_bis",j);await xe(N),r(d=>d.filter(b=>b.id!==j)),alert("Recepción rechazada correctamente.")}catch(N){console.error("Error al rechazar la recepción: ",N),alert("Hubo un error al rechazar la recepción.")}},h=s.reduce((j,g)=>{const N=g.comisaria||"Comisaría desconocida";return j[N]=(j[N]||0)+1,j},{}),u=i?s.filter(j=>j.comisaria===i):s;return e.jsx("div",{className:"container-lg mt-5",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 mb-4",children:[e.jsx(Xi,{recepciones:h,loading:t}),e.jsxs("div",{className:"mt-4 p-3 fw-light text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg mt-5",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize  text-white ",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select fw-light",value:i,onChange:j=>l(j.target.value),children:[e.jsx("option",{value:"",className:"fw-light",children:"Todas"}),Object.keys(h).map((j,g)=>e.jsx("option",{value:j,children:j},g))]})]})]}),e.jsx("div",{className:"col-12 col-md-8 mt-4 mt-md-0",children:e.jsx(Ki,{notificaciones:u,loading:t,aceptarRecepcion:o,rechazarRecepcion:x})})]})})},sr=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(er,{}),e.jsx(Ce,{})]})})},ar=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-primary bg-gradiante",children:[e.jsx(De,{}),e.jsx(sr,{})]}),e.jsx(je,{})]}),tr=({recepciones:s,loading:r})=>e.jsx("div",{className:" text-center mt-4",children:r?e.jsx("div",{className:"spinner-border text-white",role:"status"}):Object.keys(s).length>0?e.jsxs("div",{className:"text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("strong",{className:"fw-light fs-6 text-capitalize",children:"Personas visibles por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,c],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-teal spinner-grow-sm",role:"status"}),e.jsx("span",{className:"text-truncate",children:t}),e.jsxs("span",{className:"badge bg-teal",children:[c," personas"]})]},i))})]}):e.jsx("div",{className:"alert alert-primary",children:e.jsx("strong",{children:"No hay recepciones pendientes en este momento."})})}),ir=ds,rr=({dataInfo:s,loading:r,actualizarListado:t})=>{const[c,i]=a.useState(""),[l,n]=a.useState(null),[o,x]=a.useState(""),[h,u]=a.useState(!1),[j,g]=a.useState(null),[N,d]=a.useState({}),[b,m]=a.useState(!1),f=p=>ir[p]||"",C=(p,y)=>{const S=new Date(y.seconds*1e3).getTime()+216e5,F=setInterval(()=>{const _=Date.now(),k=S-_;if(k<=0){clearInterval(F),d(H=>({...H,[p]:"00:00:00"}));return}const M=Math.floor(k/36e5),$=Math.floor(k%36e5/6e4),U=Math.floor(k%6e4/1e3),Q=`${M.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`;d(H=>({...H,[p]:Q}))},1e3);return F},v=async p=>{for(const y of p){const S=y.fecha_ingreso_validado;if(S&&S.seconds){const F=new Date(S.seconds*1e3);if(new Date().getTime()-F.getTime()>36e5){console.log(`Han pasado más de 1 hora desde la salida de ${y.nombre_apellido}`),alert(`Han pasado más de 1 hora el sistema da como salida a  ${y.nombre_apellido} del Articulo 10 bis`);const M=W(A,"db_art_diez_bis",y.id),$=await ze(M);if($.exists()){const U=W(A,"db_art_diez_bis_desactivados",y.id);await me(U,$.data()),await xe(M),await le(U,{visualidad:!1,salida_art:Pe(),salida_art_usuario:"sistema"}),t(),console.log(`Documento copiado, actualizado y eliminado para ${y.nombre_apellido}`)}}}}};a.useEffect(()=>{s&&s.length>0&&(v(s),s.forEach(p=>{p.fecha_ingreso_validado&&p.fecha_ingreso_validado.seconds&&C(p.id,p.fecha_ingreso_validado)}))},[s]);const w=async()=>{if(!j)return;m(!0);const{id:p,comisaria:y}=j,S=f(y);setTimeout(async()=>{if(o&&o===S)try{const F=JSON.parse(localStorage.getItem("user")),_=W(A,"db_art_diez_bis",p),k=await ze(_);if(k.exists()){const M=k.data();await me(W(A,"db_art_diez_bis_desactivados",p),{...M,visualidad:!1,salida_art:Pe(),salida_art_usuario:(F==null?void 0:F.email)||"sistema"}),await xe(_),i(""),alert("Recepción aceptada correctamente."),u(!1),x(""),t()}else alert("El documento no existe.")}catch(F){console.error("Error al aceptar la recepción: ",F),alert("Hubo un error al aceptar la recepción.")}finally{m(!1)}else i(`El código ingresado (${o}) es incorrecto.`),m(!1)},1e3)},D=p=>{g(p),u(!0)};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("h1",{className:"display-4 fw-bold",children:["Validar Salida 10 Bis ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("p",{className:"lead",children:"Administra las recepciones de este  articulo."})]})})}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-4",children:e.jsx("div",{className:"position-relative",children:r?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border text-white ",role:"status","aria-label":"Cargando...",children:" "})]}):e.jsxs("div",{className:"list-group",children:[c&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:c}),s&&s.length>0?s.map(p=>e.jsxs("div",{className:"list-group-item mb-3 shadow",children:[e.jsx("div",{className:"text-end me-2",children:e.jsxs("span",{className:"badge bg-primary",children:[e.jsx("i",{className:"bi bi-clock titilar me-1"})," ",N[p.id]||"Cargando..."]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:p.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:p.dni})]}),e.jsx("button",{className:"btn btn-teal text-white btn-sm w-25",onClick:()=>D(p),disabled:l===p.id,children:l===p.id?"Procesando...":"Finalizar"})]}),e.jsxs("small",{className:"mt-2",children:[p.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:p.comisaria})," - ",p.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:p.unidad})]})]},p.id)):e.jsxs("div",{className:"alert alert-info text-capitalize shadow",role:"alert",children:["No se encontraron Personas en dependencias.",e.jsx("i",{className:"bi bi-hand-thumbs-up ms-2"})]})]})})})]}),h&&j&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>u(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body text-dark",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:j.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:o,onChange:p=>x(p.target.value),placeholder:"Código"}),c&&e.jsx("div",{className:"alert alert-light text-danger mt-3",role:"alert",children:c})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:w,disabled:!o||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>u(!1),children:"Cancelar"})]})]})})})]})},lr=()=>{const[s,r]=a.useState(!1),[t,c]=a.useState(""),[i,l]=a.useState({}),[n,o]=a.useState([]),x=async()=>{try{r(!0);const u=ge(Y(A,"db_art_diez_bis"),Se("visualidad","==",!0)),g=(await X(u)).docs.map(d=>({id:d.id,...d.data()}));o(g);const N=g.reduce((d,b)=>{const m=b.comisaria||"Comisaría desconocida";return d[m]=(d[m]||0)+1,d},{});l(N)}catch(u){console.error("Error al obtener datos: ",u)}finally{r(!1)}};a.useEffect(()=>{x()},[]);const h=t?n.filter(u=>(u.comisaria||"").toLowerCase()===t.toLowerCase()):n;return e.jsx("div",{className:"container-lg mt-5",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 mb-4",children:[e.jsx(tr,{recepciones:i,loading:s}),e.jsxs("div",{className:"mt-4 p-3 fw-light text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg mt-5",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize  text-white ",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select fw-light",value:t,onChange:u=>c(u.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),Object.keys(i).map((u,j)=>e.jsx("option",{value:u,children:u},j))]})]})]}),e.jsx("div",{className:"col-12 col-md-8 mt-4 mt-md-0",children:e.jsx(rr,{dataInfo:h,loading:s,actualizarListado:x})})]})})},nr=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(lr,{}),e.jsx(Ce,{})]})})},or=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-primary bg-gradiante",children:[e.jsx(De,{}),e.jsx(nr,{})]}),e.jsx(je,{})]});Xe.register(Ke,es,ss,Ws,as,ts,Hs,is,rs);const cr=(s,r)=>{const t=parseInt(s.replace("#",""),16),c=Math.max((t>>16)-r,0),i=Math.max((t>>8&255)-r,0),l=Math.max((t&255)-r,0);return`#${(c<<16|i<<8|l).toString(16).padStart(6,"0")}`},dr=({totalCapturas:s,totalPrioridadNormal:r,totalParadero:t,totalEvasiones:c,totalPrioritaria:i,totalEvasionesCapturados:l})=>{const[n,o]=a.useState("bar"),h=["#03dac6","#ffef62","#f73378","#2196f3"],u=()=>{const b={labels:["Capturas Normales","Capturas Prioritarias","Evasiones","Búsqueda Paradero"],datasets:[]};switch(n){case"line":b.datasets.push({label:"Cantidad",data:[r,i,c,t],backgroundColor:"rgba(245, 245, 245, 0.2)",borderColor:"#ffffff",pointBackgroundColor:"#ffffff",pointBorderColor:"#fff",borderWidth:2,tension:.3,fill:!0});break;case"pie":case"doughnut":b.datasets.push({label:"Cantidad",data:[r,i,c,t],backgroundColor:h,borderColor:"#fff",borderWidth:2,hoverOffset:10});break;default:b.datasets.push({label:"Cantidad",data:[r,i,c,t],backgroundColor:h,borderColor:h.map(m=>cr(m,40)),borderWidth:1});break}return b},j={datasets:[{label:"Capturas y Evasiones",data:[{x:1,y:s},{x:2,y:t},{x:3,y:c},{x:4,y:i},{x:5,y:l}],backgroundColor:"#ffffff"}]},N={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#ffffff"}},title:{display:!0,text:"Informe Gráfico de Capturas y Evasiones",color:"#ffffff",font:{size:20}},tooltip:{bodyColor:"#ffffff",titleColor:"#ffffff"}},animation:{duration:1e3,easing:"easeOutBounce"},scales:n==="pie"||n==="doughnut"?{}:{x:{ticks:{color:"#ffffff"},grid:{color:"rgba(255, 255, 255, 0.2)"}},y:{beginAtZero:!0,ticks:{color:"#ffffff",stepSize:1},grid:{color:"rgba(255, 255, 255, 0.2)"}}}},d=b=>{o(b.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-center my-5 text-light",children:"Estadísticas / Gráficos"}),e.jsx("div",{className:"row justify-content-center mb-4",children:e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"input-group input-group-sm shadow-sm",children:[e.jsx("span",{className:"input-group-text bg-dark bg-opacity-50 text-light",children:"Tipo de gráfico"}),e.jsxs("select",{className:"form-select text-center",onChange:d,value:n,children:[e.jsx("option",{value:"bar",children:"Barra"}),e.jsx("option",{value:"line",children:"Línea"}),e.jsx("option",{value:"pie",children:"Pastel"}),e.jsx("option",{value:"doughnut",children:"Doughnut"}),e.jsx("option",{value:"scatter",children:"Dispersión"})]})]})})}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10",style:{height:"400px"},children:n==="scatter"?e.jsx(Ys,{data:j,options:N}):n==="bar"?e.jsx(ls,{data:u(),options:N}):n==="line"?e.jsx(Oe,{data:u(),options:N}):n==="pie"?e.jsx(ns,{data:u(),options:N}):n==="doughnut"?e.jsx(os,{data:u(),options:N}):null})})]})},mr=({showModalLink:s,setShowModalLink:r,selectedNotifId:t,setNewLink:c,newLink:i,setNotificaciones:l})=>{const[n,o]=a.useState(!0),[x,h]=a.useState(""),u=()=>{r(!1),c(""),o(!0),h("")},j=async()=>{if(!i){o(!1),h("Por favor, ingresa un enlace.");return}if(!t){o(!1),h("Por favor, selecciona una notificación.");return}try{await le(W(A,"db_notificaciones",t),{enlace:Ie(i)}),c(""),o(!0),h(""),alert("Enlace agregado correctamente."),u()}catch(g){console.error("Error al agregar el enlace:",g),alert("Hubo un error al agregar el enlace.")}};return s&&e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content bg-gradiante2",children:[e.jsxs("div",{className:"modal-header ",children:[e.jsx("h5",{className:"modal-title ",id:"modalLabel",children:"Agregar Enlace a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:u,"aria-label":"Close"})]}),e.jsx("div",{className:"modal-body  bg-dark bg-opacity-50",children:e.jsxs("div",{className:"form-floating text-dark  ",children:[e.jsx("input",{type:"url",id:"link",className:`form-control ${n?"":"is-invalid"}`,placeholder:"https://example.com",value:i,onChange:g=>c(g.target.value)}),e.jsx("label",{htmlFor:"link",children:"Ingrese el enlace"}),!n&&e.jsx("div",{className:"invalid-feedback",children:x})," "]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:u,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:j,children:"Guardar Enlace"})]})]})})})},ur=({showModalNot:s,closeModalNot:r})=>{const t=we(),[c,i]=a.useState(""),[l,n]=a.useState(""),[o,x]=a.useState("1"),[h,u]=a.useState(""),[j,g]=a.useState(!1),N=()=>{const m=new Date,f=String(m.getDate()).padStart(2,"0"),C=String(m.getMonth()+1).padStart(2,"0"),v=m.getFullYear().toString().slice(-2);return`${f}/${C}/${v}`};a.useEffect(()=>{if(t.pathname==="/panelcontrol"){const m=()=>{r()};return window.history.pushState(null,document.title),window.addEventListener("popstate",m),()=>{window.removeEventListener("popstate",m)}}},[t,r]);const d=async m=>{if(m.preventDefault(),c.trim()===""){u("El mensaje no puede estar vacío.");return}if(c.length>280){u("El mensaje no puede exceder los 280 caracteres.");return}if(o===""){u("Por favor, selecciona una carátula.");return}u(""),g(!0);try{await ye(Y(A,"db_notificaciones"),{titulo:l,contenido:c,timestamp:Pe(),leido:!1,fecha:N(),caratula:o}),n(""),i(""),x("1"),r()}catch(f){console.error("Error al enviar notificación: ",f),u("Error al enviar la notificación. Inténtalo de nuevo.")}finally{g(!1)}},b=()=>{i(""),x("1"),u(""),r()};return e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header text-center  bg-gradiante2 bg-opacity-50 ",children:[e.jsxs("h3",{className:"modal-title text-center ",id:"modalTitle",children:["Crear Notificación  ",e.jsx("i",{className:"bi bi-envelope-plus ms-2 titilar ",style:{fontSize:"1.8rem"}})]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:b})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("form",{onSubmit:d,children:[e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"titulo",value:l,onChange:m=>n(m.target.value)}),e.jsx("label",{className:"text-blue",children:"Titulo de la Notificación"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"mensaje",value:c,onChange:m=>i(m.target.value),style:{minHeight:"150px"}}),e.jsx("label",{className:"text-blue",children:"Mensaje"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsx("div",{className:"col-md",children:e.jsxs("div",{className:"form-floating shadow-sm",children:[e.jsxs("select",{className:"form-select text-center",id:"floatingSelectGrid",value:o,onChange:m=>x(m.target.value),children:[e.jsx("option",{value:"1",children:"Informativa "}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 👮🏻"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{className:"text-blue",children:"Selecciona Tipo de Notificación"})]})})}),h&&e.jsx("div",{className:"alert alert-danger mt-5",children:h}),j?e.jsx(ne,{}):e.jsx("div",{className:"d-grid",children:e.jsx("button",{type:"submit",className:"btn bg-primary border-white border-3 text-white rounded-pill position-absolute top-100 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Crear Notificación ",e.jsx("i",{className:"bi bi-send-check-fill ms-2 text-white"})]})})})]})})})]})})})},hr=({Date1:s,Date2:r,onCerrar:t,color:c})=>{const[i,l]=a.useState(!1),n=()=>{l(!0)};return e.jsxs("div",{className:`alert alert-${c} text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-light position-relative d-flex align-items-start gap-3`,children:[e.jsx("button",{type:"button",className:"btn-close  btn-close-white  position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:t}),e.jsx("img",{src:"img/ayuda.gif",alt:"Ayuda",style:{width:"80px",height:"70px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-secondaryM border border-2 d-none d-sm-table-cell"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Hola, soy el asistente de ayuda. Voy a guiarte en el proceso de creación de una notificación."}),e.jsxs("p",{children:["Para comenzar, presiona el botón ",e.jsx("strong",{className:"titilar",children:"'Crear Notificación'"}),". Luego, ingresa el título y el contenido del mensaje, y selecciona el tipo de notificación:"]}),e.jsxs("ul",{children:[e.jsx("p",{children:"Informativa (Normal)"}),e.jsx("p",{children:"Búsqueda de Paradero 🔎 "}),e.jsx("p",{children:"Prioritaria (Importante) ⭐ "}),e.jsx("p",{children:"Evadido (En caso de evasiones) 🚨"})]}),e.jsx("button",{type:"button",className:"btn btn-primary text-white btn-sm mx-2",onClick:n,children:"Continuar"}),e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed text-light btn-sm",onClick:t,children:"Finalizar "}),i&&e.jsxs("div",{children:[e.jsxs("p",{className:"mt-3",children:[e.jsx("i",{className:"bi bi-person-fill-add rounded-circle bg-cyan text-white p-2 mx-2"}),'"Usa este ícono  para asociar personas a tu notificación. Esto permitirá que el usuario vea una tarjeta con la información de la persona asociada."']}),e.jsxs("p",{className:"mt-3",children:[e.jsx("i",{className:"bi bi-link rounded-circle bg-teal text-white p-2 mx-2"}),'"Usa este ícono  para agregar enlaces relacionados con la notificación. Esto permitirá que el usuario se dirija directamente al sitio web indicado."']}),e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed text-light btn-sm",onClick:t,children:"Finalizar "})]})]})]})};function xr(){const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState(!1),[n,o]=a.useState(!1),[x,h]=a.useState(null),[u,j]=a.useState(null),[g,N]=a.useState(null),[d,b]=a.useState(""),[m,f]=a.useState(!1),[C,v]=a.useState(""),[w,D]=a.useState(""),[p,y]=a.useState(""),[S,F]=a.useState("desc"),[_,k]=a.useState(!1),[M,$]=a.useState(""),U=()=>k(!0),Q=()=>k(!1),[H,V]=a.useState(!1),ie=E=>{E!=null&&E.asociada_notificacion_id&&Array.isArray(E.asociada_notificacion_id)&&alert(`Esta persona está asociada a las siguientes notificaciones: ${E.asociada_notificacion_id.join(", ")}`)},oe=E=>{F(E.target.value),J(E.target.value)},J=(E,R)=>{let O=[...s];E==="asc"?O.sort((ee,K)=>{var ce,q;return((ce=ee.timestamp)==null?void 0:ce.seconds)-((q=K.timestamp)==null?void 0:q.seconds)}):O.sort((ee,K)=>{var ce,q;return((ce=K.timestamp)==null?void 0:ce.seconds)-((q=ee.timestamp)==null?void 0:q.seconds)}),r(O)};a.useEffect(()=>{f(!0);const E=ge(Y(A,"db_notificaciones"),$e("timestamp","desc")),R=Te(E,O=>{const ee=O.docs.map(K=>({id:K.id,...K.data()}));r(ee)},O=>{console.error("Error al obtener notificaciones:",O)});return f(!1),()=>R()},[]),a.useEffect(()=>{(async()=>{const R=ge(Y(A,"db_personas"),$e("nombre_apellido","asc")),ee=(await X(R)).docs.map(K=>({id:K.id,...K.data()}));c(ee)})()},[]);const Z=async(E,R)=>{try{if(!window.confirm("¿Desea eliminar este enlace?"))return;const ee=W(A,"db_notificaciones",R),K=await ze(ee);if(K.exists()){const ce=K.data();if(Array.isArray(ce.enlace)){const q=ce.enlace.filter((te,Ne)=>Ne!==E);await le(ee,{enlace:q}),alert("Enlace eliminado con exito ")}else alert("El campo 'enlace' no existe o no es un array.")}else alert("No se encontró el documento con el ID proporcionado.")}catch(O){alert.error("Error al eliminar el enlace:",O)}},L=async E=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta notificación?")){f(!0);try{await xe(W(A,"db_notificaciones",E)),r(O=>O.filter(ee=>ee.id!==E)),alert("Se eliminó la notificación")}catch(O){console.error("Error al eliminar la notificación:",O),alert("Hubo un error al eliminar la notificación.")}finally{f(!1)}}},G=E=>{h(E),l(!0)},se=()=>{l(!1),h(null),b("")},ae=E=>{h(E),o(!0)},re=async()=>{if(x&&d)try{const E=ge(Y(A,"db_personas"),Se("nombre_apellido","==",d)),R=await X(E);if(R.empty)alert("No se encontró la persona seleccionada.");else{const O=R.docs[0];await Promise.all([le(W(A,"db_notificaciones",x),{asociada:Ie(d)}),le(W(A,"db_personas",O.id),{asociada_notificacion_id:Ie(x)})]),alert(`La persona ${d} se asoció a la notificación.`),se()}}catch(E){console.error("Error al asociar captura:",E),alert("Hubo un error al asociar la captura.")}else alert("Por favor, selecciona una persona para asociar.")},ue=async(E,R,O)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar la asociación de la persona ${O} con la notificación?`)){f(!0);try{const K=W(A,"db_notificaciones",E);await le(K,{asociada:Re(O)});const ce=W(A,"db_personas",R);await le(ce,{asociada_notificacion_id:Re(E)}),alert(`Se eliminó la asociación de la persona ${O} con la notificación.`)}catch(K){console.error("Error al eliminar la asociación:",K),alert("Hubo un error al eliminar la asociación.")}finally{f(!1)}}else alert(`La asociación de la persona ${O} no fue eliminada.`)},I=E=>{switch(E){case"1":return"Informativa";case"2":return"Paradero 🔎";case"3":return"Evasión 👮🏻";case"4":return"Prioritaria ⭐";default:return"No definida"}},P=E=>{switch(E){case 1:return"Normal";case 2:return"Paradero 🔎";case 3:return"Evasión 👮🏻";case 4:return"Prioritaria ⭐";default:return"No definida"}},T=E=>/^https?:\/\//.test(E)?E:`https://${E}`,z=async E=>{if(w.trim()){f(!0);try{const R=W(A,"db_notificaciones",E);await le(R,{contenido:w}),alert("Contenido actualizado correctamente"),j(null)}catch(R){console.error("Error al actualizar contenido:",R),alert("Hubo un error al actualizar el contenido.")}finally{f(!1)}}else alert("El contenido no puede estar vacío")},B=async E=>{if(p.trim()){f(!0);try{const R=W(A,"db_notificaciones",E);await le(R,{titulo:p}),alert("titulo actualizado correctamente"),N(null)}catch(R){console.error("Error al actualizar titulo:",R),alert("Hubo un error al actualizar el titulo.")}finally{f(!1)}}else alert("El titulo no puede estar vacío")};return e.jsxs("div",{children:[e.jsxs("div",{className:"row g-3 justify-content-center align-items-center mt-1",children:[e.jsxs("div",{className:"container",children:[H&&e.jsx(hr,{Date1:"Ninguno",Date2:"Desactivar Busqueda",onCerrar:()=>V(!1),color:"info"}),!H&&e.jsx("div",{className:"d-flex justify-content-end mb-1  ",children:e.jsxs("button",{className:"btn  fw-semibold",onClick:()=>V(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 titilar text-light"})," ",e.jsx("small",{className:"text-light",children:"Ayuda"})]})})]}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 text-center pb-4",children:e.jsx("button",{"aria-label":"Crear Notificación",onClick:U,className:"btn text-center p-3 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",children:e.jsxs("span",{className:"d-flex justify-content-center align-items-center gap-2",children:["Crear Notificación",e.jsx("i",{className:"bi bi-envelope-plus ms-2 titilar",style:{fontSize:"1.8rem"}})]})})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 text-center mb-4  ",children:e.jsxs("div",{className:"form-floating shadow  ",children:[e.jsxs("select",{className:"form-select ",id:"floatingSelectOrder",value:S,onChange:oe,children:[e.jsx("option",{value:"desc",children:"Más recientes primero"}),e.jsx("option",{value:"asc",children:"Más antiguos primero"})]}),e.jsx("label",{htmlFor:"floatingSelectOrder ",children:"Ordenar"})]})})]}),e.jsx("div",{className:"row justify-content-center  ",children:e.jsx("div",{className:"col-12 col-md-10  ",children:e.jsx("div",{className:"list-group",children:s.map(E=>{var R;return e.jsxs("div",{className:"list-group-item mb-4 shadow mt-5  ",children:[e.jsxs("div",{className:"d-flex align-items-center bg-gradiante2 text-white p-3 rounded",children:[e.jsx("button",{className:"btn bg-primaryMuiBlue px-3 border-white border-3 text-white rounded-pill position-absolute top-0 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Notificación",e.jsx("i",{className:"bi bi-send-check-fill ms-1 text-white"})]})}),e.jsx("span",{className:`badge rounded-pill me-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[E.caratula]||"bg-warning text-dark"}`,children:I(E.caratula)}),e.jsx("div",{className:"flex-grow-1"}),e.jsx("small",{className:"text-end",children:new Date(((R=E.timestamp)==null?void 0:R.seconds)*1e3).toLocaleString()})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Título"}),E.id===g?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:p,onChange:O=>y(O.target.value),className:"form-control"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>B(E.id),disabled:m,children:m?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:E.titulo}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${E.id===g?"btn-danger":"btn-primary"}`,onClick:()=>{E.id===g?N(null):(y(E.titulo),N(E.id))},children:e.jsx("i",{className:`bi ${E.id===g?"bi-x-circle":"bi-pencil"}`})})}),e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Contenido"}),E.id===u?e.jsxs("div",{children:[e.jsx("textarea",{value:w,onChange:O=>D(O.target.value),className:"form-control",rows:"5"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>z(E.id),disabled:m,children:m?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:E.contenido}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${E.id===u?"btn-danger":"btn-primary"}`,onClick:()=>{E.id===u?j(null):(D(E.contenido),j(E.id))},children:e.jsx("i",{className:`bi ${E.id===u?"bi-x-circle":"bi-pencil"}`})})}),E.enlace&&E.enlace.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Enlaces Asociados"}),e.jsx("ul",{className:"list-unstyled",children:E.enlace.map((O,ee)=>e.jsxs("li",{className:"d-flex align-items-center justify-content-center gap-3 p-2 rounded-pill bg-light shadow-sm",children:[e.jsx("i",{className:"bi bi-browser-chrome text-primary girar",style:{fontSize:"20px"}}),e.jsx("a",{href:T(O),target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none text-primary text-center flex-grow-1",style:{maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:O}),e.jsx("button",{className:"btn btn-redUi1 btn-sm rounded-circle",onClick:()=>Z(ee,E.id),children:e.jsx("i",{className:"bi bi-trash text-white"})})]},ee))})]}):e.jsx("p",{className:"text-danger mt-3 text-center",children:"No posee enlaces asociados"}),E.asociada&&E.asociada.length>0?e.jsxs("div",{className:"mt-3  ",children:[e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded",children:"Personas Asociadas"}),E.asociada.map((O,ee)=>{var ce,q;const K=t.find(te=>te.nombre_apellido===O);return K?e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2 p-2  shadow-sm bg-primary rounded-4 bg-opacity-25",children:[e.jsx("img",{src:((ce=K.base64)==null?void 0:ce.trim())||fe,alt:K.nombre_apellido||"Imagen no disponible",className:"rounded-circle me-3",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-center",children:[e.jsxs("span",{children:[ee+1,". ",O]}),((q=K.asociada_notificacion_id)==null?void 0:q.length)>0&&e.jsxs("span",{className:"badge bg-teal text-white ms-3",onClick:()=>ie(K),children:["Asociado ",K.asociada_notificacion_id.length]})]}),e.jsx("button",{className:"btn btn-sm btn-redUi1 text-white ms-3",onClick:()=>ue(E.id,K.id,O),children:e.jsx("i",{className:"bi bi-trash"})})]},ee):null})]}):e.jsx("span",{className:"text-danger text-center d-block",children:"No hay personas asociadas"})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 p-3",children:[e.jsx("button",{className:"btn btn-cyan text-white btn-sm rounded-circle ",onClick:()=>G(E.id),children:e.jsx("i",{className:"bi bi-person-fill-add"})}),e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle ",onClick:()=>ae(E.id),children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle ",onClick:()=>L(E.id),disabled:m,children:e.jsx("i",{className:"bi bi-trash3-fill"})})]})]},E.id)})})})}),e.jsx("div",{className:`modal fade bg-dark ${i?"show":""}`,style:{display:i?"block":"none"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!i,children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content p-2 bg-gradiante2",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title ",id:"modalLabel",children:"Asociar Persona a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:se,"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body text-center bg-dark bg-opacity-50",children:[e.jsx("label",{htmlFor:"persona",className:"form-label mt-3 fw-semibold",children:"Selecciona una persona:"}),e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("input",{type:"text",className:"form-control dropdown-toggle w-100 bg-light bg-opacity-50 text-light",placeholder:"Buscar por nombre o DNI",value:M,onChange:E=>$(E.target.value)}),e.jsx("button",{className:"btn btn-secondaryMuiRed text-white ms-2",onClick:()=>$(""),disabled:!M,children:e.jsx("i",{className:"bi bi-trash"})})]}),M&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-start fw-bold",children:"Resultados:"}),e.jsx("ul",{className:"list-group",style:{maxHeight:"150px",overflowY:"auto"},children:t.filter(E=>`${E.nombre_apellido} ${E.documento}`.toLowerCase().includes(M.toLowerCase())).map(E=>{var R;return e.jsxs("li",{className:"list-group-item d-flex align-items-center",onClick:()=>{b(E.nombre_apellido),$("")},style:{cursor:"pointer"},children:[e.jsx("img",{src:((R=E.base64)==null?void 0:R.trim())||fe,alt:E.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-0",children:[E.nombre_apellido," - ",E.documento]}),e.jsx("span",{className:`badge rounded-pill border border-white border-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[E.prioridad]||"bg-warning text-dark"}`,children:P(E.prioridad)})]})]},E.id)})})]}),e.jsxs("div",{className:"dropdown ",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100 bg-light bg-opacity-50 text-light",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",children:d||"Selecciona una persona"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"300px",overflowY:"auto"},children:t.filter(E=>`${E.nombre_apellido} ${E.documento}`.toLowerCase().includes(M.toLowerCase())).map(E=>{var R;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center",onClick:()=>b(E.nombre_apellido),children:[e.jsx("img",{src:((R=E.base64)==null?void 0:R.trim())||fe,alt:E.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),E.nombre_apellido," - ",E.documento," -",e.jsx("span",{className:`badge rounded-pill border border-white border-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[E.prioridad]||"bg-warning text-dark"}`,children:P(E.prioridad)})]})},E.id)})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:re,disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Asociando..."]}):e.jsxs(e.Fragment,{children:["Asociar Captura ",e.jsx("i",{className:"bi bi-person-plus-fill mx-2"})]})}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:se,disabled:m,children:"Cerrar"})]})]})})}),e.jsx(mr,{showModalLink:n,setShowModalLink:o,selectedNotifId:x,setNewLink:v,newLink:C,setNotificaciones:r}),e.jsx(ur,{showModalNot:_,closeModalNot:Q})]})}const br=({loading:s})=>e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"position-relative",children:s?e.jsx(ne,{}):e.jsx("div",{className:"list-group",children:e.jsx(xr,{})})})}),pr=()=>e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center",style:{minHeight:"55vh"},children:[e.jsx("h5",{className:" fs-1 mb-5 text-indigoMui2 ",children:"Bienvenido al Panel de Control !!!"}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column justify-content-center align-items-center mb-4 mb-md-0",children:[e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-greenW text-purple"}),"Aquí podrás administrar los recursos del sistema de forma fácil y sencilla."]}),e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-lightbulb p-3 rounded-circle me-3 bg-greenW text-purple"}),"Recuerda que, ante cualquier problema, puedes solicitar asistencia técnica."]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-center align-items-center",children:e.jsx("img",{src:Xs,alt:"Descripción de la imagen",className:"img-fluid p-2 rounded-circle shadow",style:{maxWidth:"300px",height:"auto"}})})]})]}),gr=({loading:s})=>{const[r,t]=a.useState([]),[c,i]=a.useState([]),l=["captura","date","descripcion_fisica","documento","entidad","motivo_captura","nombre_apellido","paradero","prioridad","sexo","usuario","asociada_notificacion_id"],n={captura:"Captura",date:"Fecha",descripcion_fisica:"Datos de la Persona",documento:"Documento",entidad:"Entidad",motivo_captura:"Motivo de Captura",nombre_apellido:"Nombre y Apellido",paradero:"Paradero",prioridad:"Prioridad",sexo:"Sexo",usuario:"Usuario",asociada_notificacion_id:"ID Notificación "},o=async()=>{try{const N=(await X(Y(A,"db_personas"))).docs.map(d=>({id:d.id,...d.data()}));t(N)}catch(g){console.error("Error al obtener los datos:",g)}},x=g=>{i(N=>N.includes(g)?N.filter(d=>d!==g):[...N,g])},h=()=>{i(l)},u=()=>{i([])},j=()=>{if(r.length===0||c.length===0)return;const g=r.map(b=>{const m={};return c.forEach(f=>{m[n[f]||f]=b[f]}),m}),N=de.json_to_sheet(g),d=de.book_new();de.book_append_sheet(d,N,"Datos Seleccionados"),Le(d,"Datos_Seleccionados.xlsx")};return a.useEffect(()=>{o()},[]),e.jsx(e.Fragment,{children:s?e.jsx(ne,{}):e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center",style:{minHeight:"55vh"},children:[e.jsxs("h2",{className:"text-center my-4",children:["Exportar Datos de Capturas ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"text-center mb-5 fw-light",children:"Selecciona los campos que deseas incluir en la exportación."}),e.jsxs("div",{className:"d-flex justify-content-center mb-4 flex-wrap gap-2",children:[e.jsx("button",{className:"btn btn-outline-light",onClick:h,children:"Seleccionar Todos"}),e.jsx("button",{className:"btn btn-outline-light",onClick:u,children:"Limpiar Selección"})]}),e.jsx("form",{className:"mb-4 w-100 px-3",children:e.jsx("div",{className:"row p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg border-1 border",children:l.map(g=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",children:e.jsxs("div",{className:"form-check w-100 d-flex align-items-center",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:g,value:g,onChange:()=>x(g),checked:c.includes(g)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:g,children:n[g]||g})]})},g))})}),c.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn btn-green text-white fw-semibold",onClick:j,children:["Descargar Datos Seleccionados ",e.jsx("i",{className:"bi bi-filetype-xml"})]})})]})})},ma=({data1:s,data2:r})=>{var g;const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),[n,o]=a.useState(""),h=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),u=async N=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta persona?"))try{const d=W(A,"db_personas_desactivados",N.id),b=new Date,m=`${b.getDate().toString().padStart(2,"0")}/${(b.getMonth()+1).toString().padStart(2,"0")}/${b.getFullYear().toString().slice(-2)}`;await me(d,{...N,usuario_baja:h.email||"usuario_desconocido",usuario_baja_fecha:m});const f=W(A,"db_personas",N.id);await xe(f),r(),o("Persona eliminada y copiada a la colección de desactivados."),setTimeout(()=>o(""),3e3)}catch(d){console.error("Error al eliminar persona: ",d),o("Error al eliminar la persona. Inténtalo de nuevo."),setTimeout(()=>o(""),3e3)}},j=N=>{u(N),l()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-trash3-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Eliminar Persona"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:l})]}),"  ",e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(g=s.base64)==null?void 0:g.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-danger  bg-redW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas eliminar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:()=>{j(s)},children:"Confirmar Eliminación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},jr=({data1:s,data2:r})=>{const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),[n,o]=a.useState(),[x,h]=a.useState(s.descripcion_fisica),[u,j]=a.useState(s.documento),[g,N]=a.useState(s.entidad),[d,b]=a.useState(s.motivo_captura),[m,f]=a.useState(s.nombre_apellido),[C,v]=a.useState(s.prioridad),[w,D]=a.useState(s.sexo),[p,y]=a.useState(s.numero_contacto),[S,F]=a.useState(s.base64),[_,k]=a.useState("edicion desde menu de capturas"),[M,$]=a.useState(s.paradero),[U,Q]=a.useState(s.alerta),[H,V]=a.useState(!1),[ie,oe]=a.useState(!1),[J,Z]=a.useState(!1),L=()=>{const z={nombre_apellido:m,documento:u,sexo:w,descripcion_fisica:x,entidad:g,motivo_captura:d,numero_contacto:p,prioridad:C,alerta:U,paradero:M};return["nombre_apellido","documento","sexo","descripcion_fisica","entidad","motivo_captura","numero_contacto","prioridad","alerta","paradero"].filter(R=>z[R]!==s[R])},G=()=>{V(z=>!z)},se=()=>{oe(z=>!z)},ae=()=>{Z(z=>!z)},re=z=>{const B=z.target.files[0];if(B){const E=new FileReader;E.onloadend=()=>{F(E.result)},E.readAsDataURL(B)}else alert("Por favor, selecciona un archivo de imagen válido.")},ue=async()=>{const z=/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/;if(!m.trim()){alert("El campo Nombre y Apellido no puede estar vacío.");return}if(!z.test(m)){alert("El campo Nombre y Apellido solo debe contener letras.");return}const B=/^[0-9]+$/;if(!u.trim()){alert("El campo Documento no puede estar vacío.");return}if(!B.test(u)){alert("El campo Documento solo debe contener números.");return}if(u.length<8){alert("El Documento debe tener al menos 8 dígitos.");return}if(!_.trim()){alert("La descripción de las ediciones es obligatoria.");return}const E=W(A,"db_personas",s.id),R=L();try{o(!0);const O=new Date,ee=`${O.getDate().toString().padStart(2,"0")}/${(O.getMonth()+1).toString().padStart(2,"0")}/${O.getFullYear().toString().slice(-2)}`;await le(E,{descripcion_fisica:x,documento:u,entidad:g,motivo_captura:d,nombre_apellido:m,prioridad:C,sexo:w,numero_contacto:p,alerta:U,base64:S,paradero:M,ediciones:_.trim()?[...s.ediciones||[],{motivo:_,usuario:T.email,fecha:ee,campos:R}]:s.ediciones||[]}),r(),alert("Los cambios se han guardado correctamente.")}catch(O){console.error("Error al actualizar la persona: ",O),alert("Error al guardar los cambios. Inténtalo de nuevo.")}o(!1)},I=z=>{const B=parseInt(z.target.value,10);v(B),B===2&&($(!0),Q(!1)),B===1&&($(!1),Q(!1)),B===3&&(Q(!0),$(!1)),B===4&&($(!1),Q(!1))},T=(()=>{const z=localStorage.getItem("user");return z?JSON.parse(z):null})();return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-pen"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header ",children:[" ",e.jsx("img",{src:"img/asistente.gif",alt:"Asistente",style:{width:"60px",height:"60px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border "}),e.jsx("h5",{className:"modal-title mx-4",children:"Asistente de Edición "}),e.jsx("button",{type:"button",className:"btn-close ",onClick:l})]}),"  ",e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:`col-3 mt-3 d-flex align-items-center ${H?"titilar":""}`,children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:G,children:[e.jsx("img",{src:S||"https://via.placeholder.com/40",alt:(S==null?void 0:S.nombre_apellido)||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:H?"Editando":"Editar"})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:m,onChange:z=>f(z.target.value)}),e.jsx("label",{className:" badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"number",className:"form-control",value:u,onChange:z=>j(z.target.value)}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select text-center",value:w,onChange:z=>D(z.target.value),children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"masculino",children:"Masculino 👨"}),e.jsx("option",{value:"femenino",children:"Femenino 👩"}),e.jsx("option",{value:"otros",children:"Otros 👭🏻"})]}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Sexo"})]})})]})]}),e.jsxs("div",{className:"btn-group mt-3",role:"group","aria-label":"Basic example",children:[e.jsx("button",{type:"button",className:`btn btn-secondaryM text-white ${J?"titilar":""}`,onClick:ae,children:J?e.jsx(e.Fragment,{children:"Editando Datos de Captura "}):"Datos de Captura"}),e.jsx("button",{type:"button",className:`btn btn-primary text-white ${ie?"titilar":""}`,onClick:se,children:ie?e.jsx(e.Fragment,{children:"Editando Descripciones"}):"Descripciones"})]}),H&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Editar Fotografía ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:G})}),e.jsxs("div",{className:"my-3 text-center text-purple",children:[e.jsx("input",{type:"file",className:"form-control",onChange:re}),S&&e.jsx("img",{src:S,alt:"Imagen previa",className:"img-fluid mt-5",style:{maxWidth:"300px"}})]})]})]}),J&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Datos de la Captura ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-2 text-center",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:ae})}),e.jsx("span",{className:"badge text-bg-secondaryM text-white me-2 ",children:"Atención "}),e.jsxs("small",{children:["La prioridad ",e.jsx("strong",{children:"modifica el contexto"})," de la captura"]})]}),e.jsxs("div",{className:"form-floating ",children:[e.jsxs("select",{className:"form-select text-center shadow-sm border border-secondaryM mb-3  border-opacity-50 ",value:C,onChange:I,children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioridad ⭐"})]}),e.jsx("label",{className:"fw-semibold opacity-75 ms-2",children:"Prioridad"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Entidad que solicita captura"})}),e.jsx("input",{className:"form-control bg-blueW2",value:g,onChange:z=>N(z.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Numero de Contacto Entidad "})}),e.jsx("input",{className:"form-control bg-blueW2",value:p,onChange:z=>y(z.target.value)})]})]}),ie&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Descripciones ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:se})}),e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Descripción Fisica "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:x,onChange:z=>h(z.target.value),style:{minHeight:"160px"}})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Motivo Captura "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:d,onChange:z=>b(z.target.value),style:{minHeight:"150px"}})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:l,children:e.jsx("i",{className:"bi bi-x-circle"})}),e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle",onClick:ue,disabled:n,children:n?e.jsx("i",{className:"bi bi-floppy2 titilar"}):e.jsx("i",{className:"bi bi-floppy2"})})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},us=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(""),[x,h]=a.useState(!1),u=()=>l(!0),j=()=>l(!1),g=()=>{c([])},d=(()=>{const m=localStorage.getItem("user");return m?JSON.parse(m):null})(),b=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas copiar estas personas a la colección de desactivados?"))){h(!0);try{const C=r.filter(v=>s.includes(v.id)).map(async v=>{const w=Y(A,"db_personas_desactivados"),D=new Date,p=`${D.getDate().toString().padStart(2,"0")}/${(D.getMonth()+1).toString().padStart(2,"0")}/${D.getFullYear().toString().slice(-2)}`;await ye(w,{...v,usuario_baja:(d==null?void 0:d.email)||"usuario_desconocido",usuario_baja_fecha:p});const y=W(A,"db_personas",v.id);await xe(y)});await Promise.all(C),o("Personas copiadas a la colección de desactivados y eliminadas de la colección original."),t(),g()}catch(f){console.error("Error al eliminar personas:",f),o("Hubo un error al copiar o eliminar algunas personas.")}setTimeout(()=>o(""),3e3),h(!1),j()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:u,disabled:x,children:e.jsx("i",{className:"bi bi-trash3-fill"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Eliminar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:j})]}),e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-redW p-2 rounded-pill text-secondaryMuiRed fw-bold",children:["Se eliminarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(m=>s.includes(m.id)).map(m=>{var f;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(f=m.base64)==null?void 0:f.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),m.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(C=>C.filter(v=>v!==m.id)),title:"Quitar de la selección"})]},m.id)})}),e.jsxs("p",{className:"text-danger text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas eliminar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:j,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:b,disabled:x,children:x?"Eliminando...":"Confirmar Eliminación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"}),n&&e.jsx("div",{className:"alert alert-success mt-2",children:n})]})},We=({Date1:s,Date2:r,setSelectedDocs:t,onCerrar:c,color:i})=>e.jsxs("div",{className:`card bg-${i} shadow my-4 position-relative text-dark d-flex align-items-start gap-3 p-4 card text-center p-2 bg-dark bg-opacity-75 rounded-4 shadow-lg`,style:{overflow:"visible"},children:[e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:c}),e.jsx("img",{src:"img/Perfiles/9.png",alt:"Asistente",className:" position-absolute",style:{width:"120px",height:"200px",objectFit:"contain",top:"-30px",left:"-20px"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:e.jsx("strong",{children:"Asistente de Selección"})}),e.jsxs("p",{className:"mb-3",children:["Personas Seleccionadas: ",e.jsxs("strong",{children:[s.length," 🧑"]})]}),e.jsx("strong",{children:s.length>0?e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-start p-2 rounded mb-3  ",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(l=>s.includes(l.id)).map(l=>{var n;return e.jsxs("div",{className:"badge text-dark shadow d-flex align-items-center p-2 mx-2 position-relative bg-light bg-opacity-50 m-1",style:{fontSize:"0.75rem"},children:[e.jsx("img",{src:(n=l.base64)==null?void 0:n.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),l.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>t(o=>o.filter(x=>x!==l.id)),title:"Quitar de la selección"})]},l.id)})}):e.jsx("span",{className:"text-danger",children:"Ninguna"})})]})]}),He=({searchTerm:s,setSearchTerm:r})=>e.jsxs("div",{className:"form-floating mb-3 position-relative  ",children:[e.jsx("input",{type:"text",className:"form-control  shadow-sm pe-5 bg-dark bg-opacity-50 text-light",placeholder:"Buscar por nombre",value:s,onChange:t=>r(t.target.value)}),e.jsx("label",{children:"Buscar por Nombre"}),s&&e.jsx("button",{type:"button",className:"btn btn-link position-absolute top-50 end-0 translate-middle-y pe-3 ",onClick:()=>r(""),"aria-label":"Cancelar búsqueda",children:e.jsx("i",{className:"bi bi-x-circle text-light "})})]}),ua=({prioridadFilter:s,setPrioridadFilter:r})=>e.jsxs("div",{className:"form-floating mb-3  ",children:[e.jsxs("select",{className:"form-select shadow-sm ","aria-label":"Floating label select example",value:s,onChange:t=>r(t.target.value),children:[e.jsx("option",{value:"",children:"Todas las Prioridades"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{children:"Seleccione una Prioridad"})]}),Ye=({orden:s,setOrden:r})=>e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Ordenar alfabéticamente",value:s,onChange:t=>r(t.target.value),children:[e.jsx("option",{value:"asc",children:"Orden A-Z"}),e.jsx("option",{value:"desc",children:"Orden Z-A"})]}),e.jsxs("label",{children:["Ordenar ",e.jsx("i",{className:"bi bi-alphabet"})]})]}),fr=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0);a.useState("");const[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState(!0),[d,b]=a.useState("asc"),m=Y(A,"db_personas"),f=async()=>{o(!0);try{const y=(await X(m)).docs.map(S=>({...S.data(),id:S.id}));r(y),c(y)}catch(p){console.error("Error al obtener personas: ",p)}finally{o(!1)}},C=p=>p.sort((y,S)=>d==="asc"?y.nombre_apellido.localeCompare(S.nombre_apellido):S.nombre_apellido.localeCompare(y.nombre_apellido));a.useEffect(()=>{f()},[]),a.useEffect(()=>{const p=s.filter(S=>S.nombre_apellido&&S.nombre_apellido.toLowerCase().includes(x.toLowerCase())||S.documento&&S.documento.includes(x)).filter(S=>u?S.prioridad===parseInt(u,10):!0),y=C(p);c(y)},[x,s,u,d]),a.useMemo(()=>t.filter(p=>i.includes(p.id)),[i,t]);const v=p=>{l(y=>y.includes(p)?y.filter(S=>S!==p):[...y,p])},w=()=>{if(i.length===t.length)l([]);else{const p=t.map(y=>y.id);l(p)}},D=p=>{switch(Number(p)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg ",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center my-5 animate__animated animate__bounce mt-sm-0 mt-5 ",children:"Listado de Capturas"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(He,{searchTerm:x,setSearchTerm:h})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(ua,{prioridadFilter:u,setPrioridadFilter:j})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:d,setOrden:b})})]}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2  mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(us,{data1:i,data2:s,dataRefresh:f,setSelectedDocs:l}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>l([])})]}),g&&e.jsx(We,{Date1:i,Date2:s,setSelectedDocs:l,onCerrar:()=>N(!1),color:"blueW2"}),!g&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>N(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-light"})," ",e.jsxs("small",{className:"text-light",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-light",children:[i.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5  ",children:e.jsxs("table",{className:"table table-striped table-hover text-center small rounded-pill",children:[e.jsx("thead",{className:"table-info",children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:w})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(p=>{var y;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(p.id),onChange:()=>v(p.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((y=p.base64)==null?void 0:y.trim())||"https://via.placeholder.com/40",alt:p.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize",children:p.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:p.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:D(p.prioridad)}),e.jsxs("td",{children:[e.jsx(jr,{data1:p,data2:f}),e.jsx(ma,{data1:p,data2:f})]}),e.jsx("td",{})]},p.id)})})]})})]})})]})},ha=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(!1),x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas modificar estas personas a la colección?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await me(C,{...f,prioridad:1,paradero:!1,alerta:!1,ediciones:[...f.ediciones||[],{motivo:"cambio de prioridad",usuario:g.email,fecha:w}]})});await Promise.all(m),alert("Personas modificadas con exito."),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al modificar algunas personas.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-orange text-white btn-sm rounded-circle ",onClick:x,disabled:n,children:e.jsx("i",{className:"bi bi-star-fill"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Modificar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-orange border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-orangeW p-2 rounded-pill text-orange fw-bold",children:["Se modificarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-orangeDb text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas modificar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-orangeDb text-white",onClick:N,disabled:n,children:n?"Cargando...":"Confirmar Modificación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Es=({prioridadFilter:s,setPrioridadFilter:r,personas:t})=>{const c=[...new Set(t.map(i=>i.entidad))];return e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:i=>r(i.target.value),children:[e.jsx("option",{value:"",children:"Todas las Entidades"}),c.map((i,l)=>e.jsx("option",{value:i,children:i},l))]}),e.jsx("label",{children:"Seleccione una Entidad"})]})},Ds=(s,r,t)=>s.filter(c=>{var i,l;return((i=c.nombre_apellido)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))||((l=c.documento)==null?void 0:l.includes(r))}).filter(c=>!t||c.entidad===t),Fs=(s,r)=>s.sort((t,c)=>r==="asc"?t.nombre_apellido.localeCompare(c.nombre_apellido):c.nombre_apellido.localeCompare(t.nombre_apellido)),Nr=(s,r)=>r?s.filter(t=>r==="capturado"?t.captura===!0:r==="evadido"?t.captura===!1:!0):s,Ps=(s,r,t,c)=>{s(""),r(""),t("asc"),c&&c("")},vr=({data1:s,data2:r})=>{var g;const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),[n,o]=a.useState(!1),h=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),u=async N=>{if(window.confirm("¿Estás seguro de que deseas modificar esta persona?")){o(!0);try{const d=W(A,"db_personas",N.id),b=new Date,m=`${b.getDate().toString().padStart(2,"0")}/${(b.getMonth()+1).toString().padStart(2,"0")}/${b.getFullYear().toString().slice(-2)}`;await me(d,{...N,prioridad:1,paradero:!1,alerta:!1,ediciones:[...N.ediciones||[],{motivo:"cambio de prioridad",usuario:h.email,fecha:m}]}),r(),o(!1),alert("Modificación exitosa.")}catch(d){console.error("Error al eliminar persona: ",d),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},j=N=>{u(N),l()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-orange text-white btn-sm rounded-circle m-1",onClick:i,disabled:n,children:e.jsx("i",{className:"bi bi-star-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Modificar Prioridad Persona"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:l})]}),"  ",e.jsx("hr",{className:"border border-orange border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(g=s.base64)==null?void 0:g.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-orange  bg-orangeW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{className:"btn btn-orangeDb text-white",onClick:()=>{j(s)},children:"Confirmar Cambio"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},yr=({data1:s,data2:r})=>{var d;const[t,c]=a.useState("busqueda paradero"),[i,l]=a.useState(!1),n=()=>l(!0),o=()=>l(!1),[x,h]=a.useState(!1),j=(()=>{const b=localStorage.getItem("user");return b?JSON.parse(b):null})(),g=async b=>{if(window.confirm("¿Estás seguro de que deseas modificar esta persona?")){h(!0);try{const m=W(A,"db_personas",b.id),f=new Date,C=`${f.getDate().toString().padStart(2,"0")}/${(f.getMonth()+1).toString().padStart(2,"0")}/${f.getFullYear().toString().slice(-2)}`;await me(m,{...b,prioridad:1,paradero:!1,alerta:!1,ediciones:[...b.ediciones||[],{motivo:"desactivar busqueda paradero",usuario:j.email,fecha:C}]}),r(),h(!1),alert("Modificación exitosa.")}catch(m){console.error("Error al eliminar persona: ",m),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},N=b=>{g(b),o()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primaryMuiBlue text-white btn-sm rounded-circle m-1",onClick:n,disabled:x,children:e.jsx("i",{className:"bi bi-search"})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsxs("h5",{className:"modal-title text-capitalize",children:["Modificar ",t]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:o})]}),"  ",e.jsx("hr",{className:"border border-primary border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(d=s.base64)==null?void 0:d.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-primary  bg-blueW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:o,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primaryMuiBlue text-white",onClick:()=>{N(s)},children:"Confirmar Cambio"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},wr=({data1:s,data2:r})=>{const[t,c]=a.useState(!1),i=()=>c(!1),[l,n]=a.useState(!1),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(""),d=(()=>{const v=localStorage.getItem("user");return v?JSON.parse(v):null})(),b=async()=>{if(window.confirm(`¿Estás seguro de que deseas ${j}?`)){n(!0);try{const v=W(A,"db_personas",s.id),w=new Date,D=`${w.getDate().toString().padStart(2,"0")}/${(w.getMonth()+1).toString().padStart(2,"0")}/${w.getFullYear().toString().slice(-2)}`;await me(v,{...s,captura:!0,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:d.email,captura_fecha:D,captura_autor:h,captura_descripcion:o}]}),r(),n(!1),alert(`${j} realizado.`)}catch(v){console.error("Error al modificar persona: ",v),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},m=async v=>{console.log(v),n(!0);try{const w=W(A,"db_personas",v),D=new Date,p=`${D.getDate().toString().padStart(2,"0")}/${(D.getMonth()+1).toString().padStart(2,"0")}/${D.getFullYear().toString().slice(-2)}`;await le(w,{...v,prioridad:1,capturas_informacion_estados:[...v.capturas_informacion_estados||[],{captura_motivo:"desactivar alerta",captura_informa_usuario:d.email,captura_fecha:p}]}),r(),n(!1),alert("Alerta desactivada correctamente.")}catch{alert("No se pudo desactivar la alerta.")}},f=()=>{c(!0),g("Informar Captura de Persona")},C=async()=>{if(window.confirm("¿Estás seguro de que deseas QUITAR EL ESTADO DE  CAPTURADO ?")){n(!0);try{const v=W(A,"db_personas",s.id),w=new Date,D=`${w.getDate().toString().padStart(2,"0")}/${(w.getMonth()+1).toString().padStart(2,"0")}/${w.getFullYear().toString().slice(-2)}`;await le(v,{...s,captura:!1,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"quitar estado de captura",captura_quita_estado_usuario:d.email,captura_quita_fecha:D}]}),r(),alert("Captura quitada correctamente."),n(!1)}catch(v){console.error("Error al quitar la captura:",v),alert("No se pudo quitar la captura. Inténtalo de nuevo."),n(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx("td",{className:s.captura?"bg-redW ":"",children:e.jsxs("div",{className:"d-flex flex-column gap-1",children:[s.captura?e.jsx("button",{className:"btn btn-pink text-white btn-sm w-100",onClick:()=>{C()},children:"Quitar Captura"}):e.jsx("button",{className:"btn btn-primary btn-sm w-100",onClick:f,disabled:l,children:"Marcar Capturado"}),s.alerta?e.jsx("button",{className:"btn btn-secondaryMuiRed text-white btn-sm w-100",onClick:()=>{window.confirm("¿Seguro que deseas desactivar la alerta?")&&m(s.id)},children:"Desactivar Alerta"}):e.jsx("button",{className:"btn btn-secondaryM btn-sm w-100",disabled:!0,children:"Alerta Inactiva"})]})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsxs("h5",{className:"modal-title mx-3",children:[j," "]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:i})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3 mt-3 d-flex align-items-center",children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},children:[e.jsx("img",{src:s.base64?s.base64.trim():"",alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:e.jsx("span",{children:"Capturado  👮 "})})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.nombre_apellido,disabled:!0}),e.jsx("label",{className:"badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border",value:s.documento,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.sexo,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Sexo"})]})})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM"}),j," ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:h,onChange:v=>u(v.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:o,onChange:v=>x(v.target.value)})]})]}),e.jsxs("p",{className:"text-primary bg-blueW rounded my-2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:i,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!h||!o||l,children:j})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},As=({personas:s,selectedDocs:r,toggleSelectDoc:t,toggleSelectAll:c,getPrioridadLabel:i,fetchPersonas:l,isFiltered:n,color:o,prioridad:x})=>e.jsx("div",{className:"table-responsive-sm mt-5 ",children:e.jsxs("table",{className:"table table-striped table-hover  text-center small ",children:[e.jsx("thead",{className:"table-info",children:e.jsxs("tr",{className:"bg-light",children:[!n&&e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:r.length===s.length,onChange:c})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell ",children:"Entidad"}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"DNI"}),x===3?e.jsx("th",{className:"d-none d-sm-table-cell",children:"Fecha"}):null,e.jsx("th",{className:"d-none d-sm-table-cell",children:"Prioridad"}),x===3?e.jsx("th",{}):null,e.jsx("th",{})]})}),e.jsx("tbody",{children:s.map(h=>{var u;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{className:h.captura?"bg-redW":"",children:e.jsx("input",{type:"checkbox",checked:r.includes(h.id),onChange:()=>t(h.id)})}),e.jsx("td",{className:h.captura?"bg-redW ":"",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((u=h.base64)==null?void 0:u.trim())||fe,alt:h.nombre_apellido,className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize d-inline-block text-truncate",children:h.nombre_apellido})]})}),e.jsx("td",{className:`d-none d-sm-table-cell text-dark ${h.captura?"bg-redW":o}`,children:h.entidad}),e.jsx("td",{className:h.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:h.documento}),x===3?e.jsx("th",{className:h.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:h.date}):null,e.jsx("td",{className:h.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:h.captura?e.jsx("span",{className:"badge bg-dark",children:"Capturado 👮"}):i(h.prioridad)}),x===3?e.jsx(wr,{data1:h,data2:l}):null,e.jsxs("td",{className:h.captura?"bg-redW":"",children:[x===4?e.jsx(vr,{data1:h,data2:l}):null,x===2?e.jsx(yr,{data1:h,data2:l}):null,e.jsx(ma,{data1:h,data2:l})]})]},h.id)})})]})}),Ms=s=>{switch(Number(s)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}},Is=s=>{const[r,t]=a.useState([]),[c,i]=a.useState(!0),l=Y(A,"db_personas"),n=async()=>{i(!0);try{let x=(await X(l)).docs.map(h=>({...h.data(),id:h.id}));x=x.filter(h=>h.prioridad===s),t(x)}catch(o){console.error("Error al obtener personas: ",o)}finally{i(!1)}};return a.useEffect(()=>{n()},[]),{personas:r,loading:c,fetchPersonas:n}},Ls=s=>{const[r,t]=a.useState([]);return{selectedDocs:r,setSelectedDocs:t,toggleSelectDoc:l=>{t(n=>n.includes(l)?n.filter(o=>o!==l):[...n,l])},toggleSelectAll:()=>{if(s&&s.length>0)if(r.length===s.length)t([]);else{const l=s.map(n=>n.id);t(l)}}}},Sr=()=>{const[s,r]=a.useState(4),{personas:t,loading:c,fetchPersonas:i}=Is(s),[l,n]=a.useState([]),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(!0),[N,d]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:m,toggleSelectDoc:f,toggleSelectAll:C}=Ls(l||[]),v=o||h;return a.useEffect(()=>{const w=Ds(t,o,h),D=Fs(w,N);n(D)},[o,t,h,N]),e.jsxs("div",{className:"container-lg",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  my-5",children:"Listado de Capturas Prioritarias"}),e.jsxs("div",{className:"card my-5  bg-dark bg-opacity-50 p-4 rounded-4",children:[e.jsx("div",{className:"card-header bg-gradiante2 text-light rounded-2",children:e.jsx("div",{children:"Filtros"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3",children:[e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Es,{prioridadFilter:h,setPrioridadFilter:u,personas:t})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:N,setOrden:d})})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>Ps(x,u,d),className:"btn btn-indigoMui text-light btn-sm",children:"Limpiar Filtros"})})]})})]}),e.jsx("div",{className:"col-12",children:e.jsx(He,{searchTerm:o,setSearchTerm:x})}),c?e.jsx(ne,{}):e.jsx(e.Fragment,{children:l.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(ha,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx(us,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>m([])})]}),j&&e.jsx(We,{Date1:b,Date2:t,setSelectedDocs:m,onCerrar:()=>g(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>g(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-white"})," ",e.jsxs("small",{className:"text-white",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-white",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(As,{personas:l,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:C,getPrioridadLabel:Ms,fetchPersonas:i,isFiltered:v,color:"bg-yellowW",prioridad:s})]})})]})},Cr=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(!1),x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas recuperar estas personas?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await me(C,{...f,recuperado:[...f.recuperado||[],{motivo:"recuperado manual",usuario:g.email,fecha:w,datos_resguardo_baja_previa:[{usuario_baja:f.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:f.usuario_baja_fecha||"fecha_no_disponible"}]}]});const D=W(A,"db_personas_desactivados",f.id);await xe(D)});await Promise.all(m),alert("Personas recuperadas y eliminadas de la colección de desactivados."),t(),u()}catch(b){console.error("Error al recuperar personas:",b),alert("Hubo un error al recuperar o eliminar algunas personas.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:x,disabled:n,children:e.jsx("i",{className:"bi bi-recycle"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Recuperar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-teal border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-greenW p-2 rounded-pill text-primary fw-bold",children:["Se reactivan ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas reactivar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:N,disabled:n,children:n?"Recuperando...":"Confirmar Recuperación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},_r=({data1:s,data2:r})=>{var u;const[t,c]=a.useState(!1),i=()=>c(!0),l=()=>c(!1),o=(()=>{const j=localStorage.getItem("user");return j?JSON.parse(j):null})(),x=async j=>{if(window.confirm("¿Estás seguro de que deseas recuperar esta persona?"))try{const g=W(A,"db_personas",j.id),N=new Date,d=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`,b="campos_modificados_aqui";await me(g,{...j,recuperado:[...j.recuperado||[],{motivo:"recuperado manual",usuario:o.email,fecha:d,datos_resguardo_baja_previa:[{usuario_baja:j.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:j.usuario_baja_fecha||"fecha_no_disponible"}]}]});const m=W(A,"db_personas_desactivados",j.id);await xe(m),r(),alert("Persona recuperada y copiada a la colección de capturas.")}catch(g){console.error("Error al eliminar persona: ",g)}},h=j=>{x(j),l()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-recycle"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Recuperar Persona"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("hr",{className:"border border-teal  border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(u=s.base64)==null?void 0:u.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-primary bg-greenW2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas recuperar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:()=>h(s),children:"Confirmar Recuperación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},kr=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState(!0),[d,b]=a.useState("asc"),m=Y(A,"db_personas_desactivados"),f=async()=>{o(!0);try{const y=(await X(m)).docs.map(S=>({...S.data(),id:S.id}));r(y),c(y)}catch(p){console.error("Error al obtener personas: ",p)}finally{o(!1)}},C=p=>p.sort((y,S)=>d==="asc"?y.nombre_apellido.localeCompare(S.nombre_apellido):S.nombre_apellido.localeCompare(y.nombre_apellido));a.useEffect(()=>{f()},[]),a.useEffect(()=>{const p=s.filter(S=>S.nombre_apellido&&S.nombre_apellido.toLowerCase().includes(x.toLowerCase())||S.documento&&S.documento.includes(x)).filter(S=>u?S.prioridad===parseInt(u,10):!0),y=C(p);c(y)},[x,s,u,d]);const v=p=>{l(y=>y.includes(p)?y.filter(S=>S!==p):[...y,p])},w=()=>{if(i.length===t.length)l([]);else{const p=t.map(y=>y.id);l(p)}},D=p=>{switch(Number(p)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg ",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center mb-5 animate__animated animate__bounce mt-sm-0  ",children:"Listado de Capturas  Desactivadas"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(He,{searchTerm:x,setSearchTerm:h})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(ua,{prioridadFilter:u,setPrioridadFilter:j})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:d,setOrden:b})})]}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2  mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(Cr,{data1:i,data2:s,dataRefresh:f,setSelectedDocs:l}),e.jsx("button",{type:"button",className:"btn-close  btn-close-white mt-1","aria-label":"Close",onClick:()=>l([])})]}),g&&e.jsx(We,{Date1:i,Date2:s,setSelectedDocs:l,onCerrar:()=>N(!1),color:"blueW2"}),!g&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>N(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-white"})," ",e.jsxs("small",{className:"text-white",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-white",children:[i.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:w})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(p=>{var y;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(p.id),onChange:()=>v(p.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((y=p.base64)==null?void 0:y.trim())||"https://via.placeholder.com/40",alt:p.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize",children:p.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:p.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:D(p.prioridad)}),e.jsx("td",{children:e.jsx(_r,{data1:p,data2:f})}),e.jsx("td",{})]},p.id)})})]})})]})})]})},Er=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1),[n,o]=a.useState(!1),x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas modificar estas personas ?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await me(C,{...f,prioridad:1,paradero:!1,alerta:!1,ediciones:[...f.ediciones||[],{motivo:"desactivar busqueda paradero grupal",usuario:g.email,fecha:w}]})});await Promise.all(m),alert("Personas modificadas con exito."),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al modificar algunas personas.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-primaryMuiBlue text-white btn-sm rounded-circle ",onClick:x,disabled:n,children:e.jsx("i",{className:"bi bi-search"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Modificar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-primary border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-blueW p-2 rounded-pill text-primary fw-bold",children:["Se modificarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas modificar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primaryMuiBlue text-white",onClick:N,disabled:n,children:n?"Cargando...":"Confirmar Modificación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Dr=()=>{const[s,r]=a.useState(2),{personas:t,loading:c,fetchPersonas:i}=Is(s),[l,n]=a.useState([]),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(!0),[N,d]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:m,toggleSelectDoc:f,toggleSelectAll:C}=Ls(l||[]),v=o||h;return a.useEffect(()=>{const w=Ds(t,o,h),D=Fs(w,N);n(D)},[o,t,h,N]),e.jsxs("div",{className:"container my-5",children:[e.jsx("h1",{className:"text-center my-5 animate__animated animate__bounce mt-sm-0  ",children:"Listado Busqueda de Paradero"}),e.jsxs("div",{className:"card my-5  bg-dark bg-opacity-50 p-4 rounded-4",children:[e.jsx("div",{className:"card-header bg-gradiante2 text-light rounded-2",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3",children:[e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Es,{prioridadFilter:h,setPrioridadFilter:u,personas:t})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:N,setOrden:d})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>Ps(x,u,d),className:"btn btn-indigoMui btn-sm text-light",children:"Limpiar Filtros"})})]})]}),e.jsx("div",{className:"col-12 ",children:e.jsx(He,{searchTerm:o,setSearchTerm:x})}),c?e.jsx(ne,{}):e.jsx(e.Fragment,{children:l.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[s===4?e.jsx(ha,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}):null,s===2?e.jsx(Er,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}):null,e.jsx(us,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>m([])})]}),j&&e.jsx(We,{Date1:b,Date2:t,setSelectedDocs:m,onCerrar:()=>g(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>g(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2"})," ",e.jsxs("small",{children:["Ver Resumen ( ",e.jsxs("span",{className:"text-primary",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(As,{personas:l,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:C,getPrioridadLabel:Ms,fetchPersonas:i,isFiltered:v,color:"bg-blueW",prioridad:s})]})})]})},Fr=({alertaFilter:s,setAlertaFilter:r})=>e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:t=>r(t.target.value),children:[e.jsx("option",{value:"",children:"Todos los Estados"}),e.jsx("option",{value:"capturado",children:"Capturado"}),e.jsx("option",{value:"evadido",children:"Evadido"})]}),e.jsx("label",{children:"Seleccione un Estado"})]}),Pr=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1);a.useState("");const[n,o]=a.useState(!1),[x,h]=a.useState(""),[u,j]=a.useState(""),g=()=>l(!0),N=()=>l(!1),d=()=>{c([])},m=(()=>{const C=localStorage.getItem("user");return C?JSON.parse(C):null})(),f=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas dar por CAPTURADOS 👮 a este grupo personas ?"))){o(!0);try{const w=r.filter(D=>s.includes(D.id)).map(async D=>{const p=W(A,"db_personas",D.id),y=new Date,S=`${y.getDate().toString().padStart(2,"0")}/${(y.getMonth()+1).toString().padStart(2,"0")}/${y.getFullYear().toString().slice(-2)}`;await le(p,{...D,captura:!0,capturas_informacion_estados:[...D.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:m.email,captura_fecha:S,captura_autor:u,captura_descripcion:x}]})});await Promise.all(w),alert("Capturas Exitosas"),t(),d()}catch(v){console.error("Error al modificar personas:",v),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}o(!1),N()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-primary btn-sm w-100",onClick:g,disabled:n,children:["Marcar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Marcar Grupo como Capturado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:N})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(C=>s.includes(C.id)).map(C=>{var v;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(v=C.base64)==null?void 0:v.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),C.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(w=>w.filter(D=>D!==C.id)),title:"Quitar de la selección"})]},C.id)})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:u,onChange:C=>j(C.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:x,onChange:C=>h(C.target.value)})]}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas marcar como capturados estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:N,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:f,disabled:!u||!x||n,children:n?"Trabajando...":"Confirmar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Ar=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1);a.useState("");const[n,o]=a.useState(!1);a.useState(""),a.useState("");const x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas QUITAR LOS ESTADOS DE CAPTURA 👮 a estas personas ?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await le(C,{...f,captura:!1,capturas_informacion_estados:[...f.capturas_informacion_estados||[],{captura_motivo:"quitar captura",captura_informa_usuario:g.email,captura_fecha:w}]})});await Promise.all(m),alert("Se quito las capturas de forma Exitosa"),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-pink btn-sm w-100",onClick:x,disabled:n,children:["Quitar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Quitar Estado de Capturados a Grupo "}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de  ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas quitar estado de captura ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:N,disabled:n,children:n?"Trabajando...":"Quitar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Mr=({data1:s,data2:r,dataRefresh:t,setSelectedDocs:c})=>{const[i,l]=a.useState(!1);a.useState("");const[n,o]=a.useState(!1);a.useState(""),a.useState("");const x=()=>l(!0),h=()=>l(!1),u=()=>{c([])},g=(()=>{const d=localStorage.getItem("user");return d?JSON.parse(d):null})(),N=async()=>{if(!(!s||s.length===0||!r||r.length===0||!window.confirm("¿Estás seguro de que deseas DESACTIVAR SU ESTADO DE ALERTA EVADIDO 🚨 a este grupo de  personas ?"))){o(!0);try{const m=r.filter(f=>s.includes(f.id)).map(async f=>{const C=W(A,"db_personas",f.id),v=new Date,w=`${v.getDate().toString().padStart(2,"0")}/${(v.getMonth()+1).toString().padStart(2,"0")}/${v.getFullYear().toString().slice(-2)}`;await le(C,{...f,prioridad:1,capturas_informacion_estados:[...f.capturas_informacion_estados||[],{captura_motivo:"desactivar alerta",captura_informa_usuario:g.email,captura_fecha:w}]})});await Promise.all(m),alert("Alrta Modificada Exitosas"),t(),u()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}o(!1),h()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-secondaryMuiRed btn-sm w-100 text-white",onClick:x,disabled:n,children:["Desactivar Alerta (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border titilar",children:"🚨"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Desactivar Alerta Evadido"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:r.filter(d=>s.includes(d.id)).map(d=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=d.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),d.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>c(m=>m.filter(f=>f!==d.id)),title:"Quitar de la selección"})]},d.id)})}),e.jsxs("p",{className:"text-primary text-center  titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas desactivar el estado evadido ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:h,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:N,disabled:n,children:n?"Trabajando...":"Desactivar Evadido"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Ir=()=>{const[s,r]=a.useState(3),{personas:t,loading:c,fetchPersonas:i}=Is(s),[l,n]=a.useState([]),[o,x]=a.useState(""),[h,u]=a.useState(""),[j,g]=a.useState(!0),[N,d]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:m,toggleSelectDoc:f,toggleSelectAll:C}=Ls(l||[]),v=o||h,[w,D]=a.useState(""),p=b.every(F=>{const _=t.find(k=>k.id===F);return(_==null?void 0:_.captura)===!0}),y=b.every(F=>{const _=t.find(k=>k.id===F);return(_==null?void 0:_.captura)===!1||(_==null?void 0:_.captura)===void 0}),S=!p&&!y;return a.useEffect(()=>{let F=Ds(t,o,h);F=Nr(F,w);const _=Fs(F,N);n(_)},[o,t,h,N,w]),e.jsxs("div",{className:"container-lg my-5",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  ",children:"Listado de Evasiones"}),e.jsxs("div",{className:"card my-5  bg-dark bg-opacity-50 p-4 rounded-4",children:[e.jsx("div",{className:"card-header bg-gradiante2 text-light rounded-2",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3",children:[e.jsx("div",{className:"col-12 col-sm-4 col-md-8 col-lg-4",children:e.jsx(Es,{prioridadFilter:h,setPrioridadFilter:u,personas:t})}),e.jsx("div",{className:"col-12 col-sm-4 col-md-8 col-lg-4",children:e.jsx(Fr,{alertaFilter:w,setAlertaFilter:D})}),e.jsx("div",{className:"col-12 col-sm-3 col-md-8 col-lg-2",children:e.jsx(Ye,{orden:N,setOrden:d})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>Ps(x,u,d,D),className:"btn btn-indigoMui btn-sm text-light",children:"Limpiar Filtros"})})]})]}),e.jsx("div",{className:"col-12 ",children:e.jsx(He,{searchTerm:o,setSearchTerm:x})}),c?e.jsx(ne,{}):e.jsx(e.Fragment,{children:l.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx("div",{className:"d-flex gap-2 mb-2 justify-content-end mb-2",children:!S&&e.jsxs(e.Fragment,{children:[p&&e.jsx(Ar,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),y&&e.jsx(Pr,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m})]})}),e.jsx(Mr,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx(us,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:m}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>m([])})]}),j&&e.jsx(We,{Date1:b,Date2:t,setSelectedDocs:m,onCerrar:()=>g(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>g(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-light"})," ",e.jsxs("small",{className:"text-light",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-ligh",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(As,{personas:l,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:C,getPrioridadLabel:Ms,fetchPersonas:i,isFiltered:v,color:"bg-redW",prioridad:s})]})})]})},Lr=()=>{const[s,r]=a.useState("dashboard"),[t,c]=a.useState([]),[i,l]=a.useState(!1),n=localStorage.getItem("user");n&&JSON.parse(n);const o=async()=>{try{l(!0);const b=await X(Y(A,"db_personas")),m=[];b.forEach(f=>{m.push({id:f.id,...f.data()})}),c(m)}catch(b){console.error("Error al obtener los documentos: ",b)}finally{l(!1)}};a.useEffect(()=>{o()},[]);const x=t.filter(b=>b.prioridad===3).length,h=t.filter(b=>b.prioridad===1).length,u=t.filter(b=>b.prioridad===2).length,j=t.filter(b=>b.prioridad===4).length,g=t.filter(b=>b.captura===!0).length,N=t.length,d=()=>{switch(s){case"dashboard":return e.jsx(pr,{});case"reportes":return e.jsx(gr,{loading:i});case"graficos":return e.jsx(dr,{totalCapturas:N,totalPrioridadNormal:h,totalParadero:u,totalEvasiones:x,totalPrioritaria:j,totalEvasionesCapturados:g});case"Desactivados":return e.jsx(kr,{});case"capturas":return e.jsx(fr,{});case"evasiones":return e.jsx(Ir,{});case"csv":return e.jsx(ps,{});case"paradero":return e.jsx(Dr,{});case"prioritaria":return e.jsx(Sr,{});case"notificaciones":return e.jsx(br,{loading:i});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsxs("div",{className:"container-lg",children:[e.jsx("div",{className:"row justify-content-center my-4",children:e.jsx("div",{className:"col-12 col-md-10",children:e.jsx("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-wrap gap-3",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Panel de Control"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-toggles2 fs-4 text-dark"})})]})})})}),e.jsxs("div",{className:"row ",children:[e.jsxs("div",{className:"col-12 col-md-4 col-lg-3 ",children:[e.jsx("div",{className:"text-center mt-5",children:e.jsx("h5",{className:"text-indigoMui2",children:"Panel de Control"})}),e.jsxs("div",{className:"list-group p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("button",{className:`list-group-item list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>r("dashboard"),children:"Bienvenido"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="reportes"?"active":""}`,onClick:()=>r("reportes"),children:"Exportación"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="graficos"?"active":""}`,onClick:()=>r("graficos"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Graficos",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-teal rounded-pill",children:"Nuevo"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="notificaciones"?"active":""}`,onClick:()=>r("notificaciones"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Notificaciones",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-primaryMuiBlue rounded-pill",children:"Administrar"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="capturas"?"active":""}`,onClick:()=>r("capturas"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Capturas",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",N]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="evasiones"?"active":""}`,onClick:()=>r("evasiones"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Evasiones",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",x]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="paradero"?"active":""}`,onClick:()=>r("paradero"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Busqueda Paradero",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",u]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="prioritaria"?"active":""}`,onClick:()=>r("prioritaria"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Prioritarias",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",j]})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="csv"?"active":""}`,onClick:()=>r("csv"),children:"Usuarios Csv"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="Desactivados"?"active":""}`,onClick:()=>r("Desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Desactivados",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-cyan rounded-pill",children:"Reactivar"})]})})]})]}),e.jsx("div",{className:"col-12 col-md-8 col-lg-9",children:d()})]})]})},$r=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(Lr,{}),e.jsx(Ce,{})]})})},Rr=()=>e.jsxs("div",{className:"bg-primary bg-gradiante2  ",children:[e.jsx(De,{}),e.jsx($r,{}),e.jsx(je,{})]}),zr=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()},n=()=>{c(!t)};return a.useEffect(()=>{if(i.pathname==="/dashboard"){const o=x=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Herramientas Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("button",{className:`btn btn-${t?"secondary":"purple"}`,onClick:n,children:[t?"Ocultar Formulario":"Ingresar Nuevo Art. 10 Bis",e.jsx("i",{className:`ms-2 bi ${t?"bi-x-circle":"bi-person-add"}`})]})}),t&&e.jsx("div",{className:"container my-4",children:e.jsx(ta,{showModal:s,closeModal:l})})]})]})})}):null},Tr=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const n=o=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Recepción Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(gs,{})})})]})})}):null},Or=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const n=o=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Salida / Egreso Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(_s,{})})})]})})}):null},Br=({showModal:s,closeModal:r})=>{const[t,c]=a.useState(!1),i=we(),l=()=>{c(!1),r()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const n=o=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-md",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Plazas Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(ia,{})})})]})})}):null},Ur=()=>{const[s,r]=a.useState(!1),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState({search:"",estado:"",comisaria:""}),[x,h]=a.useState(!1),[u,j]=a.useState(!1),[g,N]=a.useState(""),d=async()=>{r(!0);try{let v=Y(A,"db_art_diez_bis");if(n.estado==="desactivado")v=Y(A,"db_art_diez_bis_desactivados");else if(n.estado===""){const p=await X(Y(A,"db_art_diez_bis")),y=await X(Y(A,"db_art_diez_bis_desactivados")),S=p.docs.map(k=>({id:k.id,...k.data()})),F=y.docs.map(k=>({id:k.id,...k.data()})),_=[...S,...F];c(_),l(_),r(!1);return}const D=(await X(v)).docs.map(p=>({id:p.id,...p.data()}));c(D),l(D)}catch(v){console.error("Error al obtener las notificaciones: ",v)}finally{r(!1)}};a.useEffect(()=>{d()},[n.estado]);const b=v=>{const{name:w,value:D}=v.target;o(p=>({...p,[w]:D}))};a.useEffect(()=>{const{search:v,estado:w,comisaria:D}=n,p=t.filter(y=>{var k,M,$;const S=v===""||((k=y.nombre_apellido)==null?void 0:k.toLowerCase().includes(v.toLowerCase()))||((M=y.dni)==null?void 0:M.toString().includes(v)),F=w===""||(w==="activado"?y.visualidad:!y.visualidad),_=D===""||(($=y.comisaria)==null?void 0:$.toLowerCase())===D.toLowerCase();return S&&F&&_});l(p),p.length===0?h(!0):h(!1)},[n,t]);const m=async(v,w,D)=>{try{if(w){const p=W(A,"db_art_diez_bis",v);await le(p,{visualidad:!1}),await me(W(A,"db_art_diez_bis_desactivados",v),D),await xe(p),d(),alert("Estado desactivado y documento movido a desactivados")}else{const p=W(A,"db_art_diez_bis_desactivados",v),y=D;await me(W(A,"db_art_diez_bis",v),{...y,visualidad:!0}),await xe(p),d(),alert("Estado activado y documento movido a activados")}}catch(p){console.error("Error al actualizar la visualidad: ",p),alert("Hubo un error al cambiar la visualidad.")}},f=()=>j(!1),C=v=>{N(v),j(!0)};return e.jsxs("div",{className:"container-lg text-center mt-5  mt-sm-5 mt-md-0 ms-lg-0",children:[e.jsxs("div",{className:"alert alert-light text-danger text-center bg-white border border-2 shadow-sm",role:"alert",children:["Recuerda que las personas están dentro del contexto ",e.jsx("strong",{children:" 6 horas cumplidas como maximo ( Art. 10 Bis ) desde su Ingreso . "}),"Por lo tanto el sistema da salida automáticamente a esas personas cumplido el plazo."]}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-4 mb-3  mb-sm-5 mb-md-0 mb-lg-0",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:"form-control shadow-sm",name:"search",value:n.search,onChange:b,placeholder:"Buscar por nombre o DNI"}),e.jsx("label",{htmlFor:"search",children:"Buscar por nombre o DNI"})]})}),e.jsx("div",{className:"col-md-4  mb-3 mb-sm-5 mb-md-0 mb-lg-0",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm",name:"estado",value:n.estado,onChange:b,children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:"activado",children:"Activado"}),e.jsx("option",{value:"desactivado",children:"Desactivado"})]}),e.jsx("label",{htmlFor:"estado",children:"Filtrar por estado"})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm",name:"comisaria",value:n.comisaria,onChange:b,children:[e.jsx("option",{value:"",children:"Todas las comisarías"}),[...new Set(t.map(v=>v.comisaria).filter(Boolean))].map(v=>e.jsx("option",{value:v,children:v},v))]}),e.jsx("label",{htmlFor:"comisaria",children:"Filtrar por comisaría"})]})})]}),x&&e.jsx("div",{className:"alert alert-danger",children:"No se encontraron coincidencias"}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-6 col-md-3 mt-4",children:[e.jsxs("button",{className:"btn btn-primary text-white fw-semibold mt-3 w-100",onClick:()=>C("panel"),children:["Nuevo 10 Bis"," ",e.jsx("i",{className:"bi bi-person-add rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-teal text-white fw-semibold mt-3 w-100",onClick:()=>C("recepcion"),children:["Recepción 10 Bis"," ",e.jsx("i",{className:"bi bi-people-fill rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-secondaryMuiRed text-white fw-semibold mt-3 w-100",onClick:()=>C("estadio"),children:["Alojados 10 Bis"," ",e.jsx("i",{className:"bi bi-person-raised-hand rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-orange text-white fw-semibold mt-3 w-100",onClick:()=>C("plazas"),children:["Plazas 10 Bis"," ",e.jsx("i",{className:"bi bi-shield-lock rounded-circle border border-2 p-1 m-1"})]})]}),e.jsx("div",{className:"col-12 col-md-9 mt-4",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h3",{children:"Actividad Art 10 Bis"})}),s?e.jsx(ne,{}):e.jsx("div",{className:"list-group",children:i.map(v=>e.jsxs("div",{className:`list-group-item mb-3 shadow ${v.visualidad?"bg-greenW2":"bg-redW"}`,children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:v.nombre_apellido||"Sin nombre"})," -"," ",v.dni||"Sin DNI"]}),e.jsx("button",{className:`btn fw-semibold btn-sm ${v.visualidad?"btn-pink text-white rounded-pill":"btn-teal text-white rounded-pill"}`,onClick:()=>m(v.id,v.visualidad,v),children:v.visualidad?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-eye-slash me-1"})," Ocultar"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-eye me-2"})," Activar"]})})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("small",{children:[v.selectedLocalidad||"Localidad desconocida"," -"," ",v.comisaria||"Comisaría desconocida"," -"," ",v.timestamp?v.timestamp.split(",")[0]+" "+v.timestamp.split(",")[1].trim().slice(0,5)+" hs":"Fecha no disponible"]})})]},v.id))})]})})]}),u&&g==="panel"&&e.jsx(zr,{showModal:u,closeModal:f}),u&&g==="recepcion"&&e.jsx(Tr,{showModal:u,closeModal:f}),u&&g==="estadio"&&e.jsx(Or,{showModal:u,closeModal:f}),u&&g==="plazas"&&e.jsx(Br,{showModal:u,closeModal:f})]})},qr=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState(!0),n=["comisaria","fecha_ingreso_validado","dni","nombre_apellido","selectedLocalidad","timestamp","unidad","usuario_validado_ingreso","salida_art","salida_art_usuario"],o=async()=>{try{const g=Y(A,"db_art_diez_bis"),N=Y(A,"db_art_diez_bis_desactivados"),[d,b]=await Promise.all([X(g),X(N)]),m=d.docs.map(v=>({id:v.id,...v.data()})),f=b.docs.map(v=>({id:v.id,...v.data()})),C=[...m,...f];r(C),l(!1)}catch(g){console.error("Error al obtener los datos:",g),l(!1)}},x=g=>{c(N=>N.includes(g)?N.filter(d=>d!==g):[...N,g])},h=()=>{c(n)},u=()=>{c([])},j=()=>{if(s.length===0){console.error("No hay datos para descargar");return}if(t.length===0){console.error("Debe seleccionar al menos un campo");return}const g=s.map(b=>{const m={};return t.forEach(f=>{m[f]=b[f]}),m}),N=de.json_to_sheet(g),d=de.book_new();de.book_append_sheet(d,N,"Datos Seleccionados"),Le(d,"Datos_Seleccionados.xlsx")};return a.useEffect(()=>{o()},[]),e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center",style:{minHeight:"55vh"},children:[e.jsxs("h2",{className:"text-center mb-4",children:["Exportar Datos de Art. 10 Bis ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"text-center mb-5 fw-light",children:"Selecciona los campos que deseas incluir en la exportación."}),i?e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm text-light mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-light mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-light mx-2",role:"status"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-center mb-4 flex-wrap gap-2",children:[e.jsx("button",{className:"btn btn-outline-light",onClick:h,children:"Seleccionar Todos"}),e.jsx("button",{className:"btn btn-outline-light",onClick:u,children:"Limpiar Selección"})]}),e.jsx("form",{className:"mb-4 w-100 px-3",children:e.jsx("div",{className:"row p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg border-1 border",children:n.map(g=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",style:{display:"flex",alignItems:"center"},children:e.jsxs("div",{className:"form-check w-100 d-flex align-items-center",children:[e.jsx("input",{type:"checkbox",className:"form-check-input ",id:g,value:g,onChange:()=>x(g),checked:t.includes(g)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:g,children:g})]})},g))})}),t.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn btn-green text-white fw-semibold",onClick:j,children:["Descargar Datos Seleccionados ",e.jsx("i",{className:"bi bi-filetype-xml"})]})})]})]})},Vr=({chartType:s,onChange:r})=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text bg-dark bg-opacity-50 text-white ",id:"inputGroup-sizing-sm",children:"Tipo de gráfico:"}),e.jsxs("select",{className:"form-select text-center ",onChange:r,value:s,children:[e.jsx("option",{value:"bar",children:"Barra"}),e.jsx("option",{value:"line",children:"Línea"}),e.jsx("option",{value:"pie",children:"Pastel"}),e.jsx("option",{value:"doughnut",children:"Doughnut"})]})]}),Gr=({agrupacion:s,onChange:r})=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsxs("span",{className:"input-group-text bg-purpleUi bg-opacity-50 text-white",children:[e.jsx("i",{className:"bi bi-diagram-3-fill me-1"})," Agrupar por"]}),e.jsxs("select",{className:"form-select text-center shadow-sm bg-dark bg-opacity-50 text-white",value:s,onChange:r,children:[e.jsx("option",{value:"comisaria",children:"Comisaría"}),e.jsx("option",{value:"unidad",children:"Unidad"})]})]}),Wr=({coleccionesSeleccionadas:s,onChange:r})=>{const t=["db_art_diez_bis","db_art_diez_bis_desactivados"],c=n=>{const o=s.includes(n);o&&s.length===1||r(o?s.filter(x=>x!==n):[...s,n])},i=n=>n==="db_art_diez_bis"?"Activos":"Históricos",l=n=>n==="db_art_diez_bis"?"bi-person-fill-check":"bi-person-fill-slash";return e.jsx("div",{className:"d-flex justify-content-center gap-3 flex-wrap my-3",children:t.map(n=>{const o=s.includes(n);return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Registros "}),e.jsxs("button",{type:"button",className:`btn d-flex align-items-center gap-2 px-4 py-1 rounded-3 shadow-sm fw-semibold ${o?"btn-light":"btn-outline-light"}`,onClick:()=>c(n),children:[e.jsx("i",{className:`bi ${l(n)} fs-5`}),i(n)]},n)]})})})},Hr=({chartType:s,data:r,options:t})=>{switch(s){case"line":return e.jsx(Oe,{data:r,options:t});case"pie":return e.jsx(ns,{data:r,options:t});case"doughnut":return e.jsx(os,{data:r,options:t});case"bar":default:return e.jsx(ls,{data:r,options:t})}},Yr=(s,r)=>{const[t,c]=a.useState({}),[i,l]=a.useState(!0),[n,o]=a.useState(null);return a.useEffect(()=>{const x=async()=>{try{const h={};for(const u of r)(await X(Y(A,u))).forEach(g=>{const N=g.data()[s];N&&(h[N]=(h[N]||0)+1)});c(h)}catch(h){o(h),console.error("Error fetching data:",h)}finally{l(!1)}};r.length>0?(l(!0),x()):(c({}),l(!1))},[s,r]),{data:t,loading:i,error:n}},Jr=()=>{const[s,r]=a.useState("bar"),[t,c]=a.useState("comisaria"),[i,l]=a.useState(["db_art_diez_bis","db_art_diez_bis_desactivados"]),{data:n,loading:o,error:x}=Yr(t,i);if(o)return e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm text-white mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-white mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-white mx-2",role:"status"})]});if(x)return e.jsx("p",{className:"alert alert-danger text-center",children:"Error cargando datos."});if(!n)return null;const h=Object.values(n).reduce((f,C)=>f+C,0),j=[" #1de9b6"," #ffca28"," #f73378"," #16B1FF"," #7e57c2"," #e353d3"," #c7f7d4"," #ffef62"," #05F2D4"].slice(0,9),g=Object.keys(n),N=Object.values(n),d={labels:g,datasets:[{label:`Total por ${t[0].toUpperCase()+t.slice(1)} (${h})`,data:N,backgroundColor:j,borderColor:"white",borderWidth:2,color:"#ffffff"}]},b={duration:1e3,easing:"easeOutBounce"},m={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#ffffff"}},title:{display:!0,text:`Total de Casos por ${t[0].toUpperCase()+t.slice(1)}`,color:"#ffffff",font:{size:20}},tooltip:{bodyColor:"#ffffff",titleColor:"#ffffff"}},animation:b,scales:s==="pie"||s==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{stepSize:1,color:"#ffffff"},grid:{color:"rgba(255, 255, 255, 0.2)"}},x:{beginAtZero:!0,ticks:{stepSize:1,color:"#ffffff"},grid:{color:"rgba(255, 255, 255, 0.2)"}}}};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-center my-5 text-light",children:"Estadísticas / Gráficos"}),e.jsxs("div",{className:"row justify-content-center mb-3",children:[e.jsx("div",{className:"col-12 col-md-5 mb-2",children:e.jsx(Vr,{chartType:s,onChange:f=>r(f.target.value)})}),e.jsx("div",{className:"col-12 col-md-5 mb-2",children:e.jsx(Gr,{agrupacion:t,onChange:f=>c(f.target.value)})}),e.jsx("div",{className:"col-12 col-md-10",children:e.jsx(Wr,{coleccionesSeleccionadas:i,onChange:l})})]}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10",style:{height:"400px"},children:e.jsx(Hr,{chartType:s,data:d,options:m})})})]})};Xe.register(as,ts,is,rs,Ke,es,ss);const xa=({personas:s,visible:r,setVisible:t})=>{const c=a.useMemo(()=>{const l={};s.forEach(x=>{var u,j;const h=(j=(u=x.fecha_ingreso_validado)==null?void 0:u.toDate)==null?void 0:j.call(u);if(h){const g=h.getDate().toString().padStart(2,"0"),N=(h.getMonth()+1).toString().padStart(2,"0"),d=h.getFullYear(),b=`${g}-${N}-${d}`;l[b]=(l[b]||0)+1}});const n=Object.keys(l).sort(),o=n.map(x=>l[x]);return{labels:n,datasets:[{label:"Ingresos por día",data:o,fill:!1,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgb(75, 192, 192)",tension:.2}]}},[s]),i={responsive:!0,plugins:{legend:{position:"top"},title:{display:!1},datalabels:{anchor:"end",align:"top",color:"#000",font:{weight:"bold"},formatter:l=>l}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto m",onClick:()=>t(!r)})}),e.jsx("div",{className:"card shadow-sm  mt-1",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center",children:"📆 Ingresos en el tiempo"}),e.jsx(Oe,{data:c,options:i})]})})]})},ba=({personas:s,seleccionadas:r=[],visible:t,setVisible:c})=>{const i=a.useMemo(()=>{const l=s.length,n=r.length,o={},x={};return s.forEach(h=>{const u=h.unidad||"Sin unidad",j=h.comisaria||"Sin comisaría";o[u]=(o[u]||0)+1,x[j]=(x[j]||0)+1}),{total:l,totalSeleccionadas:n,porUnidad:o,porComisaria:x}},[s,r]);return e.jsx("div",{className:"mb-4",children:t&&e.jsxs("div",{className:"text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg ",children:[e.jsx("div",{className:"d-flex justify-content-end my-2 ",children:e.jsx("button",{type:"button",className:"btn-close btn-close-white ms-auto mb-2",onClick:()=>c(!t)})}),e.jsxs("div",{className:"row row-cols-1 row-cols-md-4 g-3 ",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3 bg-light",style:{width:"60px",height:"60px"},children:e.jsx("i",{className:"bi bi-people fs-3 text-dark"})}),e.jsx("h6",{className:"card-title mb-1",children:"Total registros"}),e.jsx("span",{className:"badge bg-primary fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.total})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#0d6efd",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center text-ligh",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3 bg-light",style:{width:"60px",height:"60px"},children:e.jsx("i",{className:"bi bi-check-circle fs-3 text-secondaryM"})}),e.jsx("h6",{className:"card-title mb-1",children:"Seleccionados"}),e.jsx("span",{className:"badge bg-secondaryM fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.totalSeleccionadas})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#03dac6",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-car-front  me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Unidades"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porUnidad).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsx("span",{cl:!0,children:l}),e.jsx("span",{className:"badge bg-indigo mb-2",children:n})]},l))})]})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-shield-lock me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Comisarías"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porComisaria).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:l}),e.jsx("span",{className:"badge bg-blue mb-2",children:n})]},l))})]})})})]})]})})},pa=({searchTerm:s,setSearchTerm:r,orden:t,setOrden:c,prioridadFilter:i,setPrioridadFilter:l,comisariaFilter:n,setComisariaFilter:o,fechaInicio:x,setFechaInicio:h,fechaFin:u,setFechaFin:j,personas:g=[],visible:N,setVisible:d})=>{const b=[...new Set(g.map(v=>v.unidad))],m=[...new Set(g.map(v=>v.comisaria))],f=s||t!=="asc"||i||n||x||u,C=()=>{r(""),c("asc"),l(""),o(""),h(""),j("")};return N&&e.jsxs("div",{className:"text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"d-flex justify-content-end mt-2",children:e.jsx("button",{type:"button",className:"btn-close btn-close-white  ms-auto",onClick:()=>d(!N)})}),e.jsxs("div",{className:"card shadow-sm border-0 my-2 text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"card-header text-center bg-light bg-opacity-50 rounded-4 shadow-lg text-white p-1 rounded-2 mx-3 my-2",children:e.jsxs("h5",{children:[e.jsx("i",{className:"bi bi-funnel-fill me-2"}),"Filtros"]})}),e.jsxs("div",{className:"card-body px-4",children:[e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-3 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Buscar por Nombre"}),e.jsx("input",{type:"text",className:"form-control",value:s,onChange:v=>r(v.target.value),placeholder:"Ej: Juan Pérez"})]}),e.jsxs("div",{className:"col-12 col-md-2 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Orden"}),e.jsxs("select",{className:"form-select",value:t,onChange:v=>c(v.target.value),children:[e.jsx("option",{value:"asc",children:"Ascendente (A-Z)"}),e.jsx("option",{value:"desc",children:"Descendente (Z-A)"})]})]}),e.jsxs("div",{className:"col-12 col-md-3 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Unidad"}),e.jsxs("select",{className:"form-select",value:i,onChange:v=>l(v.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),b.map(v=>e.jsx("option",{value:v,children:v},v))]})]}),e.jsxs("div",{className:"col-12 col-md-3 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Comisaría"}),e.jsxs("select",{className:"form-select",value:n,onChange:v=>o(v.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),m.map(v=>e.jsx("option",{value:v,children:v},v))]})]}),e.jsxs("div",{className:"col-12 col-md-6 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Rango de fechas (Ingreso)"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"date",className:"form-control",value:x,onChange:v=>h(v.target.value)}),e.jsx("span",{className:"input-group-text",children:"a"}),e.jsx("input",{type:"date",className:"form-control",value:u,onChange:v=>j(v.target.value)})]})]})]}),f&&e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{className:"btn btn-danger text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"45px",height:"45px",boxShadow:"0 0.5rem 1rem rgba(0,0,0,0.15)"},onClick:C,title:"Restaurar filtros",children:e.jsx("i",{className:"bi bi-trash"})})})]})]})," "]})},ga=({columnasVisibles:s,setColumnasVisibles:r,visible:t,setVisible:c})=>t&&e.jsxs("div",{className:"text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"d-flex justify-content-end mt-2",children:e.jsx("button",{type:"button",className:"btn-close btn-close-white  ms-auto",onClick:()=>c(!t)})}),e.jsx("div",{className:"card shadow-sm border-0 my-2 text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:e.jsxs("div",{className:"card-body text-light",children:[e.jsxs("h5",{className:"card-title mb-3 text-center bg-primary text-white p-1 rounded-2 bg-light bg-opacity-50 rounded-4 shadow-lg text-white p-2",children:[e.jsx("i",{className:"bi bi-sliders me-2"}),"Mostrar / Ocultar columnas"]}),e.jsx("div",{className:"row",children:Object.entries(s).map(([i,l])=>e.jsx("div",{className:"col-6 col-md-4 mb-2",children:e.jsxs("div",{className:"form-check form-switch ",children:[e.jsx("input",{className:"form-check-input bg-light bg-opacity-50",type:"checkbox",id:`columna-${i}`,checked:l,onChange:()=>r(n=>({...n,[i]:!n[i]}))}),e.jsx("label",{className:"form-check-label",htmlFor:`columna-${i}`,children:i==="usuarioSalida"?"Usuario salida":i.charAt(0).toUpperCase()+i.slice(1)})]})},i))})]})})]}),ja=({filteredPersonas:s,selectedDocs:r,toggleSelectAll:t,toggleSelectDoc:c,columnasVisibles:i})=>{const[l,n]=a.useState(!0);return e.jsx(e.Fragment,{children:s.length===0?e.jsx("div",{className:"alert alert-light text-danger shadow text-center titilar mt-3",children:"Sin registro encontrado."}):e.jsx("div",{className:"table-responsive-sm d-none d-sm-block my-4",children:e.jsxs("div",{className:"card text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg  ",children:[e.jsxs("div",{className:"card-header bg-dark bg-opacity-50  text-white px-3 p-1 d-flex justify-content-between align-items-center rounded-2 mx-2 my-2",children:[e.jsx("div",{style:{width:"32px"}}),e.jsxs("h5",{className:"mb-0 text-center flex-grow-1",children:[e.jsx("i",{className:"bi bi-view-list me-2"}),"Tabla"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-light",onClick:()=>n(!l),children:[e.jsx("i",{className:`bi ${l?"bi-arrows-collapse":"bi-arrows-expand"} me-1`}),l?"Contraer":"Expandir"]})]}),l&&e.jsx("div",{className:"px-3 pb-3",children:e.jsxs("table",{className:"table table-striped table-hover text-center small mb-0 table-info",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:r.length===s.length,onChange:t})}),e.jsx("th",{children:"Nombre"}),i.unidad&&e.jsx("th",{children:"Unidad"}),i.dni&&e.jsx("th",{children:"Documento"}),i.comisaria&&e.jsx("th",{children:"Comisaría"}),i.ingreso&&e.jsx("th",{children:"F Ingreso"}),i.salida&&e.jsx("th",{children:"F Salida"}),i.usuarioSalida&&e.jsx("th",{children:"Salida"})]})}),e.jsx("tbody",{children:s.map(o=>{var x,h,u;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:r.includes(o.id),onChange:()=>c(o.id)})}),e.jsx("td",{className:"text-center",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"rounded-circle bg-primary text-white d-flex justify-content-center align-items-center",style:{width:"30px",height:"30px",fontSize:"0.9rem"},children:((x=o.unidad)==null?void 0:x.charAt(0).toUpperCase())||"?"}),e.jsx("span",{role:"button",onClick:()=>{var f,C,v;const j=((f=o.personal_entrega)==null?void 0:f.map(w=>`${w.nombre} (NI: ${w.ni})
🏢 Unidad: ${o.unidad||"No informada"}`).join(`

`))||"Sin datos",g=((C=o.fecha_ingreso_validado)==null?void 0:C.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"}))||"Sin fecha",N=((v=o.salida_art)==null?void 0:v.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"}))||"Sin fecha",d=o.usuario_validado_ingreso||"Desconocido",b=o.comisaria||"No informada",m=o.salida_art_usuario||"No informada";alert(`👤 Personal que entregó:
${j}

🏢 Comisaría: ${b}
📅 Fecha validación: ${g}
👮 Usuario que validó: ${d}
📅 Fecha salida: ${N}
👮 Usuario que validó salida: ${m}`)},className:"text-decoration-none",children:o.nombre_apellido})]})}),i.unidad&&e.jsx("td",{children:e.jsx("span",{className:"badge bg-primary",children:o.unidad})}),i.dni&&e.jsx("td",{children:o.dni}),i.comisaria&&e.jsx("td",{children:e.jsxs("div",{className:"d-flex flex-column align-items-center gap-1",children:[e.jsx("span",{className:"badge bg-pink",children:o.comisaria}),o.comisaria_recibe===!1&&e.jsx("span",{className:"badge bg-secondaryM titilar",children:"Pendiente Validar"})]})}),i.ingreso&&e.jsx("td",{children:(h=o.fecha_ingreso_validado)==null?void 0:h.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"medium",timeZone:"America/Argentina/Buenos_Aires"})}),i.salida&&e.jsx("td",{children:(u=o.salida_art)==null?void 0:u.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"medium",timeZone:"America/Argentina/Buenos_Aires"})}),i.usuarioSalida&&e.jsx("td",{children:e.jsx("span",{className:"badge bg-teal",children:o.salida_art_usuario})})]},o.id)})})]})})]})})})},Zr=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState("asc"),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!1),[p,y]=a.useState(!1),[S,F]=a.useState(!1),[_,k]=a.useState(!1),M=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotales"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"tabla",componente:"TablaDatos"}],[$,U]=a.useState(M),[Q,H]=a.useState(null),[V,ie]=a.useState({unidad:!0,dni:!0,comisaria:!0,ingreso:!1,salida:!1,usuarioSalida:!1}),oe=Y(A,"db_art_diez_bis_desactivados"),J=async()=>{o(!0);try{const P=(await X(oe)).docs.map(T=>({...T.data(),id:T.id}));r(P),c(P)}catch(I){console.error("Error al obtener personas: ",I)}finally{o(!1)}},Z=I=>I.sort((P,T)=>g==="asc"?P.nombre_apellido.localeCompare(T.nombre_apellido):T.nombre_apellido.localeCompare(P.nombre_apellido)),L=I=>{H(I)},G=I=>{I.preventDefault()},se=I=>{const P=[...$],T=P.findIndex(E=>E.id===Q),z=P.findIndex(E=>E.id===I),[B]=P.splice(T,1);P.splice(z,0,B),U(P)};a.useEffect(()=>{J()},[]),a.useEffect(()=>{const I=s.filter(P=>P.nombre_apellido&&P.nombre_apellido.toLowerCase().includes(x.toLowerCase())).filter(P=>u?P.unidad===u:!0).filter(P=>d?P.comisaria===d:!0).filter(P=>{var E;if(!m&&!C)return!0;const T=(E=P.fecha_ingreso_validado)==null?void 0:E.toDate();if(!T)return!1;const z=m?new Date(m):null,B=C?new Date(C):null;return!(z&&T<z||B&&T>B)});c(Z(I))},[x,u,d,m,C,g,s]);const ae=I=>{l(P=>P.includes(I)?P.filter(T=>T!==I):[...P,I])},re=()=>{if(i.length===t.length)l([]);else{const I=t.map(P=>P.id);l(I)}},ue=()=>{const I=s.filter(B=>i.includes(B.id));if(I.length===0){alert("No hay personas seleccionadas para exportar.");return}const P=I.map(B=>{var E,R;return{Nombre:B.nombre_apellido,Documento:B.dni,Unidad:B.unidad,Comisaría:B.comisaria,"Fecha Ingreso":(E=B.fecha_ingreso_validado)==null?void 0:E.toDate().toLocaleString("es-AR"),"Fecha Salida":(R=B.salida_art)==null?void 0:R.toDate().toLocaleString("es-AR"),"Usuario Salida":B.salida_art_usuario}}),T=de.json_to_sheet(P),z=de.book_new();de.book_append_sheet(z,T,"Seleccionados"),Le(z,"personas_seleccionadas.xlsx")};return e.jsxs("div",{className:"container my-0 my-5 my-sm-5 my-md-0 my-lg-5 ",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado de Art. 10 Bis Historicos"})}),e.jsxs("div",{className:"container mb-4",children:[e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${p?"btn-light":"btn-outline-light"}`,onClick:()=>y(!p),children:[e.jsx("i",{className:`bi ${p?"bi-eye-slash":"bi-eye"} me-1`}),p?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${S?"btn-light":"btn-outline-light"}`,onClick:()=>F(!S),children:[e.jsx("i",{className:`bi ${S?"bi-eye-slash":"bi-eye"} me-1`}),S?"Ocultar filtro":"Ver filtro"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${_?"btn-light":"btn-outline-light"}`,onClick:()=>k(!_),children:[e.jsx("i",{className:`bi ${_?"bi-eye-slash":"bi-eye"} me-1`}),_?"Ocultar columnas":"Ver columnas"]})})]}),e.jsxs("div",{className:"row my-3 row g-2 align-items-center justify-content-center",children:["  ",e.jsx("div",{className:"col-12 col-md-auto",children:e.jsxs("button",{className:"btn btn-green w-100  bg-dark bg-opacity-50 text-light ",onClick:ue,disabled:i.length===0,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-2"}),"Exportar seleccionados a Excel"]})}),e.jsx("div",{className:"col-12 col-md-auto",children:e.jsx("button",{className:"btn btn-primary w-100  bg-light bg-opacity-75 text-dark ",onClick:()=>D(!w),children:w?"Cerrar gráfico 📉":" Gráfico Fechas 📈"})})]})]}),n?e.jsx(ne,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-sm-none",children:t.map(I=>{var P,T;return e.jsx("div",{className:"card mb-3 shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:I.nombre_apellido}),e.jsx("input",{type:"checkbox",checked:i.includes(I.id),onChange:()=>ae(I.id)})]}),V.unidad&&e.jsx("div",{children:e.jsx("span",{className:"badge bg-primary",children:I.unidad})}),V.dni&&e.jsxs("div",{children:["DNI: ",I.dni]}),V.comisaria&&e.jsxs("div",{children:["Comisaría: ",e.jsx("span",{className:"badge bg-pink",children:I.comisaria})]}),V.ingreso&&e.jsxs("div",{children:["Ingreso: ",(P=I.fecha_ingreso_validado)==null?void 0:P.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.salida&&e.jsxs("div",{children:["Salida: ",(T=I.salida_art)==null?void 0:T.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.usuarioSalida&&e.jsxs("div",{children:["Usuario salida: ",e.jsx("span",{className:"badge bg-teal",children:I.salida_art_usuario})]})]})},I.id)})}),$.map(({id:I,componente:P})=>e.jsxs("div",{draggable:!0,onDragStart:()=>L(I),onDragOver:G,onDrop:()=>se(I),className:"my-3 ",children:[P==="ColumnasVisiblesPanel"&&e.jsx(ga,{columnasVisibles:V,setColumnasVisibles:ie,visible:_,setVisible:k}),P==="ResumenTotales"&&e.jsx(ba,{personas:t,seleccionadas:i,visible:p,setVisible:y}),P==="FiltrosPanel"&&e.jsx(pa,{searchTerm:x,setSearchTerm:h,orden:g,setOrden:N,prioridadFilter:u,setPrioridadFilter:j,comisariaFilter:d,setComisariaFilter:b,fechaInicio:m,setFechaInicio:f,fechaFin:C,setFechaFin:v,personas:s,visible:S,setVisible:F}),P==="GraficoPorFechaIngreso"&&w&&e.jsx(xa,{personas:t,visible:w,setVisible:D}),P==="TablaDatos"&&e.jsx(ja,{filteredPersonas:t,selectedDocs:i,toggleSelectAll:re,toggleSelectDoc:ae,columnasVisibles:V})]},I))]})]})},Qr=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState("asc"),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!1),[p,y]=a.useState(!1),[S,F]=a.useState(!1),[_,k]=a.useState(!1),M=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotales"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"tabla",componente:"TablaDatos"}],[$,U]=a.useState(M),[Q,H]=a.useState(null),[V,ie]=a.useState({unidad:!0,dni:!0,comisaria:!0,ingreso:!1,salida:!1,usuarioSalida:!1}),oe=Y(A,"db_art_diez_bis"),J=async()=>{o(!0);try{const P=(await X(oe)).docs.map(T=>({...T.data(),id:T.id}));r(P),c(P)}catch(I){console.error("Error al obtener personas: ",I)}finally{o(!1)}},Z=I=>I.sort((P,T)=>g==="asc"?P.nombre_apellido.localeCompare(T.nombre_apellido):T.nombre_apellido.localeCompare(P.nombre_apellido)),L=I=>{H(I)},G=I=>{I.preventDefault()},se=I=>{const P=[...$],T=P.findIndex(E=>E.id===Q),z=P.findIndex(E=>E.id===I),[B]=P.splice(T,1);P.splice(z,0,B),U(P)};a.useEffect(()=>{J()},[]),a.useEffect(()=>{const I=s.filter(P=>P.nombre_apellido&&P.nombre_apellido.toLowerCase().includes(x.toLowerCase())).filter(P=>u?P.unidad===u:!0).filter(P=>d?P.comisaria===d:!0).filter(P=>{var E;if(!m&&!C)return!0;const T=(E=P.fecha_ingreso_validado)==null?void 0:E.toDate();if(!T)return!1;const z=m?new Date(m):null,B=C?new Date(C):null;return!(z&&T<z||B&&T>B)});c(Z(I))},[x,u,d,m,C,g,s]);const ae=I=>{l(P=>P.includes(I)?P.filter(T=>T!==I):[...P,I])},re=()=>{if(i.length===t.length)l([]);else{const I=t.map(P=>P.id);l(I)}},ue=()=>{const I=s.filter(B=>i.includes(B.id));if(I.length===0){alert("No hay personas seleccionadas para exportar.");return}const P=I.map(B=>{var E,R;return{Nombre:B.nombre_apellido,Documento:B.dni,Unidad:B.unidad,Comisaría:B.comisaria,"Fecha Ingreso":(E=B.fecha_ingreso_validado)==null?void 0:E.toDate().toLocaleString("es-AR"),"Fecha Salida":(R=B.salida_art)==null?void 0:R.toDate().toLocaleString("es-AR"),"Usuario Salida":B.salida_art_usuario}}),T=de.json_to_sheet(P),z=de.book_new();de.book_append_sheet(z,T,"Seleccionados"),Le(z,"personas_seleccionadas.xlsx")};return e.jsxs("div",{className:"container-lg my-5 my-sm-5 my-md-0 my-lg-5 ",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado de Art. 10 Bis Activos"})}),e.jsxs("div",{className:"container mb-4",children:[e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${p?"btn-light":"btn-outline-light"}`,onClick:()=>y(!p),children:[e.jsx("i",{className:`bi ${p?"bi-eye-slash":"bi-eye"} me-1`}),p?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${S?"btn-light":"btn-outline-light"}`,onClick:()=>F(!S),children:[e.jsx("i",{className:`bi ${S?"bi-eye-slash":"bi-eye"} me-1`}),S?"Ocultar filtro":"Ver filtro"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${_?"btn-light":"btn-outline-light"}`,onClick:()=>k(!_),children:[e.jsx("i",{className:`bi ${_?"bi-eye-slash":"bi-eye"} me-1`}),_?"Ocultar columnas":"Ver columnas"]})})]}),e.jsxs("div",{className:"row my-3 row g-2 align-items-center justify-content-center",children:["  ",e.jsx("div",{className:"col-12 col-md-auto",children:e.jsxs("button",{className:"btn btn-green w-100",onClick:ue,disabled:i.length===0,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-2"}),"Exportar seleccionados a Excel"]})}),e.jsx("div",{className:"col-12 col-md-auto",children:e.jsx("button",{className:"btn btn-primary w-100",onClick:()=>D(!w),children:w?"Cerrar gráfico 📉":" Gráfico Fechas 📈"})})]})]}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-info mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-sm-none",children:t.map(I=>{var P,T;return e.jsx("div",{className:"card mb-3 shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:I.nombre_apellido}),e.jsx("input",{type:"checkbox",checked:i.includes(I.id),onChange:()=>ae(I.id)})]}),V.unidad&&e.jsx("div",{children:e.jsx("span",{className:"badge bg-primary",children:I.unidad})}),V.dni&&e.jsxs("div",{children:["DNI: ",I.dni]}),V.comisaria&&e.jsxs("div",{children:["Comisaría: ",e.jsx("span",{className:"badge bg-pink",children:I.comisaria})]}),V.ingreso&&e.jsxs("div",{children:["Ingreso: ",(P=I.fecha_ingreso_validado)==null?void 0:P.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.salida&&e.jsxs("div",{children:["Salida: ",(T=I.salida_art)==null?void 0:T.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),V.usuarioSalida&&e.jsxs("div",{children:["Usuario salida: ",e.jsx("span",{className:"badge bg-teal",children:I.salida_art_usuario})]})]})},I.id)})}),$.map(({id:I,componente:P})=>e.jsxs("div",{draggable:!0,onDragStart:()=>L(I),onDragOver:G,onDrop:()=>se(I),className:"my-3 ",children:[P==="ColumnasVisiblesPanel"&&e.jsx(ga,{columnasVisibles:V,setColumnasVisibles:ie,visible:_,setVisible:k}),P==="ResumenTotales"&&e.jsx(ba,{personas:t,seleccionadas:i,visible:p,setVisible:y}),P==="FiltrosPanel"&&e.jsx(pa,{searchTerm:x,setSearchTerm:h,orden:g,setOrden:N,prioridadFilter:u,setPrioridadFilter:j,comisariaFilter:d,setComisariaFilter:b,fechaInicio:m,setFechaInicio:f,fechaFin:C,setFechaFin:v,personas:s,visible:S,setVisible:F}),P==="GraficoPorFechaIngreso"&&w&&e.jsx(xa,{personas:t,visible:w,setVisible:D}),P==="TablaDatos"&&e.jsx(ja,{filteredPersonas:t,selectedDocs:i,toggleSelectAll:re,toggleSelectDoc:ae,columnasVisibles:V})]},I))]})})]})},Xr=()=>{const[s,r]=a.useState([]),[t,c]=a.useState(""),[i,l]=a.useState("plazas"),[n,o]=a.useState(!0),[x,h]=a.useState(!1),[u,j]=a.useState({comisariaNombre:"",comisariaNumero:"",disponibilidad:!0,plazas_art_10_bis:""}),[g,N]=a.useState({}),[d,b]=a.useState({comisariaNombre:!1,plazas_art_10_bis:!1}),m="1234",f=async()=>{o(!0);try{const M=(await X(Y(A,"db_comisarias"))).docs.map($=>({id:$.id,...$.data()}));r(M)}catch(k){console.error("Error al obtener las comisarías: ",k)}finally{o(!1)}};a.useEffect(()=>{f()},[]);const C=k=>{const{name:M,value:$,type:U,checked:Q}=k.target;if(!(M==="comisariaNombre"&&(!/^[A-Za-zÁÉÍÓÚÑáéíóúñ\s]*$/.test($)||$.startsWith(" ")))){if(M==="comisariaNumero"){if($===""||/^\d+$/.test($)&&Number($)<=40&&Number($)>=0){j({...u,[M]:$});return}return}if(M==="plazas_art_10_bis"){const H=parseInt($,10);$!==""&&(isNaN(H)||H<0||H>99)?b({...d,plazas_art_10_bis:!0}):b({...d,plazas_art_10_bis:!1})}j({...u,[M]:U==="checkbox"?Q:$})}},v=(k,M,$)=>{N({...g,[k]:{...g[k],[M]:M==="disponibilidad"?$==="true":$}})},w=async k=>{const{plazas_art_10_bis:M,disponibilidad:$}=g[k]||{};if(window.confirm("¿Estás seguro de que quieres guardar los cambios?"))try{const Q=W(A,"db_comisarias",k),H={};if(M!==void 0){const V=parseInt(M,10);if(isNaN(V)||V<0||V>30){alert("Por favor, ingresa un número válido de plazas entre 0 y 30.");return}H.plazas_art_10_bis=V}$!==void 0&&(H.disponibilidad=$),await le(Q,H),N(V=>{const ie={...V};return delete ie[k],ie}),f()}catch(Q){console.error("Error al actualizar comisaría: ",Q)}},p=(()=>{const k=localStorage.getItem("user");return k?JSON.parse(k):null})(),y=async k=>{k.preventDefault();const M=u.comisariaNombre.trim(),$=u.comisariaNumero.trim(),U=parseInt(u.plazas_art_10_bis,10),Q={comisariaNombre:!M,plazas_art_10_bis:isNaN(U)||U<0||U>99};if(b(Q),Object.values(Q).some(Z=>Z)||!window.confirm("¿Estás seguro de agregar esta comisaría?"))return;if(prompt("⚠️ Para continuar, ingresá el código llave:")!==m){alert("❌ Código incorrecto. No se agrego la comisaría.");return}const ie=$?`${M} ${parseInt($,10)}`.toLowerCase():M.toLowerCase(),oe=new Date,J=`${oe.getDate().toString().padStart(2,"0")}/${(oe.getMonth()+1).toString().padStart(2,"0")}/${oe.getFullYear().toString().slice(-2)}`;try{await ye(Y(A,"db_comisarias"),{comisaria:ie,plazas_art_10_bis:U,disponibilidad:u.disponibilidad,usuario:p.email,fecha:J}),j({comisariaNombre:"",comisariaNumero:"",disponibilidad:!0,plazas_art_10_bis:""}),f(),alert("Comisaría agregada con éxito.")}catch(Z){console.error("Error al agregar comisaría: ",Z)}},S=async k=>{if(!window.confirm("¿Estás seguro de que quieres eliminar esta comisaría?"))return;if(prompt("⚠️ Para continuar, ingresá el código llave:")!==m){alert("❌ Código incorrecto. No se eliminará la comisaría.");return}try{const U=W(A,"db_comisarias",k);await xe(U),f(),alert("✅ Comisaría eliminada correctamente.")}catch(U){console.error("Error al eliminar comisaría: ",U)}},_=[...s.filter(k=>k.comisaria.toLowerCase().includes(t.toLowerCase()))].sort((k,M)=>i==="plazas"?M.plazas_art_10_bis-k.plazas_art_10_bis:i==="nombre"?k.comisaria.localeCompare(M.comisaria):i==="estado"?k.disponibilidad===M.disponibilidad?0:k.disponibilidad?-1:1:0);return e.jsxs("div",{className:"container mt-0 mt-5 mt-sm-5 mt-md-0 my-lg-5 ",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Comisarias / Plazas"}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"card shadow position-relative  d-flex align-items-start gap-3  p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",style:{overflow:"visible"},children:[e.jsx("div",{className:"bg-red",children:e.jsx("img",{src:"img/tupel.gif",alt:"Asistente",className:"position-absolute rounded-circle shadow p-2",style:{width:"130px",height:"auto",objectFit:"contain",top:"-15px",left:"-10px"}})}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:"Bienvenido 👮‍♂️ "}),e.jsx("p",{className:"mb-3 text-capitalize m-0",children:"Puedes crear una nueva comisaría, administrando sus plazas disponibles y estado"}),e.jsx("div",{className:"d-flex justify-content-end align-items-center",children:e.jsxs("button",{className:`btn fw-semibold  ${x?"btn-outline-light":"btn-light"}`,onClick:()=>h(!x),children:[e.jsx("i",{className:"bi bi-shield-plus me-2"}),x?"Cancelar":"Nueva Comisaría"]})})]})]})}),x&&e.jsx("form",{onSubmit:y,className:"my-5",children:e.jsxs("div",{className:"row g-3 justify-content-center p-4 bg-light bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"col-12 col-md-5",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control ${d.comisariaNombre?"is-invalid":""}`,id:"comisariaNombre",name:"comisariaNombre",value:u.comisariaNombre,onChange:C}),e.jsx("label",{htmlFor:"comisariaNombre",children:"Nombre Comisaría"}),d.comisariaNombre&&e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten letras y espacios (no al inicio)."})]})}),e.jsx("div",{className:"col-12 col-md-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"number",className:`form-control ${d.comisariaNumero?"is-invalid":""}`,id:"comisariaNumero",name:"comisariaNumero",value:u.comisariaNumero,onChange:C}),e.jsx("label",{htmlFor:"comisariaNumero",children:"Número Comisaría"}),d.comisariaNumero&&e.jsx("div",{className:"invalid-feedback",children:"Solo números."})]})}),e.jsx("div",{className:"col-12 col-md-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"number",className:`form-control ${d.plazas_art_10_bis?"is-invalid":""}`,id:"plazas_art_10_bis",name:"plazas_art_10_bis",value:u.plazas_art_10_bis,onChange:C}),e.jsx("label",{htmlFor:"plazas_art_10_bis",children:"Plazas Art. 10 Bis"}),d.plazas_art_10_bis&&e.jsx("div",{className:"invalid-feedback",children:"Debe ingresar un número válido de plazas."})]})}),e.jsx("div",{className:"col-12 col-md-1 d-flex align-items-center justify-content-center",children:e.jsx("button",{type:"submit",className:"btn btn-primary fw-semibold rounded-circle shadow-sm",children:e.jsx("i",{className:"bi bi-plus titilar"})})})]})}),e.jsxs("h3",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white mt-5",children:["Administrar Comisarías ",e.jsx("i",{className:"ms-2 bi bi-list"})]}),e.jsx("div",{className:"container my-4",children:e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 col-md-5 mb-4 mb-md-0",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-dark bg-opacity-50 text-white",children:e.jsx("i",{className:"bi bi-search text-white"})}),e.jsx("input",{type:"text",className:"form-control bg-light bg-opacity-50",placeholder:"Buscar por nombre de comisaría...",value:t,onChange:k=>c(k.target.value)})]})}),e.jsx("div",{className:"col-12 col-md-5",children:e.jsxs("div",{className:"form-floating ",children:[e.jsxs("select",{id:"sortOrder",className:"form-select ",value:i,onChange:k=>l(k.target.value),children:[e.jsx("option",{value:"plazas",children:"Plazas"}),e.jsx("option",{value:"nombre",children:"Nombre"}),e.jsx("option",{value:"estado",children:"Estado"})]}),e.jsx("label",{htmlFor:"sortOrder",children:"Ordenar por:"})]})})]})}),n?e.jsx(ne,{}):e.jsx("ul",{className:"list-group justify-content-center p-4  bg-opacity-50 rounded-4 shadow-lg",children:_.length===0?e.jsxs("li",{className:"list-group-item text-center text-muted  ",children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-danger"}),e.jsx("span",{className:"text-danger",children:" No hay comisarías registradas."})]}):_.map(({id:k,comisaria:M,plazas_art_10_bis:$,disponibilidad:U})=>{var Q,H;return e.jsxs("li",{className:"list-group-item mb-3 justify-content-center p-4 bg-light bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-3 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("div",{className:"spinner-grow spinner-grow-sm me-2 text-purple",role:"status"}),e.jsxs("span",{className:"badge Gradiante25 me-2 text-capitalize",children:[M,"°"]})]}),e.jsxs("div",{className:"col-12 col-md-3 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("span",{className:"badge bg-primaryMuiBlue me-2",children:"Plazas"}),e.jsx("input",{type:"number",value:((Q=g[k])==null?void 0:Q.plazas_art_10_bis)??$,onChange:V=>v(k,"plazas_art_10_bis",V.target.value),className:"form-control d-inline-block  bg-light bg-opacity-50",style:{maxWidth:"120px"}})]}),e.jsxs("div",{className:"col-12 col-md-4 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("span",{className:`badge ${U?"bg-teal":"bg-danger"} me-2`,children:"Estado"}),e.jsxs("select",{value:((H=g[k])==null?void 0:H.disponibilidad)??U,onChange:V=>v(k,"disponibilidad",V.target.value),className:"form-select d-inline-block  bg-light bg-opacity-50",children:[e.jsx("option",{value:!0,children:"Disponible 👍"}),e.jsx("option",{value:!1,children:"Llena ✋ "})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-start justify-content-md-end w-100 mt-2 mt-md-0",children:[g[k]&&e.jsx("button",{className:"btn btn-sm btn-primary me-2 rounded-circle",onClick:()=>w(k),children:e.jsx("i",{className:"bi bi-floppy2"})}),e.jsx("button",{className:"btn btn-sm btn-danger rounded-circle text-white",onClick:()=>S(k),children:e.jsx("i",{className:"bi bi-trash"})})]})]},k)})})]})},Kr=({personas:s,seleccionadas:r=[],visible:t,setVisible:c})=>{a.useEffect(()=>{console.log("Selected IDs recibidos:",s,r)},[s,r]);const i=a.useMemo(()=>{var g,N;const l=s.length,n=r.length,o={},x={},h={};s.forEach(d=>{const b=d.unidad||"Sin unidad",m=d.comisaria||"Sin comisaría",f=d.salida_art_usuario||"Sin usuario";o[b]=(o[b]||0)+1,x[m]=(x[m]||0)+1,h[f]=(h[f]||0)+1});const u=((g=Object.entries(o).sort((d,b)=>b[1]-d[1])[0])==null?void 0:g[0])||null,j=((N=Object.entries(x).sort((d,b)=>b[1]-d[1])[0])==null?void 0:N[0])||null;return{total:l,totalSeleccionadas:n,porUnidad:o,porComisaria:x,topUnidad:u,topComisaria:j,salidaUsuarios:h}},[s,r]);return e.jsx("div",{className:"mb-4",children:t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>c(!t)})}),e.jsxs("div",{className:"row row-cols-1 row-cols-md-4 g-3",children:[e.jsx("div",{className:"col ",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100 ",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",backgroundColor:"rgba(13, 110, 253, 0.1)"},children:e.jsx("i",{className:"bi bi-people fs-3 text-primary"})}),e.jsx("h6",{className:"card-title text-muted mb-1",children:"Total registros"}),e.jsx("span",{className:"badge bg-primary fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.total})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#0d6efd",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:e.jsx("img",{src:"img/trophy.png",alt:"Trofeo",className:"rounded-circle shadow p-4",style:{width:"150px",height:"150px",objectFit:"contain"}})}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#03dac6",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-car-front text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Unidades"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porUnidad).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:[l," ",l===i.topUnidad&&"🏆"]}),e.jsx("span",{className:"badge bg-primary mb-2",children:n})]},l))})]})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Comisarías"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porComisaria).map(([l,n])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:[l," ",l===i.topComisaria&&"🏆"]}),e.jsx("span",{className:"badge bg-secondary mb-2",children:n})]},l))})]})})})]})]})})},el=({personas:s,visible:r,setVisible:t})=>{const c=a.useMemo(()=>{const l={},n={};return s.forEach(o=>{const x=o.salida_art_usuario;if(x){l[x]=(l[x]||0)+1;const h=o.comisaria||"Sin comisaría";n[x]||(n[x]={}),n[x][h]=(n[x][h]||0)+1}}),{conteo:l,comisariasPorUsuario:n}},[s]),i=a.useMemo(()=>{const l=Object.entries(c.conteo);return l.length===0?null:l.sort((n,o)=>o[1]-n[1])[0][0]},[c]);return r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>t(!1)})}),e.jsx("div",{className:"card shadow-sm border-0",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-3",children:[e.jsx("i",{className:"bi bi-person-check-fill text-primary2 me-2"}),"Personal Comisaría Salida"]}),Object.keys(c.conteo).length===0?e.jsx("p",{className:"text-muted",children:"No hay registros de salida."}):e.jsx("ul",{className:"list-group list-group-flush",children:Object.entries(c.conteo).sort((l,n)=>n[1]-l[1]).map(([l,n])=>{let o="";if(l==="sistema")o="Automático DG OJO ⚠️";else{const x=c.comisariasPorUsuario[l];o=Object.entries(x).sort((h,u)=>u[1]-h[1]).map(([h,u])=>`${h} (${u})`).join(", ")}return e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-semibold",children:[l===i&&"🏆","  ",l]}),e.jsxs("div",{className:"text-muted small",children:["🏢 ",o]})]}),e.jsx("span",{className:"badge bg-primary2 rounded-pill",children:n})]},l)})})]})})]}):null},sl=({visible:s,setVisible:r})=>{const[t,c]=a.useState([]);a.useEffect(()=>{(async()=>{const x=(await X(Y(A,"db_art_diez_bis_desactivados"))).docs.map(h=>h.data());c(x)})()},[]);const i=a.useMemo(()=>{const n={};return t.forEach(o=>{Array.isArray(o.personal_entrega)&&o.personal_entrega.forEach(x=>{var g;const h=x.ni,u=((g=x.nombre)==null?void 0:g.split(" ")[0])||x.nombre,j=o.comisaria;n[h]||(n[h]={nombre:u,count:0,comisarias:{}}),n[h].count+=1,j&&(n[h].comisarias[j]=(n[h].comisarias[j]||0)+1)})}),n},[t]);if(!s)return null;const l=Object.entries(i).sort((n,o)=>o[1].count-n[1].count);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>r(!1)})}),e.jsx("div",{className:"card shadow-sm border-0",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-3",children:[e.jsx("i",{className:"bi bi-award-fill text-primaryMuiBlue me-2"}),"Personal Entregas Destacadas"]}),l.length===0?e.jsx("p",{className:"text-muted",children:"No hay registros de entrega."}):e.jsx("ul",{className:"list-group list-group-flush",children:l.map(([n,o],x)=>{const{nombre:h,count:u,comisarias:j}=o,g=t.find(m=>(m.personal_entrega||[]).some(f=>`${f.ni}`===n)),N=(g==null?void 0:g.unidad)||"OTROS";let d="",b="bg-primaryMuiBlue";return x===0?(d="👑",b="bg-yellowMui"):x===1?(d="🥈",b="bg-yellowMui"):x===2&&(d="🥉",b="bg-yellowMui"),e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-semibold",children:[d," ",h," - ",n]}),e.jsxs("div",{className:"text-muted small",children:[N.toUpperCase().includes("MOTORIZADA")?"🏍️":"🚓"," ",N]})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("span",{className:`badge ${b} rounded-pill`,children:u}),e.jsxs("div",{className:"mt-2 text-muted small text-start",children:[e.jsx("strong",{children:"📍 Comisarías:"}),e.jsx("ul",{className:"mb-0 ps-3",children:Object.entries(j).map(([m,f])=>e.jsxs("li",{children:[m,": ",f," ",f===1?"vez":"veces"]},m))})]})]})]},`${n}-${x}`)})})]})})]})},al=({personas:s})=>{const[r,t]=a.useState(null);return a.useEffect(()=>{let c=0,i=0;if(s.forEach(l=>{var x,h;const n=(x=l.fecha_ingreso_validado)==null?void 0:x.toDate(),o=(h=l.salida_art)==null?void 0:h.toDate();if(n&&o&&!isNaN(n)&&!isNaN(o)){const u=o-n;u>=0&&(c+=u,i++)}}),i>0){const l=c/i,n=Math.floor(l/(1e3*60*60)),o=Math.floor(l%(1e3*60*60)/(1e3*60)),x=Math.floor(l%(1e3*60)/1e3);t({horas:n,minutos:o,segundos:x})}else t(null)},[s]),e.jsx("div",{className:"card shadow my-5 border-0 p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",children:e.jsxs("div",{className:"card-body  ",children:[e.jsx("h5",{className:"card-title rounded-3",children:"⏱️ Tiempo Promedio entre Ingreso y Salida"}),r?e.jsx("div",{className:" d-flex justify-content-end align-items-end",children:e.jsxs("p",{className:"mb-0 fs-5 me-3 ",children:[e.jsxs("strong",{children:[r.horas,"h ",r.minutos,"m ",r.segundos,"s"]})," ",e.jsx("span",{className:"titilar",children:" ⏳ "})]})}):e.jsx("p",{className:"text-muted mb-0 ",children:"No hay datos válidos para calcular."})]})})},tl=()=>{const[s,r]=a.useState([]),[t,c]=a.useState([]),[i,l]=a.useState([]),[n,o]=a.useState(!0),[x,h]=a.useState(""),[u,j]=a.useState(""),[g,N]=a.useState("asc"),[d,b]=a.useState(""),[m,f]=a.useState(""),[C,v]=a.useState(""),[w,D]=a.useState(!1),[p,y]=a.useState(!1),[S,F]=a.useState(!1),_=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotalesRendimiento"},{id:"personalEntregaCard",componente:"PersonalEntregaCard"},{id:"personalSalidaCard",componente:"PersonalSalidaCard"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"card",componente:"CardInfo"},{id:"cardComisaria",componente:"ComisariaCardInfo"},{id:"tablaRendimiento",componente:"TablaDatosRendimiento"}],[k,M]=a.useState(_),[$,U]=a.useState(null);console.log(k);const Q=Y(A,"db_art_diez_bis_desactivados"),H=async()=>{o(!0);try{const L=(await X(Q)).docs.map(G=>({...G.data(),id:G.id}));r(L),c(L)}catch(Z){console.error("Error al obtener personas: ",Z)}finally{o(!1)}},V=Z=>Z.sort((L,G)=>g==="asc"?L.nombre_apellido.localeCompare(G.nombre_apellido):G.nombre_apellido.localeCompare(L.nombre_apellido)),ie=Z=>{U(Z)},oe=Z=>{Z.preventDefault()},J=Z=>{const L=[...k],G=L.findIndex(re=>re.id===$),se=L.findIndex(re=>re.id===Z),[ae]=L.splice(G,1);L.splice(se,0,ae),M(L)};return a.useEffect(()=>{H()},[]),a.useEffect(()=>{const Z=s.filter(L=>L.nombre_apellido&&L.nombre_apellido.toLowerCase().includes(x.toLowerCase())).filter(L=>u?L.unidad===u:!0).filter(L=>d?L.comisaria===d:!0).filter(L=>{var re;if(!m&&!C)return!0;const G=(re=L.fecha_ingreso_validado)==null?void 0:re.toDate();if(!G)return!1;const se=m?new Date(m):null,ae=C?new Date(C):null;return!(se&&G<se||ae&&G>ae)});c(V(Z))},[x,u,d,m,C,g,s]),e.jsxs("div",{className:"  my-sm-5 my-md-5 my-lg-5 my-5 ",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center  animate__animated animate__bounce mt-sm-0 ",children:"Rendimiento Art. 10 Bis"})}),e.jsx("div",{className:"container my-4",children:e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${w?"btn-light":"btn-outline-light"}`,onClick:()=>D(!w),children:[e.jsx("i",{className:`bi ${w?"bi-eye-slash":"bi-eye"} me-1`}),w?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${p?"btn-light":"btn-outline-light"}`,onClick:()=>y(!p),children:[e.jsx("i",{className:`bi ${p?"bi-eye-slash":"bi-eye"} me-1`}),p?"Ocultar Persdonal Salida":"Ver Personal Salida"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${S?"btn-light":"btn-outline-light"}`,onClick:()=>F(!S),children:[e.jsx("i",{className:`bi ${S?"bi-eye-slash":"bi-eye"} me-1`}),S?"Ocultar Personal Entrada":"Ver Personal Entrada"]})})]})}),e.jsx(al,{personas:s,visible:S,setVisible:F}),n?e.jsx(ne,{}):e.jsx(e.Fragment,{children:k.map(({id:Z,componente:L})=>e.jsxs("div",{draggable:!0,onDragStart:()=>ie(Z),onDragOver:oe,onDrop:()=>J(Z),className:"my-3 ",children:[L==="ResumenTotalesRendimiento"&&e.jsx(Kr,{personas:t,seleccionadas:i,visible:w,setVisible:D}),L==="PersonalEntregaCard"&&e.jsx(sl,{personas:s,visible:S,setVisible:F}),L==="PersonalSalidaCard"&&e.jsx(el,{personas:s,visible:p,setVisible:y})]},Z))})]})},il=()=>e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center",style:{minHeight:"55vh"},children:[e.jsx("h5",{className:" fs-1 mb-5 text-greenW ",children:"Bienvenido al Panel 10 Bis !!!"}),e.jsxs("div",{className:"row justify-content-center my-4  ",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column justify-content-center align-items-center mb-4 mb-md-0",children:[e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-greenOn text-indigo"}),"Aquí podrás administrar los recursos del sistema de forma fácil y sencilla."]}),e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-lightbulb p-3 rounded-circle me-3 bg-greenOn text-indigo"}),"Recuerda que, ante cualquier problema, puedes solicitar asistencia técnica."]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-center align-items-center",children:e.jsx("img",{src:aa,alt:"Descripción de la imagen",className:"img-fluid p-2 rounded-circle shadow ",style:{maxWidth:"300px",height:"auto"}})})]})]}),rl=()=>{const[s,r]=a.useState("dashboard"),[t,c]=a.useState(!1),i=()=>{switch(s){case"dashboard":return e.jsx(il,{});case"administar":return e.jsx(Ur,{});case"exportacion":return e.jsx(qr,{});case"graficos":return e.jsx(Jr,{});case"comisarias2":return e.jsx(Xr,{});case"rendimiento":return e.jsx(ra,{});case"rendimientoApp":return e.jsx(tl,{});case"desactivados":return e.jsx(Zr,{});case"activados":return e.jsx(Qr,{});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsxs("div",{className:"container-lg",children:[e.jsx("div",{className:"row justify-content-center my-4",children:e.jsx("div",{className:"col-12 col-md-10",children:e.jsx("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-wrap gap-3",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Panel de Control 10 Bis"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-toggles fs-4 text-dark"})})]})})})}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 col-lg-3 ",children:[e.jsx("div",{className:"text-center mt-5",children:e.jsx("h5",{className:"text-indigoMui2",children:"Panel de Control"})}),e.jsxs("div",{className:"list-group p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("button",{className:`list-group-item list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>r("dashboard"),children:"Bienvenidos"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="exportacion"?"active":""}`,onClick:()=>r("exportacion"),children:"Exportación"}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="graficos"?"active":""}`,onClick:()=>r("graficos"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Graficos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-light",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-teal rounded-pill",children:"Nuevo"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="rendimientoApp"?"active":""}`,onClick:()=>r("rendimientoApp"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Rendimiento Art.10 Bis",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"",children:" 🏆 "})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="comisarias2"?"active":""}`,onClick:()=>r("comisarias2"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Comisarias",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-primaryMuiBlue rounded-pill",children:"Administar"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="activados"?"active":""}`,onClick:()=>r("activados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Art 10 Bis Activos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-secondaryM rounded-pill",children:"Panel"})]})}),e.jsx("button",{className:`list-group-item list-group-item-action ${s==="desactivados"?"active":""}`,onClick:()=>r("desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Art 10 Bis Historicos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-secondaryM rounded-pill",children:"Panel"})]})})]})]}),e.jsx("div",{className:"col-12 col-md-8 col-lg-9",children:i()})]})]})},ll=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`},children:[e.jsx(rl,{}),e.jsx(Ce,{})]})})},nl=()=>e.jsxs("div",{className:"bg-primary bg-gradiante2  ",children:[e.jsx(De,{}),e.jsx(ll,{}),e.jsx(je,{})]}),ol=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=[],c=()=>{r(0),t.push(setTimeout(()=>r(1),0)),t.push(setTimeout(()=>r(2),3e3)),t.push(setTimeout(()=>r(3),6e3))};c();const i=setInterval(()=>{c()},9e3);return()=>{t.forEach(clearTimeout),clearInterval(i)}},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:" text-white px-3",children:e.jsx("div",{className:"container min-vh-100 d-flex justify-content-center align-items-center  ",children:e.jsxs("div",{className:"row align-items-center text-center text-md-start",children:[e.jsxs("div",{className:"col-12 col-md-6 mb-5 mb-md-0  ",children:[e.jsxs("div",{className:"p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg my-4",children:[e.jsx("h1",{className:"fw-bold display-1",children:"Cx2"}),e.jsx("h2",{className:"fw-semibold fs-4¿",children:"Santa Fe - Gestión diaria"}),e.jsx("div",{className:"badge bg-white text-dark fw-semibold px-3 py-1 my-2 ",children:" APP DIARIA, SIMPLE Y EFICIENTE.   "})]}),e.jsxs("div",{className:"p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg",children:[e.jsx("p",{className:"fs-5 mt-3 text-center",children:"Tu herramienta ágil para controlar, organizar y comunicar información de forma simple y eficiente."}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("a",{href:"/ingresar",className:"btn btn-light  fw-semibold px-4 me-3",children:"Denuncia Simple "}),e.jsx("a",{href:"/manual",className:"btn btn-outline-light fw-semibold px-4",children:"Administar"})]})]}),e.jsxs("div",{className:"mt-5 small ",children:[e.jsx("p",{children:"Versión: 1.0.0 | Actualización: 05/05/2025"}),e.jsxs("p",{children:["Soporte: ",e.jsx("a",{href:"mailto:ticsdesarrollo2024@gmail.com",className:"text-white text-decoration-underline",children:"ticsdesarrollo2024@gmail.com"})]})]})]}),e.jsx("div",{className:"col-12 col-md-6 d-flex justify-content-center",children:e.jsx("div",{className:"phone-frame bg-black rounded-4 p-2 shadow",children:e.jsxs("div",{className:"bg-white w-100 h-100 rounded-4 d-flex flex-column align-items-center pt-4 position-relative",children:[e.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center text-white fw-bold fs-3",style:{width:"80px",height:"80px"},children:e.jsx("span",{className:"shake",children:"🚀"})}),e.jsx("div",{className:"mt-1 fw-semibold text-dark",children:"Inicio App"}),e.jsxs("div",{className:"d-flex flex-column gap-3 mt-3",style:{width:"230px"},children:[s>=1&&e.jsxs("div",{className:"message-card bg-white text-dark rounded shadow p-2 align-self-start",children:[e.jsx("div",{className:"badge bg-primary text-white mb-1",children:"Usuario"}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"me-2 fs-4",children:"🗣️"}),e.jsx("p",{className:"mb-0 small",children:"¿Dónde debo registrar la denuncia?"})]})]}),s>=2&&e.jsxs("div",{className:"message-card bg-white text-dark rounded shadow p-2 align-self-end",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("div",{className:"badge bg-danger text-white mb-1",children:"Sistema BootSF"})}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"me-2 fs-4",children:"🤖"}),e.jsx("p",{className:"mb-0 small",children:"¡Hola! 🙌 Iniciá la denuncia simple y te voy guiando paso a paso 👋😉"})]}),e.jsxs("p",{className:"mb-0 small text-center mt-",children:["Tema a tratar: ",e.jsx("strong",{children:"Robo"})," • ",e.jsx("strong",{children:"Violencia"})," • ",e.jsx("strong",{children:"Otro"})," ❓"]})]}),s>=3&&e.jsxs("div",{className:"message-card bg-white text-dark rounded shadow p-2 align-self-start",children:[e.jsx("div",{className:"badge bg-primary text-white mb-1",children:"Usuario"}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"me-2 fs-4",children:"🗣️"}),e.jsx("p",{className:"mb-0 small",children:"Entendido. Iniciaré una denuncia simple ahora."})]})]})]}),e.jsx("div",{className:"position-absolute text-center small text-muted",style:{bottom:"40px",padding:"0 1rem"},children:"“Simplificá tu jornada con Cx2”"})]})})})]})})})})},cl=()=>{const[s,r]=a.useState(0);return a.useEffect(()=>{const t=document.querySelector(".navbar");if(t){const c=t.offsetHeight;r(c)}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:" d-flex flex-column justify-content-center align-items-center text-white bg-primary bg-gradiante3",style:{paddingTop:`${s}px`},children:[e.jsx(De,{}),e.jsx(ol,{}),e.jsx(Ce,{})]})})},dl=()=>e.jsx(e.Fragment,{children:e.jsx(cl,{})}),ml=({Promp:s})=>e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center my-5",children:e.jsx("div",{className:"w-75 text-white",children:e.jsx("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:s}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-people-fill fs-4 text-dark"})})]})})})}),ul=({onCiudadChange:s,onComisariaChange:r,clearSignal:t})=>{const[c,i]=a.useState(null),[l,n]=a.useState(null),o=[{ciudad:"Santa Fe",unidad:"UR I"},{ciudad:"Rosario",unidad:"UR II"},{ciudad:"Rafaela",unidad:"UR V"},{ciudad:"Venado Tuerto",unidad:"UR VIII"},{ciudad:"Reconquista",unidad:"UR IX"},{ciudad:"Villa Gobernador Gálvez",unidad:"UR II"},{ciudad:"San Lorenzo",unidad:"UR XVII"},{ciudad:"Esperanza",unidad:"UR XI"},{ciudad:"Casilda",unidad:"UR IV"},{ciudad:"Cañada de Gómez",unidad:"UR X"},{ciudad:"Sunchales",unidad:"UR V"},{ciudad:"Firmat",unidad:"UR VIII"},{ciudad:"Arroyo Seco",unidad:"UR II"},{ciudad:"Tostado",unidad:"UR XII"},{ciudad:"San Jorge",unidad:"UR XVIII"},{ciudad:"Gálvez",unidad:"UR XV"},{ciudad:"Coronda",unidad:"UR XV"},{ciudad:"Avellaneda",unidad:"UR IX"},{ciudad:"El Trébol",unidad:"UR XVIII"},{ciudad:"Las Parejas",unidad:"UR X"},{ciudad:"Funes",unidad:"UR II"},{ciudad:"Puerto General San Martín",unidad:"UR XVII"},{ciudad:"Ceres",unidad:"UR XIII"},{ciudad:"San Justo",unidad:"UR XVI"},{ciudad:"Laguna Paiva",unidad:"UR I"},{ciudad:"Granadero Baigorria",unidad:"UR II"},{ciudad:"Villa Ocampo",unidad:"UR IX"},{ciudad:"Helvecia",unidad:"UR I"},{ciudad:"San Cristóbal",unidad:"UR XIII"},{ciudad:"Carcarañá",unidad:"UR IV"},{ciudad:"Teodelina",unidad:"UR VIII"},{ciudad:"Humboldt",unidad:"UR XI"}],x={"Santa Fe":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barranquitas","Comisaría 3ra. - Sección Rivadavia","Comisaría 4ta. - Sección Las Flores","Comisaría 5ta. - Sección El Pozo","Comisaría 6ta. - Sección Fomento 9 de Julio"],Rosario:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Puerto Norte","Comisaría 3ra. - Sección Tucumán","Comisaría 4ta. - Sección Echesortu","Comisaría 5ta. - Sección Pichincha","Comisaría 6ta. - Sección Zona Sur","Comisaría 7ma. - Sección La Florida","Comisaría 8va. - Sección Zona Oeste"],Rafaela:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Belgrano","Comisaría 3ra. - Sección 9 de Julio","Comisaría 4ta. - Sección Barrio 2 de Abril","Comisaría 5ta. - Sección Barrio La Cañada"],"Venado Tuerto":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Santa Fe","Comisaría 3ra. - Sección Malabrigo"],"San Lorenzo":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Zona Norte","Comisaría 3ra. - Sección Villa Felisa"],Firmat:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Las Delicias"],Casilda:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio San Pedro","Comisaría 3ra. - Sección Barrio Granaderos"],"Cañada de Gómez":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Sarmiento"],Reconquista:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio La Cortada","Comisaría 3ra. - Sección Barrio El Ombú"],Ceres:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio San José"],"San Justo":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio El Paraíso","Comisaría 3ra. - Sección Barrio San Carlos"],Alcorta:["Comisaría 1ra. - Sección Centro"],Totoras:["Comisaría 1ra. - Sección Centro"],"Las Parejas":["Comisaría 1ra. - Sección Centro"]},h=j=>{const g=o.find(N=>N.ciudad===j.target.value);i(g),s(g)},u=j=>{const g=j.target.value;n(g),r(g)};return a.useEffect(()=>{i(""),n(null),s(null),r(null)},[t]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row ",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"¿Cuál es la Localidad?"}),e.jsxs("select",{className:"form-select text-center",onChange:h,defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Elige una ciudad..."}),o.map(j=>e.jsx("option",{value:j.ciudad,children:j.ciudad},j.ciudad))]})]})}),e.jsx("div",{className:"col-6",children:c&&e.jsx("div",{className:"mb-3",children:x[c.ciudad]?e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Comisarías disponibles:"}),e.jsxs("select",{className:"form-select text-center",value:l||"_none_",onChange:u,children:[e.jsx("option",{value:"_none_",disabled:!0,children:"Selecciona una comisaría..."}),x[c.ciudad].map((j,g)=>e.jsx("option",{value:j,children:j},g))]})]}):e.jsx("p",{className:"text-light titilar",children:"No hay comisarías cargadas para esta ciudad."})})})]})})},hl=({ciudadSeleccionada:s,comisariaSeleccionada:r,datosTiempo:t,sumario:c,pdfFile:i,relato:l,people:n})=>{if(!s||!r||!t)return e.jsx("div",{className:"alert alert-danger mt-3 text-center text-dark",children:"Por favor, selecciona la ciudad, comisaría y horario para generar el texto de denuncia."});const o=s.ciudad,x=s.unidad,h=r.split("-")[0].trim(),u=(n==null?void 0:n.filter(g=>g.caridad==="denunciante"))||[],j=u.length>0?u.map((g,N)=>{const d=`${g.nombreApellido} (DNI ${g.dni}, ${g.sexo})`;return u.length===1?d:N===u.length-1?`y ${d}`:d}).join(", ")+(u.length===1?" como denunciante ":" como denunciantes "):"la persona denunciante ";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-light bg-opacity-50 rounded-4 shadow-lg p-4 mt-3",children:[e.jsx("h5",{className:"text-primary mb-3",children:"Denuncia Generada 👮"}),e.jsxs("p",{className:"text-dark fs-5",children:["Siendo aproximadamente las ",e.jsxs("strong",{children:[t," hs"]}),", se presenta ",j,"en la ",e.jsx("strong",{children:h})," de la ciudad de ",e.jsx("strong",{children:o}),", correspondiente a la ",e.jsx("strong",{children:x}),c&&e.jsxs(e.Fragment,{children:[" con número de sumario ",e.jsx("strong",{children:c})]}),", con el fin de radicar una denuncia por hechos que serán detallados a continuación."]}),l&&e.jsx("p",{className:"text-dark mt-2",children:l})]}),e.jsx("div",{className:"mt-4",children:i?e.jsxs("p",{className:"text-secondaryMuiRed fs-6 bg-light bg-opacity-50 rounded-4 shadow-lg p-2",children:["Se ha adjuntado un archivo PDF junto a la denuncia. ",e.jsx("i",{className:"bi bi-file-earmark-pdf ms-1"})]}):e.jsx("p",{className:"text-muted fs-6",children:"No se adjuntó archivo PDF junto a esta denuncia."})})]})},xl=({ciudadSeleccionada:s,comisariaSeleccionada:r,datosTiempo:t,sumario:c,pdfFile:i,relato:l,people:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"  text-dark text-center p-2 bg-light bg-opacity-50 rounded-4 shadow-lg  text-capitalize  ",children:[e.jsxs("p",{className:"mt-3",children:[e.jsxs("span",{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-primary"}),"👮 Iniciando Denuncia -"]}),e.jsxs("span",{className:" fw-semibold",children:[" ",s.ciudad," - "]}),e.jsxs("span",{children:[t," hs"]})]}),r&&e.jsxs("span",{className:"badge bg-primary me-3",children:[r.split("-")[0].trim()," ",e.jsxs("span",{className:"text-indigo border border-indigo border-2 bg-white rounded-pill px-2 py-1 ms-2",children:[s.unidad," "]})]}),c&&e.jsxs("span",{className:"badge bg-purpleUi me-3",children:["Sumario: ",c]}),i&&e.jsxs("span",{className:"rounded-circle p-2 bg-secondaryMuiRed  ",children:["  ",e.jsx("i",{className:" bi bi-filetype-pdf fs-5  text-light  ",children:" "})]}),l&&e.jsx("span",{className:"badge  bg-teal mt-2 d-inline-block",children:"Posee Relato"}),e.jsx("p",{})]}),n.length>0&&e.jsxs("div",{className:"mt-0",children:[e.jsxs("div",{className:"text-purple",children:[" ",e.jsx("i",{className:"bi bi-arrow-down fs-3"})]}),e.jsx("div",{className:"  text-dark text-center p-2 bg-light bg-opacity-50 rounded-4 shadow-lg  text-capitalize  ",children:n.map((o,x)=>e.jsxs("div",{children:[e.jsx("span",{children:"🧑🏻"}),e.jsx("small",{className:"me-2",children:o.dni}),"  ",e.jsx("small",{className:"me-2",children:o.nombreApellido}),e.jsxs("small",{className:"ms-2",children:[o.sexo==="femenino"&&e.jsx("i",{className:"bi bi-gender-female  text-pink"}),o.sexo==="masculino"&&e.jsx("i",{className:"bi bi-gender-male  text-blue"}),o.sexo==="otros"&&e.jsx("i",{className:"bi bi-gender-ambiguous  text-teal"})]})," ",e.jsx("small",{className:`badge ms-2 text-capitalize ${o.caridad==="denunciante"?"text-bg-dark bg-opacity-50  text-white ":o.caridad==="imputado"?"text-bg-pink":""}`,children:o.caridad}),e.jsx("button",{type:"button",className:"btn text-danger btn-sm ms-3",onClick:()=>handleRemovePerson(o),children:e.jsx("i",{className:"bi bi-trash3"})})]},x))})]})]}),bl=({show:s,handleClose:r,people:t,setPeople:c})=>{if(!s)return null;const[i,l]=a.useState({sexo:"otros",nombreApellido:"",dni:"",caridad:"denunciante"}),n=()=>{if(i){const o={sexo:i.sexo||"otros",nombreApellido:i.nombreApellido||"NN",dni:i.dni||"",caridad:i.caridad||"denunciante"};c([...t,o]),console.log("Nueva persona agregada:",o),l({sexo:"otros",nombreApellido:"",dni:"",caridad:"denunciante"}),r()}};return e.jsx("div",{className:"modal fade show bg-dark bg-opacity-75   ",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-gradiante2",children:[e.jsx("h5",{className:"modal-title",children:"Agregar Persona"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:r})]}),e.jsxs("div",{className:"modal-body text-dark",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-8",children:[e.jsx("label",{htmlFor:"nombreApellido",children:"Nombre y Apellido:"}),e.jsx("input",{id:"nombreApellido",type:"text",className:"form-control",value:i.nombreApellido,onChange:o=>l({...i,nombreApellido:o.target.value})})]}),e.jsxs("div",{className:"col-4 ",children:[e.jsx("label",{htmlFor:"sexo",children:"Sexo:"}),e.jsxs("select",{id:"sexo",className:"form-control",value:i.sexo,onChange:o=>l({...i,sexo:o.target.value}),children:[e.jsx("option",{disabled:!0,children:"Seleccione"}),e.jsx("option",{value:"masculino",children:"👨 Masculino"}),e.jsx("option",{value:"femenino",children:"👩 Femenino"}),e.jsx("option",{value:"otros",children:"🧑‍🤝‍🧑 Otros"})]})]})]}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"dni",children:"DNI:"}),e.jsx("input",{id:"dni",type:"text",className:"form-control",value:i.dni,onChange:o=>l({...i,dni:o.target.value})})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"caridad",children:"Caridad:"}),e.jsxs("select",{id:"caridad",className:"form-control",value:i.caridad,onChange:o=>l({...i,caridad:o.target.value}),children:[e.jsx("option",{value:"denunciante",children:"Denunciante"}),e.jsx("option",{value:"victima",children:"Victima"}),e.jsx("option",{value:"imputado",children:"Imputado"})]})]})]})]}),e.jsxs("div",{className:"modal-footer bg-light",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cerrar"}),e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:n,children:[e.jsx("i",{className:"bi bi-person-fill-add  mx-1 "}),"     Agregar"]})]})]})})})},Vs=[{categoria:"Delitos contra la persona",tipos:["Homicidio","Lesiones","Violencia de género","Abuso sexual","Secuestro"]},{categoria:"Delitos patrimoniales",tipos:["Robos","Hurtos","Estafas","Fraude"]},{categoria:"Delitos contra la administración pública",tipos:["Abuso de autoridad","Soborno","Corrupción"]},{categoria:"Delitos contra la propiedad intelectual",tipos:["Contrabando de mercancías","Violación de derechos de autor"]},{categoria:"Delitos ambientales",tipos:["Contaminación","Tráfico ilegal de especies"]},{categoria:"Delitos contra el orden público",tipos:["Disturbios","Desobediencia a la autoridad"]},{categoria:"Delitos contra la fe pública",tipos:["Falsificación de documentos","Falsificación de moneda"]},{categoria:"Delitos de índole federal",tipos:["Narcotráfico","Trata de personas","Lavado de activos"]},{categoria:"Acoso laboral",tipos:["Acoso moral","Acoso sexual","Discriminación"]},{categoria:"Faltas a la probidad administrativa",tipos:["Soborno","Conflicto de intereses","Uso indebido de fondos públicos"]},{categoria:"Violaciones de derechos humanos",tipos:["Violencia de género","Discriminación","Explotación"]},{categoria:"Violaciones de leyes especiales",tipos:["Delitos electorales","Delitos ambientales"]},{categoria:"Denuncias laborales",tipos:["No pago de salarios","Despido injustificado","Incumplimiento contractual"]},{categoria:"Denuncias relacionadas con la salud",tipos:["Atención médica negligente","Falsificación de medicamentos"]},{categoria:"Delitos rurales y abigeato",tipos:["Robo de ganado","Invasión de propiedad rural","Daños a instalaciones agropecuarias"]},{categoria:"Narcotráfico local",tipos:["Tenencia de estupefacientes","Narcomenudeo","Asociación ilícita vinculada"]},{categoria:"Violencia institucional/policial",tipos:["Apremios ilegales","Detenciones arbitrarias","Uso excesivo de la fuerza","Tortura o tratos inhumanos"]},{categoria:"Bandas criminales y mafias locales",tipos:["Extorsión","Balaceras","Intimidación pública","Amenazas"]},{categoria:"Corrupción local",tipos:["Enriquecimiento ilícito","Licitaciones irregulares","Nepotismo","Tráfico de influencias"]},{categoria:"Conflictos urbanos/barriales",tipos:["Usurpación de viviendas","Toma de terrenos","Violencia vecinal"]},{categoria:"Delitos contra menores",tipos:["Grooming","Abandono de persona","Trabajo infantil"]},{categoria:"Situaciones adicionales",tipos:["Conflicto de intereses","Problemas de salud pública"]}],pl=({show:s,handleClose:r,onAceptar:t})=>{var h;const[c,i]=a.useState(""),[l,n]=a.useState(""),o=((h=Vs.find(u=>u.categoria===c))==null?void 0:h.tipos)||[],x=()=>{c&&l?(t(c,l),r()):alert("Debe seleccionar una categoría y un tipo.")};return s?e.jsx("div",{className:"modal fade show bg-dark ",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-gradiante2",children:[e.jsx("h5",{className:"modal-title text-light",children:"Agregar Categoría del Hecho"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:r})]}),e.jsxs("div",{className:"modal-body text-dark",children:[e.jsxs("div",{className:"mb-3 ",children:[e.jsx("label",{className:"form-label ",children:"Categoría"}),e.jsxs("select",{className:"form-select ",value:c,onChange:u=>{i(u.target.value),n("")},children:[e.jsx("option",{value:"",children:"Seleccionar categoría..."}),Vs.map((u,j)=>e.jsx("option",{value:u.categoria,children:u.categoria},j))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Tipo"}),e.jsxs("select",{className:"form-select",value:l,onChange:u=>n(u.target.value),disabled:!c,children:[e.jsx("option",{value:"",children:"Seleccionar tipo..."}),o.map((u,j)=>e.jsx("option",{value:u,children:u},j))]})]})]}),e.jsxs("div",{className:"modal-footer d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:x,children:"Aceptar"})]})]})})}):null},gl=({show:s,handleClose:r,onAceptar:t})=>{const[c,i]=a.useState(""),l=o=>{i(o.target.value)},n=()=>{c.trim()?(t(c),r()):alert("Debe escribir un relato.")};return s?e.jsx("div",{className:"modal fade show bg-dark bg-opacity-75",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-gradiante2",children:[e.jsx("h5",{className:"modal-title text-light",children:"Agregar Relato de la Denuncia"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:r})]}),e.jsx("div",{className:"modal-body text-dark",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"form-floating text-dark",children:[e.jsx("textarea",{className:"form-control",placeholder:"Completa",id:"relatoDenuncia",value:c,onChange:l,style:{height:"150px"}}),e.jsx("label",{htmlFor:"relatoDenuncia",children:"Relato de la denuncia"})]})})}),e.jsxs("div",{className:"modal-footer d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:n,children:"Aceptar"})]})]})})}):null},jl=()=>{const[s,r]=a.useState(!1),[t,c]=a.useState(!1),[i,l]=a.useState(null);console.log(i);const n=(x,h)=>{l({categoria:x,tipo:h}),r(!1)},o=x=>{console.log("Relato recibido:",x),c(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3",children:i&&e.jsx("div",{className:"card text-dark text-center p-2 bg-light bg-opacity-75 rounded-4 shadow-lg my-3",children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("span",{className:"card-title",children:"Categoría Seleccionada"}),e.jsxs("p",{className:"card-text fs-5",children:[e.jsx("span",{className:"fw-bold",children:i.categoria})," - ",i.tipo]})]})})}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3 flex-wrap text-white text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Agregar Categoría",onClick:()=>r(!0),children:e.jsx("i",{className:"bi bi-tags fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Categoria"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Agregar Lugar",children:e.jsx("i",{className:"bi bi-geo-alt-fill fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Lugar"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Agregar Relato",onClick:()=>c(!0),children:e.jsx("i",{className:"bi bi-chat-left-text fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Relato"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Herramienta  Asociar",children:e.jsx("i",{className:"bi bi-person-lines-fill fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Asociar"})]})]}),e.jsx(pl,{show:s,handleClose:()=>r(!1),onAceptar:n}),e.jsx(gl,{show:t,handleClose:()=>c(!1),onAceptar:o})]})},fl=()=>{const[s,r]=a.useState([]),t=()=>{r([...s,{categoria:"",tipo:"",lugar:""}])},c=i=>{const l=s.filter((n,o)=>o!==i);r(l)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"form-footer d-flex flex-row-reverse my-5 ",children:e.jsxs("button",{type:"button",className:"btn text-light text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg   ",onClick:t,children:[e.jsx("i",{className:"bi bi-puzzle mx-2"})," Agregar Hecho/s"]})}),e.jsx("div",{className:"container",children:s.map((i,l)=>e.jsxs("div",{className:"text-dark text-center p-4 bg-light bg-opacity-75 rounded-4 shadow-lg mb-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("div",{className:"flex-grow-1 text-start fw-bold ",children:e.jsxs("span",{className:"bg-light bg-opacity-75 p-2 rounded-4",children:[" Hecho N° ",l+1]})}),e.jsx("button",{type:"button",className:"btn-close ms-2",onClick:()=>c(l)})]}),e.jsx("div",{className:"mb-3",children:e.jsx(jl,{})})]},l))})]})},Nl=()=>{const[s,r]=a.useState(!0),[t,c]=a.useState(null),[i,l]=a.useState(null),[n,o]=a.useState(null),[x,h]=a.useState(""),[u,j]=a.useState(null),[g,N]=a.useState(""),[d,b]=a.useState(!1),[m,f]=a.useState([]),[C,v]=a.useState(!1),w=()=>{v(!0)},D=()=>{v(!1)},p=F=>{if(!F)return"";const _=new Date(F),k=_.getHours().toString().padStart(2,"0"),M=_.getMinutes().toString().padStart(2,"0");return`${_.getDate()}/${_.getMonth()+1}/${_.getFullYear()} ${k}:${M}`},y=F=>{const _=F.target.files[0];j(_)},S=()=>{c(null),l(null),o(null),h(""),N(""),j(null),b(F=>!F),localStorage.removeItem("denuncia")};return e.jsx("div",{className:"container  d-flex justify-content-center align-items-center",children:e.jsxs("div",{className:"row w-100",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3 flex-wrap text-white text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("strong",{className:"d-flex align-items-center",children:[s?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-easel me-2"}),"Modo Gráfico"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-file-text me-2"}),"Modo Texto"]})," ACTIVO"]}),e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-arrow-left-right me-2"}),"Cambiar a modo"]}),e.jsx("button",{type:"button",onClick:()=>r(!0),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${s?"active":""}`,title:"Vista en gráfico",children:e.jsx("i",{className:`bi bi-easel fs-5 ${s?"titilar":""}`})}),e.jsx("button",{type:"button",onClick:()=>r(!1),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${s?"":"active"}`,title:"Vista en texto",children:e.jsx("i",{className:`bi bi-card-text fs-5 ${s?"":"titilar"}`})}),e.jsx("button",{type:"button",onClick:()=>r(!s),className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",title:"Mostrar/Ocultar filtros",children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})]}),e.jsx("div",{className:"text-dark text-center p-4 bg-light bg-opacity-75 rounded-4 shadow-lg mb-4",children:s?e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx("i",{className:"bi bi-easel me-2"}),"Modo Gráfico"]}),t?e.jsx(xl,{ciudadSeleccionada:t,comisariaSeleccionada:i,datosTiempo:p(n),sumario:x,pdfFile:u,relato:g,people:m}):e.jsxs("p",{className:"fs-6",children:["Listo para trabajar"," ",e.jsx("span",{className:"spinner-grow mx-2 text-light",style:{width:"1rem",height:"1rem"},role:"status"})]})]}):e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx("i",{className:"bi bi-file-text me-2"}),"Modo Texto"]}),e.jsx(hl,{ciudadSeleccionada:t,comisariaSeleccionada:i,datosTiempo:p(n),sumario:x,pdfFile:u,relato:g,people:m})]})}),e.jsxs("div",{className:"mt-auto small text-light  ",children:[e.jsx("i",{className:"bi bi-info-circle me-1"}),"Ayuda rápida disponible"]})]}),e.jsxs("div",{className:"col-md-6 text-dark text-center p-4 bg-light bg-opacity-50 rounded-4 shadow-lg mb-4 text-capitalize ",children:[e.jsx("div",{className:"text-center p-4 bg-light bg-opacity-75 rounded-4 shadow-lg mb-4 ",children:e.jsxs("h5",{className:"mb-0",children:[" Comenzamos con la denuncia ",e.jsx("i",{className:"bi bi-flag ms-2 "})]})}),e.jsx("form",{children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg text-light ",children:[e.jsx(ul,{onCiudadChange:F=>{c(F),o(Date.now())},onComisariaChange:F=>l(F),clearSignal:d}),i&&e.jsxs("div",{className:"row mt-text-center",children:[e.jsxs("div",{className:"col-3 mb-3",children:[e.jsx("label",{htmlFor:"numeroSumario",className:"form-label",children:"N° de sumario"}),e.jsx("input",{type:"number",id:"numeroSumario",className:"form-control",placeholder:"Ej: 123/24",value:x,onChange:F=>h(F.target.value)})]}),i&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-9 mb-3",children:[e.jsx("label",{htmlFor:"pdfFile",className:"form-label",children:"¿Posee archivo PDF asociado?"}),e.jsx("input",{type:"file",id:"pdfFile",className:"form-control",accept:"application/pdf",onChange:y}),u&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"text-yellow",children:["Archivo PDF cargado: ",u.name]})})]})})]})]})}),x&&e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3 flex-wrap text-white text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:()=>r(!0),title:"Agregar Vehiculo",children:e.jsx("i",{className:"bi bi-bicycle  fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Vehículo"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:w,title:"Agregar Personas",children:e.jsx("i",{className:"bi bi-person-fill-add  fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Personas"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:()=>r(!0),title:"Agregar Armas",children:e.jsx("i",{className:"bi bi-shield fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Armas"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:()=>r(!0),title:"Agregar elementos",children:e.jsx("i",{className:"bi bi-boxes fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Elementos"})]})]}),e.jsx(fl,{})]}),t&&e.jsx("div",{className:"form-footer d-flex flex-row-reverse mt-3 ",children:e.jsxs("button",{type:"button",className:"btn text-light text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg mb-4 text-capitalize  ",onClick:S,children:[e.jsx("i",{className:"bi bi-trash mx-2"})," Restablecer Campos"]})}),e.jsx(bl,{show:C,handleClose:D,people:m,setPeople:f})]})})},vl={nombre:"Santa Fe Tema",valor:"linear-gradient(135deg, #ec4899, #8b5cf6)",tipo:"gradiente"},yl=[{nombre:"🎨 Santa Fe Theme",valor:"linear-gradient(135deg, #ec4899, #8b5cf6)"},{nombre:"💗 Rosa Chicle",valor:"#f73378"},{nombre:"🌞 Amarillo Sol",valor:"#ffef62"},{nombre:"💦 Celeste Aqua",valor:"#16B1FF"},{nombre:"🔮 Violeta Mágico",valor:"#8C57FF"},{nombre:"🍊 Naranja Fuego",valor:"#ff8f00"},{nombre:"🍇 Púrpura Uva",valor:"#7e57c2"},{nombre:"💙 Azul Profundo",valor:"#3c3ae5"},{nombre:"⚡ Azul Eléctrico",valor:"#0d6efd"},{nombre:"🌿 Verde Menta",valor:"#03dac6"},{nombre:"🍵 Verde Té",valor:"#20c997"},{nombre:"🧪 Verde Neón",valor:"#05F2D4"},{nombre:"🚨 Rojo Alerta",valor:"#f50057"},{nombre:"🪨 Gris Urbano",valor:"#757575"},{nombre:"🌫️ Gris Niebla",valor:"#f9f9f983"},{nombre:"🌌 Negro Noche",valor:"#212121"}],wl=({setThemeBackgroundColor:s})=>{const[r,t]=a.useState(!1),[c,i]=a.useState(()=>localStorage.getItem("theme")==="dark"),[l,n]=a.useState(()=>localStorage.getItem("bgColor")||vl.valor),o=h=>{t(!0),i(h==="dark"),localStorage.setItem("theme",h),setTimeout(()=>t(!1),500)},x=h=>{n(h),s(h),localStorage.setItem("bgColor",h)};return a.useEffect(()=>{const h=c?"dark":"light";document.body.setAttribute("data-bs-theme",h)},[c]),a.useEffect(()=>{s(l)},[l,s]),e.jsxs("div",{children:[r&&e.jsx(ne,{}),e.jsxs("div",{className:"dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle",children:[e.jsxs("button",{className:"btn btn-greenUi py-2 dropdown-toggle d-flex align-items-center rounded-4",id:"bd-theme",type:"button","aria-expanded":"false","data-bs-toggle":"dropdown","aria-label":"Toggle theme",children:[e.jsx("i",{className:c?"bi bi-moon-stars-fill":"bi bi-brightness-high-fill"}),e.jsx("span",{className:"visually-hidden",id:"bd-theme-text",children:"Toggle theme"})]}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow","aria-labelledby":"bd-theme-text",children:[e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${c?"":"active"}`,onClick:()=>o("light"),children:[e.jsx("i",{className:"bi bi-brightness-high-fill me-2 opacity-50"}),"Modo Luz"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${c?"active":""}`,onClick:()=>o("dark"),children:[e.jsx("i",{className:"bi bi-moon-stars-fill me-2 opacity-50"}),"Modo Nocturno"]})}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider"})}),e.jsx("li",{className:"px-3",children:e.jsx("div",{className:"d-flex flex-wrap gap-2",children:yl.map(({nombre:h,valor:u})=>e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>x(u),className:"rounded-circle border-0",style:{background:u,width:"24px",height:"24px",outline:u===l?"2px solid white":"none",cursor:"pointer"},title:h,"aria-label":h})},h))})})]})]})]})},Sl=()=>{const[s,r]=a.useState(0),[t,c]=a.useState(()=>localStorage.getItem(" bg-gradiante3 ")||"#f73378");return a.useEffect(()=>{const i=document.querySelector(".navbar");if(i){const l=i.offsetHeight;r(l)}},[]),e.jsxs("div",{className:"min-vh-100 d-flex flex-column justify-content-center align-items-center text-white gap-5",style:{paddingTop:`${s}px`,background:t,transition:"background 0.5s ease"},children:[e.jsx(De,{}),e.jsx(ml,{Promp:"Denuncia Simple"}),e.jsx(Nl,{}),e.jsx(Ce,{}),e.jsx(wl,{setThemeBackgroundColor:c})]})},Cl=()=>e.jsx(e.Fragment,{children:e.jsx(Sl,{})}),_l=()=>e.jsx(Fa,{children:e.jsx(_a,{children:e.jsx("main",{children:e.jsxs(ka,{children:[e.jsx(he,{path:"/",element:e.jsx(La,{})}),e.jsx(he,{path:"/about",element:e.jsx($a,{})}),e.jsx(he,{path:"/dashboard",element:e.jsx(be,{children:e.jsx(Ts,{})})}),e.jsx(he,{path:"/inicio",element:e.jsx(be,{children:e.jsx(Ts,{})})}),e.jsx(he,{path:"/formularios",element:e.jsx(be,{children:e.jsx(Xt,{})})}),e.jsx(he,{path:"/auditoria",element:e.jsx(be,{children:e.jsx(it,{})})}),e.jsx(he,{path:"/notificaciones",element:e.jsx(be,{children:e.jsx(lt,{})})}),e.jsx(he,{path:"/NotificacionesDev2",element:e.jsx(be,{children:e.jsx(Bi,{})})}),e.jsx(he,{path:"/formulariopagedev2",element:e.jsx(be,{children:e.jsx(Qi,{})})}),e.jsx(he,{path:"/galeriadev2",element:e.jsx(be,{children:e.jsx(Hi,{})})}),e.jsx(he,{path:"/csv",element:e.jsx(be,{children:e.jsx(nt,{})})}),e.jsx(he,{path:"/panelcontrol",element:e.jsx(be,{children:e.jsx(zt,{})})}),e.jsx(he,{path:"/panelcontroldev2",element:e.jsx(be,{children:e.jsx(Rr,{})})}),e.jsx(he,{path:"/panelcontrol10dev2",element:e.jsx(be,{children:e.jsx(nl,{})})}),e.jsx(he,{path:"/denuncia",element:e.jsx(be,{children:e.jsx(dl,{})})}),e.jsx(he,{path:"/denunciaform",element:e.jsx(be,{children:e.jsx(Cl,{})})}),e.jsx(he,{path:"/panelcontrol10bis",element:e.jsx(be,{children:e.jsx(yi,{})})}),e.jsx(he,{path:"/validaringreso10bis",element:e.jsx(be,{children:e.jsx(ar,{})})}),e.jsx(he,{path:"/validarsalida10bis",element:e.jsx(be,{children:e.jsx(or,{})})}),e.jsx(he,{path:"/nododenuncia",element:e.jsx(be,{children:e.jsx(Vt,{})})}),e.jsx(he,{path:"/10bis",element:e.jsx(be,{children:e.jsx(dt,{})})}),e.jsx(he,{path:"/10bisout",element:e.jsx(be,{children:e.jsx(Yt,{})})}),e.jsx(he,{path:"*",element:e.jsx(Ra,{})})]})})})});Ea(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(_l,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(s=>{console.log("Service Worker registrado con éxito:",s)}).catch(s=>{console.log("Error al registrar el Service Worker:",s)})});
